
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>確率分布 &#8212; My sample book</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=62ba249389abaaa9ffc34bf36a076bdc1d65ee18" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=f31d14ad54b65d19161ba51d4ffff3a77ae00456"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Welcome to my Analytics Sandbox" href="../intro.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">My sample book</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Welcome to my Analytics Sandbox
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   確率分布
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/sndpgm/analytics-sandbox/main?urlpath=tree/docs/analytics/probability-distribution.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/sndpgm/analytics-sandbox"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/sndpgm/analytics-sandbox/issues/new?title=Issue%20on%20page%20%2Fanalytics/probability-distribution.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/analytics/probability-distribution.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id2">
   1. 1次元
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     1.1. 確率変数
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#u-1-1-1-u">
       <u>
        例 1.1.1 (表の出た回数)
       </u>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#u-1-1-2-u">
       <u>
        定義 1.1.2 (離散型確率分布)
       </u>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#u-1-1-3-u">
       <u>
        定義 1.1.3 (連続型確率分布)
       </u>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#u-1-1-4-u">
       <u>
        定義 1.1.4 (累積分布関数)
       </u>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#u-1-1-5-u">
       <u>
        例 1.1.5 (離散型・連続型それぞれの累積分布関数)
       </u>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#u-1-1-6-python-u">
       <u>
        例 1.1.6 (pythonで離散型累積分布関数の確認)
       </u>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#u-1-1-7-python-u">
       <u>
        例 1.1.7 (pythonで連続型累積分布関数の確認)
       </u>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id4">
     1.2. 期待値と分散
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#u-1-2-1-u">
       <u>
        定義 1.2.1 (期待値)
       </u>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#u-1-2-2-u">
       <u>
        例 1.2.2 (期待値の具体例)
       </u>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#u-1-2-3-u">
       <u>
        命題 1.2.3 (期待値の性質)
       </u>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#u-1-2-4-u">
       <u>
        定義 1.2.4 (分散)
       </u>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#u-1-2-5-u">
       <u>
        命題 1.2.5 (分散と期待値の関係式)
       </u>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#u-1-2-6-u">
       <u>
        命題 1.2.6 (分散の性質)
       </u>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id5">
     1.3. モーメントと積率母関数
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#u-1-3-1-u">
       <u>
        定義 1.3.1 (歪度)
       </u>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#u-1-3-2-u">
       <u>
        定義 1.3.2 (尖度)
       </u>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#u-1-3-3-u">
       <u>
        定義 1.3.3 (モーメント)
       </u>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#u-1-3-4-u">
       <u>
        定義 1.3.4 (積率母関数)
       </u>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#u-1-3-5-u">
       <u>
        命題 1.3.5 (積率母関数とモーメントとの関係)
       </u>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id6">
     1.4. 離散型分布の具体例
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#u-1-4-1-u">
       <u>
        例 1.4.1 (ベルヌーイ分布)
       </u>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#u-1-4-2-u">
       <u>
        例 1.4.2 (二項分布)
       </u>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#u-1-4-3-u">
       <u>
        例 1.4.3 (ポアソン分布)
       </u>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#u-1-4-4-u">
       <u>
        例 1.4.4 (幾何分布)
       </u>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#u-1-4-5-u">
       <u>
        例 1.4.5 (負の二項分布)
       </u>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id7">
     1.5. 連続型分布の具体例
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#u-1-5-1-u">
       <u>
        例 1.5.1 (一様分布)
       </u>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#u-1-5-2-u">
       <u>
        例 1.5.2 (正規分布)
       </u>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#u-1-5-3-u">
       <u>
        定理 1.5.3 (中心極限定理)
       </u>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#u-1-5-4-u">
       <u>
        例 1.5.4 (対数正規分布)
       </u>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#u-1-5-5-u">
       <u>
        例 1.5.5 (指数分布)
       </u>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#u-1-5-6-u">
       <u>
        例 1.5.6 (ベータ分布)
       </u>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#u-1-5-7-u">
       <u>
        例 1.5.7 (コーシー分布)
       </u>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#u-1-5-8-u">
       <u>
        例 1.5.8 (パレート分布)
       </u>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#u-1-5-9-u">
       <u>
        例 1.5.9 (ワイブル分布)
       </u>
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id8">
   2. 多次元確率分布
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id9">
     2.1. 期待値と分散
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id10">
     2.2. 周辺分布と条件付き分布
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id11">
     2.3. 多変量正規分布
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id12">
   3. 時系列データ
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>確率分布</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id2">
   1. 1次元
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     1.1. 確率変数
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#u-1-1-1-u">
       <u>
        例 1.1.1 (表の出た回数)
       </u>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#u-1-1-2-u">
       <u>
        定義 1.1.2 (離散型確率分布)
       </u>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#u-1-1-3-u">
       <u>
        定義 1.1.3 (連続型確率分布)
       </u>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#u-1-1-4-u">
       <u>
        定義 1.1.4 (累積分布関数)
       </u>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#u-1-1-5-u">
       <u>
        例 1.1.5 (離散型・連続型それぞれの累積分布関数)
       </u>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#u-1-1-6-python-u">
       <u>
        例 1.1.6 (pythonで離散型累積分布関数の確認)
       </u>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#u-1-1-7-python-u">
       <u>
        例 1.1.7 (pythonで連続型累積分布関数の確認)
       </u>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id4">
     1.2. 期待値と分散
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#u-1-2-1-u">
       <u>
        定義 1.2.1 (期待値)
       </u>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#u-1-2-2-u">
       <u>
        例 1.2.2 (期待値の具体例)
       </u>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#u-1-2-3-u">
       <u>
        命題 1.2.3 (期待値の性質)
       </u>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#u-1-2-4-u">
       <u>
        定義 1.2.4 (分散)
       </u>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#u-1-2-5-u">
       <u>
        命題 1.2.5 (分散と期待値の関係式)
       </u>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#u-1-2-6-u">
       <u>
        命題 1.2.6 (分散の性質)
       </u>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id5">
     1.3. モーメントと積率母関数
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#u-1-3-1-u">
       <u>
        定義 1.3.1 (歪度)
       </u>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#u-1-3-2-u">
       <u>
        定義 1.3.2 (尖度)
       </u>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#u-1-3-3-u">
       <u>
        定義 1.3.3 (モーメント)
       </u>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#u-1-3-4-u">
       <u>
        定義 1.3.4 (積率母関数)
       </u>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#u-1-3-5-u">
       <u>
        命題 1.3.5 (積率母関数とモーメントとの関係)
       </u>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id6">
     1.4. 離散型分布の具体例
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#u-1-4-1-u">
       <u>
        例 1.4.1 (ベルヌーイ分布)
       </u>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#u-1-4-2-u">
       <u>
        例 1.4.2 (二項分布)
       </u>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#u-1-4-3-u">
       <u>
        例 1.4.3 (ポアソン分布)
       </u>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#u-1-4-4-u">
       <u>
        例 1.4.4 (幾何分布)
       </u>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#u-1-4-5-u">
       <u>
        例 1.4.5 (負の二項分布)
       </u>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id7">
     1.5. 連続型分布の具体例
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#u-1-5-1-u">
       <u>
        例 1.5.1 (一様分布)
       </u>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#u-1-5-2-u">
       <u>
        例 1.5.2 (正規分布)
       </u>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#u-1-5-3-u">
       <u>
        定理 1.5.3 (中心極限定理)
       </u>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#u-1-5-4-u">
       <u>
        例 1.5.4 (対数正規分布)
       </u>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#u-1-5-5-u">
       <u>
        例 1.5.5 (指数分布)
       </u>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#u-1-5-6-u">
       <u>
        例 1.5.6 (ベータ分布)
       </u>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#u-1-5-7-u">
       <u>
        例 1.5.7 (コーシー分布)
       </u>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#u-1-5-8-u">
       <u>
        例 1.5.8 (パレート分布)
       </u>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#u-1-5-9-u">
       <u>
        例 1.5.9 (ワイブル分布)
       </u>
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id8">
   2. 多次元確率分布
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id9">
     2.1. 期待値と分散
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id10">
     2.2. 周辺分布と条件付き分布
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id11">
     2.3. 多変量正規分布
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id12">
   3. 時系列データ
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="id1">
<h1>確率分布<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h1>
<section id="id2">
<h2>1. 1次元<a class="headerlink" href="#id2" title="Permalink to this headline">#</a></h2>
<section id="id3">
<h3>1.1. 確率変数<a class="headerlink" href="#id3" title="Permalink to this headline">#</a></h3>
<section id="u-1-1-1-u">
<h4><u>例 1.1.1 (表の出た回数)</u><a class="headerlink" href="#u-1-1-1-u" title="Permalink to this headline">#</a></h4>
<p>1枚のコインが存在し, そのコインを投げた際に表と裏のどちらかをし, 表と裏を示す確率は等しいものとする. そのコインを連続で5回投げた際に出た表の回数ごとに確率を計算すると以下の通りである.</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>表の回数 <span class="math notranslate nohighlight">\(X\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(0\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(1\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(2\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(3\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(4\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(5\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>確率 <span class="math notranslate nohighlight">\({\rm P}(X)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\dfrac{1}{32}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\dfrac{5}{32}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\dfrac{5}{16}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\dfrac{5}{16}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\dfrac{5}{32}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\dfrac{1}{32}\)</span></p></td>
</tr>
</tbody>
</table>
<p>この時, 「コインを投げた際に出た表の回数」という現象を割り当てられた表の回数 <span class="math notranslate nohighlight">\(X\)</span> のことを <strong>確率変数</strong> (random variable) という. また確率変数ごとに割り当てられた確率全体を表したものを <strong>確率分布</strong> (probability distribution) という.</p>
</section>
<section id="u-1-1-2-u">
<h4><u>定義 1.1.2 (離散型確率分布)</u><a class="headerlink" href="#u-1-1-2-u" title="Permalink to this headline">#</a></h4>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p><span class="math notranslate nohighlight">\(\{x_1, x_2, \cdots, x_m, m \in \mathbb{N}\}\)</span> の中の値をとる確率変数 <span class="math notranslate nohighlight">\(X\)</span> を<strong>離散型</strong> (discrete type) と呼び, それぞれの値の確率</p>
<div class="math notranslate nohighlight">
\[
    {\rm P}(X = x_k) = f(x_k) \label{1.1}\tag{1.1}
\]</div>
<p>を <span class="math notranslate nohighlight">\(X\)</span> の<strong>確率分布</strong> (probability distribution) という. <span class="math notranslate nohighlight">\(f\)</span> は</p>
<p><a id="math-1.2"></a>
<a id="math-1.3"></a></p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        &amp; f(x_k) \geq 0 \quad (k = 1, 2, \cdots) \label{1.2}\tag{1.2} \\
        &amp; \sum_{ k=0 }^{ n }{ f(x_k) } = 1 \label{1.3}\tag{1.3}
    \end{align}
\end{split}\]</div>
<p>の条件を満たす. この <span class="math notranslate nohighlight">\(f\)</span> を<strong>確率質量関数</strong> (probability mass function, pmf) という.</p>
</div></section>
<section id="u-1-1-3-u">
<h4><u>定義 1.1.3 (連続型確率分布)</u><a class="headerlink" href="#u-1-1-3-u" title="Permalink to this headline">#</a></h4>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p>確率変数 <span class="math notranslate nohighlight">\(X\)</span> が連続値を取る場合, <strong>連続型</strong> (continuous type) と呼び, 取りうる区間で確率分布が定義される.</p>
<div class="math notranslate nohighlight">
\[
    {\rm P}(a \leq X \leq b) = \int_{a}^{b}{f(x)dx} \label{1.4}\tag{1.4}
\]</div>
<p><span class="math notranslate nohighlight">\(f\)</span> は,</p>
<p><a id="math-1.5"></a>
<a id="math-1.6"></a></p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        &amp; f(x_k) \geq 0 \quad (x \in \mathbb{R}) \label{1.5}\tag{1.5} \\
        &amp; \int_{- \infty}^{\infty}{f(x)dx} = 1 \label{1.6}\tag{1.6}
    \end{align}
\end{split}\]</div>
<p>であるものとする. この <span class="math notranslate nohighlight">\(f\)</span> を <span class="math notranslate nohighlight">\(X\)</span> の<strong>確率密度関数</strong> (probability density function, pdf) という.</p>
</div></section>
<section id="u-1-1-4-u">
<h4><u>定義 1.1.4 (累積分布関数)</u><a class="headerlink" href="#u-1-1-4-u" title="Permalink to this headline">#</a></h4>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p>確率変数 <span class="math notranslate nohighlight">\(X\)</span> に対して, <span class="math notranslate nohighlight">\(x\)</span> を実数とするとき <span class="math notranslate nohighlight">\(x\)</span> 以下の確率</p>
<div class="math notranslate nohighlight">
\[
    F(x) = {\rm P}(X \geq x) \label{1.7}\tag{1.7}
\]</div>
<p>を <span class="math notranslate nohighlight">\(X\)</span> の<strong>累積分布関数</strong> (cumulative distribution function, cdf) と呼ぶ.</p>
</div></section>
<section id="u-1-1-5-u">
<h4><u>例 1.1.5 (離散型・連続型それぞれの累積分布関数)</u><a class="headerlink" href="#u-1-1-5-u" title="Permalink to this headline">#</a></h4>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p>離散型の確率変数の場合, 確率質量関数 <span class="math notranslate nohighlight">\(f(x)\)</span> を用いて <span class="math notranslate nohighlight">\(-\infty\)</span> から <span class="math notranslate nohighlight">\(x\)</span> までの積み上げたものとなり以下のように書ける.</p>
<div class="math notranslate nohighlight">
\[
    F(x) = \sum_{u \geq x}{f(u)} \label{1.8}\tag{1.8}
\]</div>
<p>また, 連続型の確率変数の場合, 確率密度関数 <span class="math notranslate nohighlight">\(f(x)\)</span> を用いて</p>
<div class="math notranslate nohighlight">
\[
    F(x) = \int_{-\infty}^{x}{f(u)du} \label{1.9}\tag{1.9}
\]</div>
<p>となる. また, 微分積分学の基本定理より <span class="math notranslate nohighlight">\(F(x)\)</span> から密度関数 <span class="math notranslate nohighlight">\(f(x)\)</span> が求められる.</p>
<div class="math notranslate nohighlight">
\[
    F'(x) = \frac{d}{dx} \int_{-\infty}^{x}{f(u)du} = f(x) \label{1.10}\tag{1.10}
\]</div>
</div></section>
<section id="u-1-1-6-python-u">
<h4><u>例 1.1.6 (pythonで離散型累積分布関数の確認)</u><a class="headerlink" href="#u-1-1-6-python-u" title="Permalink to this headline">#</a></h4>
<p>例 1.1.1 で挙げたコインの表の回数に関する分布を再考する. 表の出る回数を <span class="math notranslate nohighlight">\(x (x = 0,1, \cdots, 5)\)</span> とした時に <span class="math notranslate nohighlight">\(f(x) = {\rm P}(X=x)\)</span> は以下のように書ける.</p>
<div class="math notranslate nohighlight">
\[
    f(x) = {}_5{\rm C}_{5-x} \biggl( \frac{1}{2} \biggr)^x \biggl( 1-\frac{1}{2} \biggr)^{5-x} = {}_5{\rm C}_{5-x} \biggl( \frac{1}{2} \biggr)^5 = \frac{{}_5{\rm C}_{5-x}}{32} \label{1.11}\tag{1.11}
\]</div>
<p>後述するが, この確率質量関数によって表現される分布を<strong>二項分布</strong> (binomial distribution) といい, python の <a class="reference external" href="https://docs.scipy.org/doc/scipy/index.html">SciPy</a> にある <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.binom.html#scipy.stats.binom"><code class="docutils literal notranslate"><span class="pre">scipy.stats.binom</span></code></a> を用いて分布に従った確率変数を生成できる.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 必要なモジュールのインポート.</span>
<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">binom</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>

<span class="c1"># 表が出る確率 p = 0.5 のコインを n = 5回投げるものとする.</span>
<span class="n">p</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">5</span>

<span class="c1"># 表が2回出る確率を求める (理論値は 5/16).</span>
<span class="c1"># SciPy は疑似乱数から分布を生成しているが理論値とほとんど一致していることが分かる.</span>
<span class="n">prob_2</span> <span class="o">=</span> <span class="n">binom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;======================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;二項分布の確率&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;======================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SciPy: </span><span class="si">{</span><span class="n">prob_2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;理論値: </span><span class="si">{</span><span class="mi">5</span><span class="o">/</span><span class="mi">16</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;差分: </span><span class="si">{</span><span class="mi">5</span><span class="o">/</span><span class="mi">16</span> <span class="o">-</span> <span class="n">prob_2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># 二項分布に従う乱数列の生成</span>
<span class="c1"># 「表が出る確率 p = 0.5 のコインを n = 5回投げる」分布に従った疑似乱数を size=10000 個生成する.</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">rvs</span> <span class="o">=</span> <span class="n">binom</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>

<span class="c1"># 確率分布を取得してプロットするため, 回数を表す横軸 (x) とそれに対応する確率質量関数の値 (y) を取得する.</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">binom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>

<span class="c1"># 可視化</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;======================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;二項分布の確率質量関数と累積分布関数&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;======================================&quot;</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">rvs</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">stat</span><span class="o">=</span><span class="s2">&quot;probability&quot;</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;random variables&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;probability mass function&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Mass function&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

<span class="c1"># 累積分布関数</span>
<span class="n">cdf</span> <span class="o">=</span> <span class="n">binom</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>

<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">212</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">cdf</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;cumulative distribution function&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Cumulative distribution function&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>======================================
二項分布の確率
======================================
SciPy: 0.31249999999999983
理論値: 0.3125
差分: 1.6653345369377348e-16

======================================
二項分布の確率質量関数と累積分布関数
======================================
</pre></div>
</div>
<img alt="../_images/probability-distribution_9_1.png" src="../_images/probability-distribution_9_1.png" />
</div>
</div>
</section>
<section id="u-1-1-7-python-u">
<h4><u>例 1.1.7 (pythonで連続型累積分布関数の確認)</u><a class="headerlink" href="#u-1-1-7-python-u" title="Permalink to this headline">#</a></h4>
<p>連続型の確率分布で最も有名な<strong>正規分布</strong> (normal distribution, ガウス分布 &lt;Gaussina distribution&gt; とも呼ばれる) について考える.<br />
　日本の17歳男子の身長の平均は170.7 cmで, その標準偏差が5.8の正規分布に従うとされており, ここでは簡単なために平均値 <span class="math notranslate nohighlight">\(\mu=170\)</span>, 標準偏差 <span class="math notranslate nohighlight">\(\sigma=6\)</span> として考える. この時, 以下の確率密度関数で表現することができる.</p>
<div class="math notranslate nohighlight">
\[
    f(x) = \frac{1}{\sqrt{2 \pi \cdot 6^2 }} \exp{ \biggl( - \frac{(x-170)^2}{2 \cdot 6^2} \biggr) } \label{1.12}\tag{1.12}
\]</div>
<p>これは <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.norm.html"><code class="docutils literal notranslate"><span class="pre">scipy.stats.norm</span></code></a> によって正規分布に従った乱数を生成できる.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>

<span class="c1"># 正規分布に従う乱数列の生成</span>
<span class="n">loc</span> <span class="o">=</span> <span class="mi">170</span>
<span class="n">scale</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">rvs</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>

<span class="c1"># 確率分布を取得してプロットするため, 回数を表す横軸 (x) とそれに対応する確率質量関数の値 (y) を取得する.</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">130</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>

<span class="c1"># 可視化</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;======================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;正規分布の確率質量関数と累積分布関数&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;======================================&quot;</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">rvs</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">stat</span><span class="o">=</span><span class="s2">&quot;density&quot;</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;random variables&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;probability density function&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Density function&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

<span class="c1"># 累積分布関数</span>
<span class="n">cdf</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>

<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">212</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">cdf</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;cumulative distribution function&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Cumulative distribution function&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>======================================
正規分布の確率質量関数と累積分布関数
======================================
</pre></div>
</div>
<img alt="../_images/probability-distribution_11_1.png" src="../_images/probability-distribution_11_1.png" />
</div>
</div>
</section>
</section>
<section id="id4">
<h3>1.2. 期待値と分散<a class="headerlink" href="#id4" title="Permalink to this headline">#</a></h3>
<section id="u-1-2-1-u">
<h4><u>定義 1.2.1 (期待値)</u><a class="headerlink" href="#u-1-2-1-u" title="Permalink to this headline">#</a></h4>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p>確率変数 <span class="math notranslate nohighlight">\(X\)</span> に対して <span class="math notranslate nohighlight">\({\rm E}(X)\)</span> を<strong>期待値</strong> (expectation) といい</p>
<p><a id="math-1.13"></a>
<a id="math-1.14"></a></p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        &amp;(離散型) \quad {\rm E}(X) = \sum_{ x }{ xf(x) } \label{1.13}\tag{1.13} \\
        &amp;(連続型) \quad {\rm E}(X) = \int_{ -\infty }^{ \infty }{ xf(x)dx } \label{1.14}\tag{1.14}
    \end{align}
\end{split}\]</div>
<p>と書ける. ただし <span class="math notranslate nohighlight">\(f\)</span> は離散型の場合は確率質量関数, 連続型の場合は確率密度関数を示す.
　また, <span class="math notranslate nohighlight">\(X\)</span> の関数 <span class="math notranslate nohighlight">\(\phi(X)\)</span> についても同様に期待値は定義でき以下の通りである.</p>
<p><a id="math-1.15"></a>
<a id="math-1.16"></a></p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        &amp;(離散型) \quad {\rm E}(X) = \sum_{ x }{ \phi(x)f(x) } \label{1.15}\tag{1.15} \\
        &amp;(連続型) \quad {\rm E}(X) = \int_{ -\infty }^{ \infty }{ \phi(x)f(x)dx } \label{1.16}\tag{1.16}
    \end{align}
\end{split}\]</div>
</div></section>
<section id="u-1-2-2-u">
<h4><u>例 1.2.2 (期待値の具体例)</u><a class="headerlink" href="#u-1-2-2-u" title="Permalink to this headline">#</a></h4>
<p>例 1.1.1 のケースの期待値の計算は以下の通りとなる.</p>
<div class="math notranslate nohighlight">
\[
    {\rm E}(X) = 0 \times \frac{1}{32} + 1 \times \frac{5}{32} + 2 \times \frac{10}{32} + 3 \times \frac{10}{32} + 4 \times \frac{5}{32} + 5 \times \frac{1}{32} = \frac{5}{2}
\]</div>
<p>また連続型の分布のうち指数分布があり</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    f(x) = 
    \begin{cases}
        \lambda e^{-\lambda x} &amp; (x \geq 0) \\
        0 &amp; (x \le 0)
    \end{cases}
\end{split}\]</div>
<p>と書ける. ただし <span class="math notranslate nohighlight">\(\lambda &gt; 0\)</span> である. この時の期待値は</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm E}(X) 
            &amp;= \int_{ -\infty }^{ 0 }{ x \cdot 0dx} + \int_{ 0 }^{ \infty }{ x \lambda e^{-\lambda x} dx} \\
            &amp;= 0 + \int_{ 0 }^{ \infty }{ \lambda e^{-\lambda x} dx} - \frac{1}{ \lambda } \Bigl[ x \lambda e^{-\lambda x} \Bigr]_{0}^{ \infty } \\
            &amp;= - \frac{1}{\lambda} \Bigl[ \lambda e^{-\lambda x} \Bigr]_{0}^{ \infty } \\
            &amp;= \frac{1}{\lambda}
    \end{align}
\end{split}\]</div>
<p>となる. 計算には部分積分を用いて実施した. (<a class="reference external" href="https://ja.wolframalpha.com/input?i2d=true&amp;i=Integrate%5Bx%CE%BBExp%5B-%CE%BBx%5D%2C%7Bx%2C0%2C%E2%88%9E%7D%5D">WolframAlpha</a> を用いると上の結果はすぐに導ける.)</p>
</section>
<section id="u-1-2-3-u">
<h4><u>命題 1.2.3 (期待値の性質)</u><a class="headerlink" href="#u-1-2-3-u" title="Permalink to this headline">#</a></h4>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p>期待値の演算について確率変数 <span class="math notranslate nohighlight">\(X, Y\)</span> について以下の性質が成立する. ただし, <span class="math notranslate nohighlight">\(c\)</span> は定数とする.</p>
<p><a id="math-1.17"></a></p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        &amp; {\rm E}(c) = c \label{1.20a}\tag{1.17a} \\
        &amp; {\rm E}(X + c) = {\rm E}(X) + c \label{1.17b}\tag{1.17b} \\
        &amp; {\rm E}(cX) = c{\rm E}(X) \label{1.17c}\tag{1.17c} \\
        &amp; {\rm E}(X + Y) = {\rm E}(X) + {\rm E}(Y) \label{1.17d}\tag{1.17d}
    \end{align}
\end{split}\]</div>
</div></section>
<section id="u-1-2-4-u">
<h4><u>定義 1.2.4 (分散)</u><a class="headerlink" href="#u-1-2-4-u" title="Permalink to this headline">#</a></h4>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p>確率変数 <span class="math notranslate nohighlight">\(X\)</span> に対して <span class="math notranslate nohighlight">\({\rm Var}(X)\)</span> を<strong>分散</strong> (variance) といい</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        &amp;(離散型) \quad {\rm Var}(X) = \sum_{ x }{ (x - {\rm E}(X))^2f(x) } \label{1.18}\tag{1.18} \\
        &amp;(連続型) \quad {\rm Var}(X) = \int_{ -\infty }^{ \infty }{ (x - {\rm E}(X))^2f(x)dx } \label{1.19}\tag{1.19}
    \end{align}
\end{split}\]</div>
</div>
<p>ただし, 実際に分散を求める際には以下の等式を利用する方が楽である.</p>
</section>
<section id="u-1-2-5-u">
<h4><u>命題 1.2.5 (分散と期待値の関係式)</u><a class="headerlink" href="#u-1-2-5-u" title="Permalink to this headline">#</a></h4>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p>分散と期待値の間には以下の関係が成立する.</p>
<p><a id="math-1.20"></a></p>
<div class="math notranslate nohighlight">
\[
    \begin{align}
        {\rm Var}(X) = {\rm E}(X^2) - ({\rm E}(X))^2 \label{1.20}\tag{1.20}
    \end{align}
\]</div>
</div>
<p><u>証明</u></p>
<p>離散型, 連続型いずれにおいても</p>
<div class="math notranslate nohighlight">
\[
{\rm Var}(X) = {\rm E}(X^2) - 2({\rm E}(X))^2 + ({\rm E}(X))^2 = {\rm E}(X^2) - ({\rm E}(X))^2
\]</div>
<p>と計算できる.</p>
</section>
<section id="u-1-2-6-u">
<h4><u>命題 1.2.6 (分散の性質)</u><a class="headerlink" href="#u-1-2-6-u" title="Permalink to this headline">#</a></h4>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p>分散の演算について確率変数 <span class="math notranslate nohighlight">\(X\)</span> について以下の性質が成立する. ただし, <span class="math notranslate nohighlight">\(c\)</span> は定数とする.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        &amp; {\rm Var}(c) = 0 \label{1.21a}\tag{1.21a} \\
        &amp; {\rm Var}(X + c) = {\rm Var}(X) \label{1.21b}\tag{1.21b} \\
        &amp; {\rm Var}(cX) = c^2{\rm Var}(X) \label{1.21c}\tag{1.21c}
    \end{align}
\end{split}\]</div>
</div></section>
</section>
<section id="id5">
<h3>1.3. モーメントと積率母関数<a class="headerlink" href="#id5" title="Permalink to this headline">#</a></h3>
<p>期待値を <span class="math notranslate nohighlight">\(\mu\)</span>, 標準偏差 (分散のルート値) を <span class="math notranslate nohighlight">\(\sigma\)</span> とする.</p>
<section id="u-1-3-1-u">
<h4><u>定義 1.3.1 (歪度)</u><a class="headerlink" href="#u-1-3-1-u" title="Permalink to this headline">#</a></h4>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p>非対称性の指標として<strong>歪度</strong> (skewness) と呼び, 以下のように定義する.</p>
<div class="math notranslate nohighlight">
\[
    \begin{align}
        \alpha_3 = \frac{ {\rm E}(X-\mu)^3 }{\sigma^3} \label{1.22}\tag{1.22}
    \end{align}
\]</div>
</div>
<p><span class="math notranslate nohighlight">\(\alpha_3 &gt; 0\)</span> ならば右の裾が長く, <span class="math notranslate nohighlight">\(\alpha_3 &lt; 0\)</span> ならば左に裾が長い. <span class="math notranslate nohighlight">\(|\alpha_3|\)</span> がその程度を表す.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># -------------------------------</span>
<span class="c1"># 歪度による二項分布の形状</span>
<span class="c1"># -------------------------------</span>

<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">binom</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># 二項分布に関する python モジュールの使い方については後述.</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">p_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">)</span>

<span class="c1"># x軸</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># 図の定義</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">]:</span>
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">binom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">binom</span><span class="o">.</span><span class="n">stats</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">moments</span><span class="o">=</span><span class="s2">&quot;s&quot;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    
    <span class="n">title</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;skewness = </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.61</span><span class="p">)</span>
    
    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/probability-distribution_21_0.png" src="../_images/probability-distribution_21_0.png" />
</div>
</div>
</section>
<section id="u-1-3-2-u">
<h4><u>定義 1.3.2 (尖度)</u><a class="headerlink" href="#u-1-3-2-u" title="Permalink to this headline">#</a></h4>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p>確率分布の尖り具合の程度については以下を用いる.</p>
<div class="math notranslate nohighlight">
\[
    \begin{align}
        \alpha_4 = \frac{ {\rm E}(X-\mu)^4}{\sigma^4} \label{1.23}\tag{1.23}
    \end{align}
\]</div>
</div>
<p>また, <strong>尖度</strong> (kurtosis) は正規分布の <span class="math notranslate nohighlight">\(\alpha_4 = 3\)</span> と比較して <span class="math notranslate nohighlight">\(\alpha_4 - 3\)</span> として定義し, <span class="math notranslate nohighlight">\(\alpha_4 - 3 &gt; 0\)</span> ならば正規分布より尖っており, <span class="math notranslate nohighlight">\(\alpha_4 - 3 &lt; 0\)</span> ならば正規分布より丸く鈍い形をしている.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># -------------------------------</span>
<span class="c1"># 歪度による二項分布の形状</span>
<span class="c1"># -------------------------------</span>

<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span><span class="p">,</span> <span class="n">uniform</span><span class="p">,</span> <span class="n">lognorm</span><span class="p">,</span> <span class="n">expon</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="c1"># 正規分布</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">k</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">stats</span><span class="p">(</span><span class="n">moments</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;kurtosis = </span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># 連続一様分布</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">uniform</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">k</span> <span class="o">=</span> <span class="n">uniform</span><span class="o">.</span><span class="n">stats</span><span class="p">(</span><span class="n">moments</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;kurtosis = </span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># 対数正規分布</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.001</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">lognorm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">k</span> <span class="o">=</span> <span class="n">lognorm</span><span class="o">.</span><span class="n">stats</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">moments</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;kurtosis = </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># 指数分布</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">expon</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">k</span> <span class="o">=</span> <span class="n">expon</span><span class="o">.</span><span class="n">stats</span><span class="p">(</span><span class="n">moments</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;kurtosis = </span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;kurtosis = 6.0&#39;)
</pre></div>
</div>
<img alt="../_images/probability-distribution_23_1.png" src="../_images/probability-distribution_23_1.png" />
</div>
</div>
</section>
<section id="u-1-3-3-u">
<h4><u>定義 1.3.3 (モーメント)</u><a class="headerlink" href="#u-1-3-3-u" title="Permalink to this headline">#</a></h4>
<p>確率分布の形は <span class="math notranslate nohighlight">\({\rm E}(X - \mu)^r\)</span> となる量, あるいは <span class="math notranslate nohighlight">\({\rm E}(X^r)\)</span> によって決まってくる.</p>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p>一般に以下を <span class="math notranslate nohighlight">\(X\)</span> の<strong>原点周りの</strong> <span class="math notranslate nohighlight">\(r\)</span> 次の <strong>モーメント</strong> (moment), または<strong>積率</strong>という.</p>
<div class="math notranslate nohighlight">
\[
    \begin{align}
        \mu_r = {\rm E}(X^r) \label{1.24}\tag{1.24}
    \end{align}
\]</div>
<p>また以下を <span class="math notranslate nohighlight">\(X\)</span> の<strong>期待値 (平均) の周りの</strong> <span class="math notranslate nohighlight">\(r\)</span> 次の <strong>モーメント</strong> (moment) という.</p>
<div class="math notranslate nohighlight">
\[
    \begin{align}
        \mu'_r = {\rm E}(X - \mu)^r \label{1.25}\tag{1.25}
    \end{align}
\]</div>
<p>また</p>
<div class="math notranslate nohighlight">
\[
    \begin{align}
        \alpha_r = \frac{{\rm E}(X - \mu)^r}{\sigma^r} \label{1.26}\tag{1.26}
    \end{align}
\]</div>
<p>を <span class="math notranslate nohighlight">\(X\)</span> の <span class="math notranslate nohighlight">\(r\)</span> 次の<strong>標準化モーメント</strong>と言われる.</p>
</div></section>
<section id="u-1-3-4-u">
<h4><u>定義 1.3.4 (積率母関数)</u><a class="headerlink" href="#u-1-3-4-u" title="Permalink to this headline">#</a></h4>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p>全ての次数のモーメントを生成する関数を<strong>積率母関数</strong>または<strong>モーメント母関数</strong> (moment generating function) と言い, 以下のように定義される.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        &amp;(離散型) \quad M_t(X) = {\rm E}\bigl(e^{tX}\bigr) = \sum_{ x }{ e^{tx} f(x) } \label{1.27}\tag{1.27} \\
        &amp;(連続型) \quad M_t(X) = {\rm E}\bigl(e^{tX}\bigr) = \int_{ -\infty }^{ \infty }{ e^{tx} f(x)dx } \label{1.28}\tag{1.28}
    \end{align}
\end{split}\]</div>
</div>
<p>ただし, この定義で無限和, 積分が存在しないこともある.</p>
</section>
<section id="u-1-3-5-u">
<h4><u>命題 1.3.5 (積率母関数とモーメントとの関係)</u><a class="headerlink" href="#u-1-3-5-u" title="Permalink to this headline">#</a></h4>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p>積率母関数とモーメントの間に以下の関係が成立する.</p>
<div class="math notranslate nohighlight">
\[
    \begin{align}
        M_X^{(r)}(0) = \mu_r \label{1.29}\tag{1.29}
    \end{align}
\]</div>
<p>ただし, <span class="math notranslate nohighlight">\(M_X^{(r)}(t)\)</span> は <span class="math notranslate nohighlight">\(r\)</span> 階導関数である.</p>
</div>
<p><u>証明</u></p>
<p>e^x に対するマクローリン展開式は以下の通り.</p>
<div class="math notranslate nohighlight">
\[
    e^x = 1 + x + \frac{x^2}{2!} + \frac{x^3}{3!} + \cdots
\]</div>
<p><span class="math notranslate nohighlight">\(x = tX\)</span> を代入し</p>
<div class="math notranslate nohighlight">
\[
    e^{tX} = 1 + tX + \frac{(tX)^2}{2!} + \frac{(tX)^3}{3!} + \cdots
\]</div>
<p>で, 両辺の期待値を取れば,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        M_X(t) &amp;= 1 + tE(X) + \frac{t^2E(X^2)}{2!} + \frac{t^3E(X^3)}{3!} + \cdots \\
               &amp;= 1 + \mu_1t + \frac{\mu_2}{2!}t^2 + + \frac{\mu_3}{3!}t^3 + \cdots
    \end{align}
\end{split}\]</div>
<p>ここで, <span class="math notranslate nohighlight">\(r (&gt;0)\)</span> 階導関数を求めると</p>
<div class="math notranslate nohighlight">
\[
    \begin{align}
        M_X^{(r)}(t) &amp;= \mu_r + \frac{\mu_{r+1}}{r+1}t + \frac{\mu_{r+2}}{(r+1)(r+2)}t^2 + \cdots
    \end{align}
\]</div>
<p>となるので, <span class="math notranslate nohighlight">\(t = 0\)</span> を代入して求められる.</p>
</section>
</section>
<section id="id6">
<h3>1.4. 離散型分布の具体例<a class="headerlink" href="#id6" title="Permalink to this headline">#</a></h3>
<section id="u-1-4-1-u">
<h4><u>例 1.4.1 (ベルヌーイ分布)</u><a class="headerlink" href="#u-1-4-1-u" title="Permalink to this headline">#</a></h4>
<p><strong>ベルヌーイ分布</strong> (Bernoulli distribution) コインの裏表のように2種類の可能な結果 (成功を S, 失敗を F) を生じる試行 (<strong>ベルヌーイ試行</strong> (Bernoulli trials) と言う) に対する確率分布.</p>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p><u>確率質量関数</u></p>
<p>成功 S が起きる確率を <span class="math notranslate nohighlight">\(p\)</span> とした場合, 確率変数 <span class="math notranslate nohighlight">\(X\)</span> について成功 S の時に <span class="math notranslate nohighlight">\(X=1\)</span>, 失敗 F の時に <span class="math notranslate nohighlight">\(X = 0\)</span> とする. この時の確率質量関数は以下の通り.</p>
<div class="math notranslate nohighlight">
\[
    f(x) = p^x(1-p)^{1-x}
\]</div>
</div><div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p><u>期待値と分散</u></p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        &amp; {\rm E}(X) = p \\
        &amp; {\rm Var}(X) = p(1-p)
    \end{align}
\end{split}\]</div>
</div><p><u>python での擬似乱数生成</u></p>
<p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.bernoulli.html#scipy.stats.bernoulli"><code class="docutils literal notranslate"><span class="pre">scipy.stats.bernoulli</span></code></a> を用いて生成する.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">bernoulli</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>

<span class="c1"># 成功確率 p = 0.3 のベルヌーイ分布に従った疑似乱数を size = 100000 だけ生成する.</span>
<span class="n">p</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">100000</span>
<span class="n">rvs</span> <span class="o">=</span> <span class="n">bernoulli</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=========================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ベルヌーイ分布・擬似乱数&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=========================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rvs</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">100</span><span class="p">])</span>

<span class="c1"># 擬似乱数から期待値・分散の計算</span>
<span class="n">exp_rvs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rvs</span><span class="p">)</span>
<span class="n">var_rvs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">rvs</span><span class="p">)</span>

<span class="c1"># 期待値・分散の理論値</span>
<span class="n">exp_true</span> <span class="o">=</span> <span class="n">bernoulli</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>
<span class="n">var_true</span> <span class="o">=</span> <span class="n">bernoulli</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=========================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ベルヌーイ分布・期待値/分散&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=========================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;期待値(乱数 vs 真値): </span><span class="si">{</span><span class="n">exp_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">exp_true</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;分散(乱数 vs 真値): </span><span class="si">{</span><span class="n">var_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">var_true</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># 可視化</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;======================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ベルヌーイ分布&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;======================================&quot;</span><span class="p">)</span>

<span class="c1"># 理想PMF</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">bernoulli</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">rvs</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">stat</span><span class="o">=</span><span class="s2">&quot;probability&quot;</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;random variables&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;probability mass function&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Mass function&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=========================================
ベルヌーイ分布・擬似乱数
=========================================
[1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 1 0 0 0 0 0 0 0 1 1 0 0 0 1 0 0 1
 0 0 0 1 0 1 0 0 1 0 0 0 1 0 0 1 0 0 0 0 1 1 1 0 1 0 0 1 0 0 0 0 1 1 0 0 0
 1 0 0 1 1 1 0 0 0 0 1 0 0 1 0 0 0 0 0 1 0 0 1 0 1 0]

=========================================
ベルヌーイ分布・期待値/分散
=========================================
期待値(乱数 vs 真値): 0.30029 vs 0.3
分散(乱数 vs 真値): 0.21011591590000003 vs 0.21

======================================
ベルヌーイ分布
======================================
</pre></div>
</div>
<img alt="../_images/probability-distribution_32_1.png" src="../_images/probability-distribution_32_1.png" />
</div>
</div>
<p><u>ユースケース</u></p>
<p>単独で使用することはあまりないが, 統計モデルの一部にベルヌーイ分布を仮定することが多い. 現象が2パターンしか取り得ないような「会員登録の実施有無」, 「レビュー記事に対して高評価をするかしないか」, 「購買行動を行うか否か」にベルヌーイ分布を仮定する.</p>
<ul class="simple">
<li><p>商品レビューが有用かどうか (<a class="reference external" href="https://www.jstage.jst.go.jp/article/jsaikbs/118/0/118_05/_pdf">柴田と伊東, 2019</a>. この論文内ではベルヌーイ分布による評価の代替評価を提案している.)</p></li>
<li><p>ECサイト利用者に対して施策を売った際にどういったセグメントグループに効果的に機能したかを推定するモデル内において, セグメントグループの購買有無に対してベルヌーイ分布を仮定 (<a class="reference external" href="https://ipsj.ixsq.nii.ac.jp/ej/?action=repository_action_common_download&amp;item_id=185104&amp;item_no=1&amp;attribute_id=1&amp;file_no=1">松嵜ら, 2017</a>)</p></li>
</ul>
</section>
<section id="u-1-4-2-u">
<h4><u>例 1.4.2 (二項分布)</u><a class="headerlink" href="#u-1-4-2-u" title="Permalink to this headline">#</a></h4>
<p><strong>二項分布</strong> (binomial distribution) は結果が 2 つの試行 (成功を S, 失敗を F) を何度も繰り返すことによって起こる確率分布.</p>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p><u>確率質量関数</u></p>
<p>S が 確率 <span class="math notranslate nohighlight">\(p (0 \leq p \leq 1)\)</span> で <span class="math notranslate nohighlight">\(x\)</span> 回, F が確率 <span class="math notranslate nohighlight">\(1-p\)</span> で <span class="math notranslate nohighlight">\(n-x\)</span> 回生じるとすると, <span class="math notranslate nohighlight">\(x=0,1, \cdots, n\)</span> であって, その確率質量関数は以下の通り.</p>
<div class="math notranslate nohighlight">
\[
    f(x) = {}_n{\rm C}_{x} p^x (1-p)^{n-x}
\]</div>
</div>
<p>確率変数 <span class="math notranslate nohighlight">\(X\)</span> が 二項分布に従っていることを <span class="math notranslate nohighlight">\(X \sim Bi(n, p)\)</span> と記載する.</p>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p><u>期待値と分散</u></p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        &amp; {\rm E}(X) = np \\
        &amp; {\rm Var}(X) = np(1-p)
    \end{align}
\end{split}\]</div>
</div><p><u>python での擬似乱数生成</u></p>
<p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.binom.html#scipy.stats.binom"><code class="docutils literal notranslate"><span class="pre">scipy.stats.binom</span></code></a> を用いて生成する.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">binom</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>

<span class="c1"># 試行回数 n = 10, 成功確率 p = 0.3 の二項分布に従った疑似乱数を size = 100000 だけ生成する.</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">p</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">100000</span>
<span class="n">rvs</span> <span class="o">=</span> <span class="n">binom</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=========================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;二項分布・擬似乱数&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=========================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rvs</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">100</span><span class="p">])</span>

<span class="c1"># 擬似乱数から期待値・分散の計算</span>
<span class="n">exp_rvs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rvs</span><span class="p">)</span>
<span class="n">var_rvs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">rvs</span><span class="p">)</span>

<span class="c1"># 期待値・分散の理論値</span>
<span class="n">exp_true</span> <span class="o">=</span> <span class="n">binom</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>
<span class="n">var_true</span> <span class="o">=</span> <span class="n">binom</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=========================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;二項分布・期待値/分散&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=========================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;期待値(乱数 vs 真値): </span><span class="si">{</span><span class="n">exp_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">exp_true</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;分散(乱数 vs 真値): </span><span class="si">{</span><span class="n">var_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">var_true</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># 可視化</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;======================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;二項分布&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;======================================&quot;</span><span class="p">)</span>

<span class="c1"># 理想PMF</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">binom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">rvs</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">stat</span><span class="o">=</span><span class="s2">&quot;probability&quot;</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;random variables&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;probability mass function&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Mass function&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=========================================
二項分布・擬似乱数
=========================================
[1 2 0 2 1 1 5 3 4 1 2 4 4 1 0 3 3 4 2 2 3 4 1 4 5 4 4 1 4 4 1 2 5 3 3 2 2
 4 3 4 0 3 5 2 4 6 2 3 2 3 3 2 4 2 2 8 1 3 1 4 1 2 1 4 2 2 3 4 2 2 3 4 1 4
 6 0 5 1 4 3 3 1 4 8 4 5 4 1 5 5 3 2 3 1 5 3 4 3 5 4]

=========================================
二項分布・期待値/分散
=========================================
期待値(乱数 vs 真値): 2.99594 vs 3.0
分散(乱数 vs 真値): 2.0879035164 vs 2.0999999999999996

======================================
二項分布
======================================
</pre></div>
</div>
<img alt="../_images/probability-distribution_38_1.png" src="../_images/probability-distribution_38_1.png" />
</div>
</div>
<p><u>ユースケース</u></p>
<ul class="simple">
<li><p>バナー広告のインプレッション数 <span class="math notranslate nohighlight">\(n\)</span> 回のうち, クリック率 <span class="math notranslate nohighlight">\(p\)</span> で広告がクリックされる回数 (<a class="reference external" href="http://www.orsj.or.jp/archive2/or57-10/or57_10_574.pdf">本橋ら, 2012</a>)</p></li>
<li><p>特定のサービスにおいて <span class="math notranslate nohighlight">\(n\)</span> 人の利用ユーザーのうち, 確率 <span class="math notranslate nohighlight">\(p\)</span> で解約する人数</p></li>
<li><p>特定の病気において <span class="math notranslate nohighlight">\(n\)</span> 人の被験者のうち, 病気の発症率 <span class="math notranslate nohighlight">\(p\)</span> がどのように変わるか</p></li>
</ul>
</section>
<section id="u-1-4-3-u">
<h4><u>例 1.4.3 (ポアソン分布)</u><a class="headerlink" href="#u-1-4-3-u" title="Permalink to this headline">#</a></h4>
<p><strong>ポアソン分布</strong> (Poisson distribution) とは, 二項分布において <span class="math notranslate nohighlight">\(n\)</span> が大 (すなわち大量の観測) である一方, <span class="math notranslate nohighlight">\(p\)</span> が小 (すなわち希少現象) である分布.</p>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p><u>確率質量関数</u></p>
<p><span class="math notranslate nohighlight">\(\lambda &gt; 0, x \geq 0\)</span> として確率質量関数は以下の通り.</p>
<div class="math notranslate nohighlight">
\[
    f(x) = \frac{e^{-\lambda} \lambda^{x}}{x!}
\]</div>
</div>
<p>ここで確率分布の性質である <a class="reference external" href="#math-1.2">(1.2)</a>, <a class="reference external" href="#math-1.3">(1.3)</a> を確認する.</p>
<p><u>数式 (1.2) の確認</u><br />
　確率質量関数の定義から <span class="math notranslate nohighlight">\(f(x) \geq 0\)</span> であることは自明.</p>
<p><u>数式 (1.3) の確認</u><br />
　<span class="math notranslate nohighlight">\(e^x\)</span> について<a class="reference external" href="https://ja.wikipedia.org/wiki/%E3%83%86%E3%82%A4%E3%83%A9%E3%83%BC%E5%B1%95%E9%96%8B">マクローリン展開</a>から</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        e^x &amp;= 1 + \frac{x}{1!} + \frac{x^2}{2!} + \cdots + \frac{x^k}{k!} + \cdots \\
            &amp;= \sum_{k=0}^{\infty}{\frac{x^k}{k!}}
    \end{align}
\end{split}\]</div>
<p>と書けるので,</p>
<div class="math notranslate nohighlight">
\[
\sum_{x=0}^{\infty}{f(x)} = \sum_{x=0}^{\infty}{\frac{e^{-\lambda} \lambda^{x}}{x!}} = e^{-\lambda} \sum_{x=0}^{\infty}{\frac{ \lambda^{x}}{x!}} = e^{-\lambda} \cdot e^{\lambda} = 1
\]</div>
<p>と分かる.</p>
<p>確率変数 <span class="math notranslate nohighlight">\(X\)</span> がポアソン分布に従う時, <span class="math notranslate nohighlight">\(X \sim Po(\lambda)\)</span> または <span class="math notranslate nohighlight">\(X \sim Poisson(\lambda)\)</span> と記載する.</p>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p><u>期待値と分散</u></p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        &amp; {\rm E}(X) = \lambda \\
        &amp; {\rm Var}(X) = \lambda
    \end{align}
\end{split}\]</div>
</div>
<p><u>証明</u><br />
　期待値については, 式 <a class="reference external" href="#math-1.13">(1.13)</a> より</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm E}(X) &amp;= \sum_{x=0}^{\infty}{x\frac{e^{-\lambda}\lambda^{x}}{x!}} \\
                   &amp;= \lambda e^{-\lambda}\sum_{x=1}^{\infty}{\frac{\lambda^{x-1}}{(x-1)!}} \\
                   &amp;= \lambda e^{-\lambda} \cdot e^{\lambda} \\
                   &amp;= \lambda
    \end{align}
\end{split}\]</div>
<p>と計算できる. また分散について式 <a class="reference external" href="#math-1.20">(1.20)</a> から <span class="math notranslate nohighlight">\({\rm E}(X^2)\)</span> を求めることで分散も求められる.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm E}(X^2) &amp;= \sum_{x=0}^{\infty}{x^2\frac{e^{-\lambda}\lambda^{x}}{x!}} \\
                     &amp;= \sum_{x=0}^{\infty}{\{x(x-1) + x\} \frac{e^{-\lambda}\lambda^{x}}{x!}} \\
                     &amp;= \lambda^2 e^{-\lambda}\sum_{x=2}^{\infty}{\frac{\lambda^{x-2}}{(x-2)!}} + \lambda e^{-\lambda}\sum_{x=1}^{\infty}{\frac{\lambda^{x-1}}{(x-1)!}} \\
                     &amp;= \lambda^2 + \lambda \\
    \end{align}
\end{split}\]</div>
<p>よって</p>
<div class="math notranslate nohighlight">
\[
    {\rm Var}(X) = {\rm}E(X^2) - ({\rm E}(X))^2 = \lambda^2 + \lambda - \lambda^2 = \lambda
\]</div>
<p><u>python での擬似乱数生成</u></p>
<p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.poisson.html#scipy.stats.poisson"><code class="docutils literal notranslate"><span class="pre">scipy.stats.poisson</span></code></a> を用いて生成する.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">poisson</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>

<span class="c1"># mu (上式のlambdaに相当) = 1 のポアソン分布に従った疑似乱数を size = 100000 だけ生成する.</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">100000</span>
<span class="n">rvs</span> <span class="o">=</span> <span class="n">poisson</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="n">mu</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=========================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ポアソン分布・擬似乱数&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=========================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rvs</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">100</span><span class="p">])</span>

<span class="c1"># 擬似乱数から期待値・分散の計算</span>
<span class="n">exp_rvs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rvs</span><span class="p">)</span>
<span class="n">var_rvs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">rvs</span><span class="p">)</span>

<span class="c1"># 期待値・分散の理論値</span>
<span class="n">exp_true</span> <span class="o">=</span> <span class="n">poisson</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="n">mu</span><span class="p">)</span>
<span class="n">var_true</span> <span class="o">=</span> <span class="n">poisson</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="n">mu</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=========================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ポアソン分布・期待値/分散&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=========================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;期待値(乱数 vs 真値): </span><span class="si">{</span><span class="n">exp_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">exp_true</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;分散(乱数 vs 真値): </span><span class="si">{</span><span class="n">var_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">var_true</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># 可視化</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;======================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ポアソン分布&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;======================================&quot;</span><span class="p">)</span>

<span class="c1"># x軸</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># 図の定義</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

<span class="k">for</span> <span class="n">mu</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">):</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">poisson</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="n">mu</span><span class="p">)</span>
    <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;mu = </span><span class="si">{</span><span class="n">mu</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
    
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Poisson distribution for various mu&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=========================================
ポアソン分布・擬似乱数
=========================================
[2 2 1 0 2 0 2 5 1 2 3 1 1 1 0 0 0 2 0 0 1 0 0 0 0 2 0 1 0 0 1 0 2 1 0 0 2
 2 0 2 0 0 0 1 0 1 2 1 2 1 3 1 1 1 1 0 1 1 1 0 0 0 2 1 2 1 1 1 0 0 1 2 2 2
 0 1 0 0 0 0 2 0 0 2 1 2 3 3 2 2 0 0 0 1 2 1 0 2 1 0]

=========================================
ポアソン分布・期待値/分散
=========================================
期待値(乱数 vs 真値): 1.00269 vs 1.0
分散(乱数 vs 真値): 1.0003427639 vs 1.0

======================================
ポアソン分布
======================================
</pre></div>
</div>
<img alt="../_images/probability-distribution_44_1.png" src="../_images/probability-distribution_44_1.png" />
</div>
</div>
<p>二項分布において <span class="math notranslate nohighlight">\(n \rightarrow \infty, p \rightarrow 0\)</span> とすることでポアソン分布に近づく. ここで <span class="math notranslate nohighlight">\(\lambda = np\)</span> とすれば確率質量関数 <span class="math notranslate nohighlight">\(f(x)\)</span> は</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        f(x) &amp;= {}_n{\rm C}_{x} \Bigl( \frac{\lambda}{n} \Bigr)^x \Bigl( 1 - \frac{\lambda}{n} \Bigr)^{n-x} \\
             &amp;= \frac{n(n-1) \cdots (n-x+1)}{x!} \frac{\lambda^x}{n^x} \Bigl( 1 - \frac{\lambda}{n} \Bigr)^n \Bigl( 1 - \frac{\lambda}{n} \Bigr)^{-x} \\
             &amp;= \frac{\lambda^x}{x!} \Bigl( 1 - \frac{\lambda}{n} \Bigr)^n \Bigl( 1 - \frac{1}{n} \Bigr) \Bigl( 1 - \frac{2}{n} \Bigr) \cdots \Bigl( 1 - \frac{k-1}{n} \Bigr) \Bigl( 1 - \frac{\lambda}{n} \Bigr)^{-x}
    \end{align}
\end{split}\]</div>
<p>ここで, <span class="math notranslate nohighlight">\(n \rightarrow \infty\)</span> とした時, <span class="math notranslate nohighlight">\(m = 1, 2, \cdots, k-1\)</span> とすれば</p>
<div class="math notranslate nohighlight">
\[
\lim_{n \rightarrow \infty}{\Bigl( 1 - \frac{m}{n} \Bigr)} = 0, \quad \lim_{n \rightarrow \infty}{\Bigl( 1 - \frac{\lambda}{n} \Bigr)^{-x}} = 0 \quad \lim_{n \rightarrow \infty}{\Bigl( 1 - \frac{\lambda}{n} \Bigr)^n} = e^{-\lambda}
\]</div>
<p>なので,</p>
<div class="math notranslate nohighlight">
\[
    \lim_{n \rightarrow \infty}{f(x)} = \frac{e^{-\lambda} \lambda^{x}}{x!}
\]</div>
<p>とポアソン分布になる. 実際に python で二項分布とポアソン分布を比較する.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">binom</span><span class="p">,</span> <span class="n">poisson</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>

<span class="c1"># x軸</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># 図の定義</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

<span class="c1"># ポアソン分布</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">poisson</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
<span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Poisson (mu = 2.0)&quot;</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>

<span class="c1"># 二項分布</span>
<span class="n">scales</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">,</span> <span class="mi">100000</span><span class="p">])</span>
<span class="n">base_n</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">base_p</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="k">for</span> <span class="n">scale</span> <span class="ow">in</span> <span class="n">scales</span><span class="p">:</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">base_n</span> <span class="o">*</span> <span class="n">scale</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">base_p</span> <span class="o">/</span> <span class="n">scale</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">binom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>
    <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Binomial (n = </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">, p = </span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s2">)&quot;</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
    
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Binomial vs Poisson&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/probability-distribution_46_0.png" src="../_images/probability-distribution_46_0.png" />
</div>
</div>
<p><u>ユースケース</u></p>
<ul class="simple">
<li><p>交通事故件数</p></li>
<li><p>大量生産の不良品数 (<a class="reference external" href="https://notebook.community/STREAM3/pyisc/docs/pyISC_simple_anomaly_example">pyISC Example: Simple Anomaly Detection with Frequency Data</a>)</p></li>
<li><p>破産件数</p></li>
<li><p>火災件数</p></li>
<li><p>砲弾命中数</p></li>
<li><p>遺伝子の突然変異数</p></li>
<li><p>電話の呼び数</p></li>
<li><p>渋滞していない高速道路の料金ゲートへの車の到着台数</p></li>
<li><p>医学研究において顕微鏡視野に入る区画当たりのバクテリア数</p></li>
<li><p>物理現象として単位時間当たりのガイガー計数管の読み数</p></li>
</ul>
</section>
<section id="u-1-4-4-u">
<h4><u>例 1.4.4 (幾何分布)</u><a class="headerlink" href="#u-1-4-4-u" title="Permalink to this headline">#</a></h4>
<p>成功 S (発生確率 <span class="math notranslate nohighlight">\(p\)</span>) と失敗 F (発生確率 <span class="math notranslate nohighlight">\(q = 1- p\)</span>) の 2 通りしかない試行を次々と続ける試行を考える. 最初の成功 S が出現するまでの試行回数を <span class="math notranslate nohighlight">\(x\)</span> とするならば <span class="math notranslate nohighlight">\(x = 1, 2, 3, \cdots\)</span> であり以下の確率質量関数で表現される確率分布を<strong>幾何分布</strong> (geometric distribution) という.</p>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p><u>確率質量関数</u></p>
<p><span class="math notranslate nohighlight">\(0 \lt p \lt 1, q = 1 - p\)</span> とする.</p>
<div class="math notranslate nohighlight">
\[
    f(x) = pq^{x-1} \quad (x = 1, 2, 3, \cdots)
\]</div>
</div>
<p>これは <span class="math notranslate nohighlight">\(x\)</span> に応じて幾何級数 (等比数列) 的に減じていくため幾何分布という.<br />
　ここで確率分布の性質である <a class="reference external" href="#math-1.2">(1.2)</a>, <a class="reference external" href="#math-1.3">(1.3)</a> を確認する.</p>
<p><u>数式 (1.2) の確認</u><br />
　確率質量関数の定義から <span class="math notranslate nohighlight">\(f(x) \geq 0\)</span> であることは自明.</p>
<p><u>数式 (1.3) の確認</u></p>
<p><span class="math notranslate nohighlight">\(0 \lt p \lt 1 \Rightarrow 0 \lt q \lt 1\)</span> なので無限等比級数の和から</p>
<div class="math notranslate nohighlight">
\[
\sum_{x=1}^{\infty}{f(x)} = p\sum_{x=1}^{\infty}{q} = p \cdot \frac{1}{1-q} = p \cdot \frac{1}{p} = 1
\]</div>
<p>と分かる.</p>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p><u>期待値と分散</u></p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        &amp; {\rm E}(X) = \frac{1}{p} \\
        &amp; {\rm Var}(X) = \frac{q}{p^2}
    \end{align}
\end{split}\]</div>
</div>
<p><u>証明</u><br />
　期待値については, 式 <a class="reference external" href="#math-1.13">(1.13)</a> より</p>
<div class="math notranslate nohighlight">
\[
    \begin{align}
        {\rm E}(X) = \sum_{x=1}^{\infty}{x pq^{x-1}} = p \sum_{x=1}^{\infty}{ xq^{x-1} }
    \end{align}
\]</div>
<p><span class="math notranslate nohighlight">\(0 \lt q \lt 1\)</span> において</p>
<div class="math notranslate nohighlight">
\[
    g(q) = \sum_{x = 0}^{\infty}{q^x} = \frac{1}{1-q}
\]</div>
<p>を考える. 第 3 項については無限等比級数の和から分かる. <span class="math notranslate nohighlight">\(q\)</span> について微分すると</p>
<div class="math notranslate nohighlight">
\[
    g'(q) = \sum_{x = 1}^{\infty}{xq^{x-1}} = \frac{1}{(1-q)^2}
\]</div>
<p>となり <span class="math notranslate nohighlight">\(p = 1 - q\)</span> であることに注意して,</p>
<div class="math notranslate nohighlight">
\[
    {\rm E}(X) = p \sum_{x=1}^{\infty}{ xq^{x-1} } = p \cdot \frac{1}{(1-q)^2} = \frac{1}{p}
\]</div>
<p>と求められる. また分散については <a class="reference external" href="#math-1.20">(1.20)</a> より</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm Var}(X) &amp;= {\rm}E(X^2) - ({\rm E}(X))^2 \\
                     &amp;= {\rm}E(X(X-1)+X) - ({\rm E}(X))^2 \\
                     &amp;= {\rm}E(X(X-1)) + {\rm}E(X) - ({\rm E}(X))^2
    \end{align}
\end{split}\]</div>
<p>第 2 式から弟 3 式への変換は性質 <a class="reference external" href="#math-1.17">(1.17d)</a> を用いている.
　<span class="math notranslate nohighlight">\({\rm}E(X(X-1))\)</span> を求めれば分散が求められる. 上で用いた <span class="math notranslate nohighlight">\(g(q)\)</span> を 2 階微分すると</p>
<div class="math notranslate nohighlight">
\[
    g''(q) = \sum_{x = 2}^{\infty}{x(x-1)q^{x-2}} = \frac{2}{(1-q)^3}
\]</div>
<p>なので</p>
<div class="math notranslate nohighlight">
\[
    {\rm E}(X(X-1)) = pq \sum_{x=2}^{\infty}{ x(x-1)q^{x-2} } = pq \frac{2}{(1-q)^3} = \frac{2(1-q)}{p^2}
\]</div>
<p>となり分散は</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm Var}(X) &amp;= {\rm}E(X(X-1)) + {\rm}E(X) - ({\rm E}(X))^2 \\
                     &amp;= \frac{2(1-q)}{p^2} + \frac{1}{p} - \frac{1}{p^2} \\
                     &amp;= \frac{1-p}{p^2} \\
                     &amp;= \frac{q}{p^2}
    \end{align}
\end{split}\]</div>
<p>と分かる.</p>
<p><u>python での擬似乱数生成</u></p>
<p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.geom.html#scipy.stats.geom"><code class="docutils literal notranslate"><span class="pre">scipy.stats.geom</span></code></a> を用いて生成する.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">geom</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>

<span class="c1"># 成功確率 p = 0.04 の幾何分布に従った疑似乱数を size = 100000 だけ生成する.</span>
<span class="n">p</span> <span class="o">=</span> <span class="mf">0.04</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">100000</span>
<span class="n">rvs</span> <span class="o">=</span> <span class="n">geom</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=========================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;幾何分布・擬似乱数&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=========================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rvs</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">100</span><span class="p">])</span>

<span class="c1"># 擬似乱数から期待値・分散の計算</span>
<span class="n">exp_rvs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rvs</span><span class="p">)</span>
<span class="n">var_rvs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">rvs</span><span class="p">)</span>
<span class="n">max_rvs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">rvs</span><span class="p">)</span>
<span class="n">min_rvs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">rvs</span><span class="p">)</span>

<span class="c1"># 期待値・分散の理論値</span>
<span class="n">exp_true</span> <span class="o">=</span> <span class="n">geom</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>
<span class="n">var_true</span> <span class="o">=</span> <span class="n">geom</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=========================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;幾何分布・期待値/分散&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=========================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;期待値(乱数 vs 真値): </span><span class="si">{</span><span class="n">exp_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">exp_true</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;分散(乱数 vs 真値): </span><span class="si">{</span><span class="n">var_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">var_true</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;最大値 (乱数): </span><span class="si">{</span><span class="n">max_rvs</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;最小値 (乱数): </span><span class="si">{</span><span class="n">min_rvs</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># 可視化</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;======================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;幾何分布&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;======================================&quot;</span><span class="p">)</span>

<span class="c1"># x軸</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_rvs</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># 図の定義</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

<span class="c1"># 乱数によるヒストグラム</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">rvs</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">stat</span><span class="o">=</span><span class="s2">&quot;probability&quot;</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;random variables&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>

<span class="c1"># 確率質量関数による真値</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">geom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;probability mass function&quot;</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Mass function&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=========================================
幾何分布・擬似乱数
=========================================
[ 12  10  25   2  53  68  22   5  32  35  47   3   3  68   7  11  24 101
   5 114  26  16  10  44   5  60  13   2   1 137  11  13   4  11  44  15
  21  34  10  33  27  96  43  42  29   2   2  14   3  49  29  37  10   4
  24  84  18  39  44  10   8   7   4  20  30  10  29   2  45 100  10  18
  27  63   4  21   9  25   7  17  26  30  26  40  50  41  15  19  12   4
  56  12   2  23  10   2   2  51  88   7]

=========================================
幾何分布・期待値/分散
=========================================
期待値(乱数 vs 真値): 24.88497 vs 25.0
分散(乱数 vs 真値): 599.9549780991 vs 600.0
最大値 (乱数): 325
最小値 (乱数): 1

======================================
幾何分布
======================================
</pre></div>
</div>
<img alt="../_images/probability-distribution_52_1.png" src="../_images/probability-distribution_52_1.png" />
</div>
</div>
<p><u>ユースケース</u></p>
<ul class="simple">
<li><p>1年について確率 <span class="math notranslate nohighlight">\(p\)</span> で起こる災害が <span class="math notranslate nohighlight">\(x\)</span> 年以内に発生する分布として捕捉.</p></li>
</ul>
</section>
<section id="u-1-4-5-u">
<h4><u>例 1.4.5 (負の二項分布)</u><a class="headerlink" href="#u-1-4-5-u" title="Permalink to this headline">#</a></h4>
<p><strong>負の二項分布</strong> (negative binomial distribution) は幾何分布を一般化されたものであり, <span class="math notranslate nohighlight">\(n\)</span> 回目の成功を得るまでの失敗の回数を <span class="math notranslate nohighlight">\(x\)</span> とした時の確率分布である.</p>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p><u>確率質量関数</u></p>
<p><span class="math notranslate nohighlight">\(x = 0, 1, \cdots\)</span> とする.</p>
<div class="math notranslate nohighlight">
\[
    f(x) = {}_{n+x-1}{\rm C}_{x} p^n q^x
\]</div>
</div>
<p><span class="math notranslate nohighlight">\(n=1\)</span> の時に幾何分布となる. ちなみに, 二項分布で二項係数に負も認めれば負の二項分布が求められるため, この名称となっている.<br />
　ここで確率分布の性質である <a class="reference external" href="#math-1.2">(1.2)</a>, <a class="reference external" href="#math-1.3">(1.3)</a> を確認する.</p>
<p><u>数式 (1.2) の確認</u><br />
　確率質量関数の定義から <span class="math notranslate nohighlight">\(f(x) \geq 0\)</span> であることは自明.</p>
<p><u>数式 (1.3) の確認</u></p>
<p>負の二項展開式について考えるとすぐに導出できる. <span class="math notranslate nohighlight">\(n \in \mathbb{N}\)</span>, <span class="math notranslate nohighlight">\(r\)</span> <span class="math notranslate nohighlight">\((0 \leq r \leq n, r \in \mathbb{N})\)</span> として</p>
<div class="math notranslate nohighlight">
\[
    (1 + t)^{-n} = \sum_{x=0}^{n}{{}_{-n}{\rm C}_{x}t^x}
\]</div>
<p>とかけ,</p>
<div class="math notranslate nohighlight">
\[
    {}_{-n}{\rm C}_{x} = (-1)^x {}_{n+x-1}{\rm C}_{x}
\]</div>
<p>と表せる.
　<span class="math notranslate nohighlight">\(t = -(1-p)\)</span> として</p>
<div class="math notranslate nohighlight">
\[
    \frac{1}{p^n} = {1 -(1-p)}^{-n} = \sum_{x=0}^{\infty}{{}_{-n}{\rm C}_{x}(-(1-p))^x} = \sum_{x=0}^{\infty}{{}_{n+x-1}{\rm C}_{x}(1-p)^x}
\]</div>
<p>となるので, <span class="math notranslate nohighlight">\(q = 1 - p\)</span> であり上式に <span class="math notranslate nohighlight">\(p^n\)</span> をかけて</p>
<div class="math notranslate nohighlight">
\[
    \sum_{x=0}^{\infty}{{}_{n+x-1}{\rm C}_{x}p^n q^x} = 1
\]</div>
<p>となる.</p>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p><u>期待値と分散</u></p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        &amp; {\rm E}(X) = \frac{nq}{p} \\
        &amp; {\rm Var}(X) = \frac{nq}{p^2}
    \end{align}
\end{split}\]</div>
</div>
<p><u>証明</u><br />
　期待値については, 式 <a class="reference external" href="#math-1.13">(1.13)</a> より</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm E}(X) &amp;= \sum_{x=0}^{\infty}{x {}_{ n+x-1 }{\rm C}_{ x } p^n q^x } \\
                   &amp;= \sum_{x=1}^{\infty}{x \frac{ (n+x-1)! }{ (n-1)! x! } p^n q^x } \\
                   &amp;= \sum_{x=1}^{\infty}{ \frac{ (n+x-1)! }{ (n-1)! (x-1)! } p^n q^x }
    \end{align}
\end{split}\]</div>
<p>ここで <span class="math notranslate nohighlight">\(y = x - 1\)</span>, <span class="math notranslate nohighlight">\(N = n + 1\)</span> と置換すると</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm E}(X) &amp;= \sum_{y=0}^{\infty}{ \frac{ (y + N -1)! }{ ( N-2 )! y! } p^{ N-1 } q^{ y+1 } } \\
                   &amp;= \frac{ q }{ p }(N-1) \sum_{y=0}^{\infty}{ \frac{ (y + N -1 )! }{ ( N-1 )! y! } p^{ N } q^{ y } } \\
                   &amp;= \frac{ q }{ p }(N-1) \\
                   &amp;= \frac{nq}{p}
    \end{align}
\end{split}\]</div>
<p>と求められる. また分散については <a class="reference external" href="#math-1.20">(1.20)</a> より</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm Var}(X) &amp;= {\rm}E(X^2) - ({\rm E}(X))^2 \\
                     &amp;= {\rm}E(X(X-1)+X) - ({\rm E}(X))^2 \\
                     &amp;= {\rm}E(X(X-1)) + {\rm}E(X) - ({\rm E}(X))^2
    \end{align}
\end{split}\]</div>
<p>第 2 式から弟 3 式への変換は性質 <a class="reference external" href="#math-1.17">(1.17d)</a> を用いている.<br />
　<span class="math notranslate nohighlight">\({\rm}E(X(X-1))\)</span> を求めれば分散が求められるので,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm E}(X(X-1)) &amp;= \sum_{x=0}^{\infty}{ x(x-1) {}_{ n+x-1 }{\rm C}_{ x } p^n q^x } \\
                        &amp;= \sum_{x=1}^{\infty}{ x(x-1) \frac{ (n+x-1)! }{ (n-1)! x! } p^n q^x } \\
                        &amp;= \sum_{x=2}^{\infty}{ \frac{ (n+x-1)! }{ (n-1)! (x-2)! } p^n q^x }
    \end{align}
\end{split}\]</div>
<p>となる. ここで <span class="math notranslate nohighlight">\(y = x - 2\)</span>, <span class="math notranslate nohighlight">\(N = n + 2\)</span> と置換すると</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm E}(X(X-1)) &amp;= \sum_{y=0}^{\infty}{ \frac{ (N + y - 1)! }{ (N - 3)! y! } p^{N - 2} q^{y + 2} } \\
                        &amp;= \frac{q^2}{p^2}(N-1)(N-2) \sum_{y=0}^{\infty}{ \frac{ (N+y-1)! }{ (N-1)! y! } p^{N} q^{y} } \\
                        &amp;= \frac{q^2}{p^2}(N-1)(N-2) \\
                        &amp;= \frac{q^2}{p^2}n(n + 1)
    \end{align}
\end{split}\]</div>
<p>となり分散は</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm Var}(X) &amp;= {\rm}E(X(X-1)) + {\rm}E(X) - ({\rm E}(X))^2 \\
                     &amp;= \frac{q^2}{p^2}n(n + 1) + \frac{nq}{p} - \frac{n^2 q^2}{p^2} \\
                     &amp;= \frac{nq}{p^2}
    \end{align}
\end{split}\]</div>
<p>と分かる.</p>
<p><u>python での擬似乱数生成</u></p>
<p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.nbinom.html#scipy.stats.nbinom"><code class="docutils literal notranslate"><span class="pre">scipy.stats.nbinom</span></code></a> を用いて生成する.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">nbinom</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>

<span class="c1"># 成功確率 p = 0.20 の事象において n = 4 回成功するまでの失敗回数に関する負の二項分布に従った疑似乱数を size = 100000 だけ生成する.</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">p</span> <span class="o">=</span> <span class="mf">0.20</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">100000</span>
<span class="n">rvs</span> <span class="o">=</span> <span class="n">nbinom</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=========================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;負の二項分布・擬似乱数&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=========================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rvs</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">100</span><span class="p">])</span>

<span class="c1"># 擬似乱数から期待値・分散の計算</span>
<span class="n">exp_rvs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rvs</span><span class="p">)</span>
<span class="n">var_rvs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">rvs</span><span class="p">)</span>
<span class="n">max_rvs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">rvs</span><span class="p">)</span>
<span class="n">min_rvs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">rvs</span><span class="p">)</span>

<span class="c1"># 期待値・分散の理論値</span>
<span class="n">exp_true</span> <span class="o">=</span> <span class="n">nbinom</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>
<span class="n">var_true</span> <span class="o">=</span> <span class="n">nbinom</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=========================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;負の二項分布・期待値/分散&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=========================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;期待値(乱数 vs 真値): </span><span class="si">{</span><span class="n">exp_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">exp_true</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;分散(乱数 vs 真値): </span><span class="si">{</span><span class="n">var_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">var_true</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;最大値 (乱数): </span><span class="si">{</span><span class="n">max_rvs</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;最小値 (乱数): </span><span class="si">{</span><span class="n">min_rvs</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># 可視化</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;======================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;負の二項分布&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;======================================&quot;</span><span class="p">)</span>

<span class="c1"># x軸</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_rvs</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># 図の定義</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

<span class="c1"># 乱数によるヒストグラム</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">rvs</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">stat</span><span class="o">=</span><span class="s2">&quot;probability&quot;</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;random variables&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>

<span class="c1"># 確率質量関数による真値</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">nbinom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;probability mass function&quot;</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Mass function&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=========================================
負の二項分布・擬似乱数
=========================================
[28 24 21 14  7 10 10 28  9 13  2 20  4 10 12 19 20 16 11  4 23 12 10 12
 17  5 10  9 15  7 21 17 13 21  5 11 19 17 22  4 34 25 41  3  9 13 10 15
 13  8 13 12 21  9  8  7 30 18 50 10 46 19 14 16 34 24 15  8 17 25 18 14
 28 22 18 16 14 18 14 28 14 30 22 56 11 15 32 10 17 19 23 12 21 17 26 13
 18 17 11  5]

=========================================
負の二項分布・期待値/分散
=========================================
期待値(乱数 vs 真値): 15.98008 vs 16.0
分散(乱数 vs 真値): 79.9489231936 vs 79.99999999999999
最大値 (乱数): 80
最小値 (乱数): 0

======================================
負の二項分布
======================================
</pre></div>
</div>
<img alt="../_images/probability-distribution_58_1.png" src="../_images/probability-distribution_58_1.png" />
</div>
</div>
<p><u>ユースケース</u></p>
<ul class="simple">
<li><p>購入頻度が負の二項分布に従う (<a class="reference external" href="https://qiita.com/nijigen_plot/items/9570487b73ad01fff36b">購買回数の分布と負の二項分布の関係</a>).</p></li>
</ul>
</section>
</section>
<section id="id7">
<h3>1.5. 連続型分布の具体例<a class="headerlink" href="#id7" title="Permalink to this headline">#</a></h3>
<section id="u-1-5-1-u">
<h4><u>例 1.5.1 (一様分布)</u><a class="headerlink" href="#u-1-5-1-u" title="Permalink to this headline">#</a></h4>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p><u>確率密度関数</u></p>
<p><strong>一様分布</strong> (uniform distribution) は <span class="math notranslate nohighlight">\(a &lt; b\)</span> とした時に以下の確率密度関数で表現される確率分布のことを指す.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        f(x) = \begin{cases}
            \frac{1}{b-a} &amp; (a \leq x \leq b) \\
            0             &amp; (x &lt; a, b &lt; x)
        \end{cases}
    \end{align}
\end{split}\]</div>
</div>
<p>ここで確率分布の性質である <a class="reference external" href="#math-1.5">(1.5)</a>, <a class="reference external" href="#math-1.6">(1.6)</a> を確認する.</p>
<p><u>数式 (1.5) の確認</u><br />
　確率密度関数の定義から <span class="math notranslate nohighlight">\(f(x) \geq 0\)</span> であることは自明.</p>
<p><u>数式 (1.6) の確認</u></p>
<p>以下の計算から <a class="reference external" href="#math-1.6">(1.6)</a> を満たすことも分かる.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        \int_{- \infty}^{\infty}{f(x)dx} &amp;= \int_{- \infty}^{a}{0 \cdot dx} + \int_{- \infty}^{\infty}{\frac{dx}{b-a}} + \int_{b}^{\infty}{0 \cdot dx} \\
                                         &amp;= \biggl[ \frac{x}{b-a} \biggr]_{a}^{b} \\
                                         &amp;= \frac{b}{b-a} - \frac{a}{b-a} = 1
    \end{align}
\end{split}\]</div>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p><u>期待値と分散</u></p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        &amp; {\rm E}(X) = \frac{a + b}{2} \\
        &amp; {\rm Var}(X) = \frac{(b-a)^2}{12}
    \end{align}
\end{split}\]</div>
</div>
<p><u>証明</u><br />
　期待値については, 式 <a class="reference external" href="#math-1.15">(1.15)</a> より</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm E}(X) &amp;= \int_{ a }^{ b }{ \frac{x}{b-a}dx } \\
                   &amp;= \biggl[ \frac{x^2}{2(b-a)} \biggr]_{a}^{b} \\
                   &amp;= \frac{1}{2(b-a)}(b^2 - a^2) \\
                   &amp;= \frac{(b+a)(b-a)}{2(b-a)} = \frac{a + b}{2}
    \end{align}
\end{split}\]</div>
<p>と求められる. また分散については <a class="reference external" href="#math-1.20">(1.20)</a> より <span class="math notranslate nohighlight">\({\rm E}(X^2)\)</span> を求めればよい.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm E}(X^2) &amp;= \int_{ a }^{ b }{ \frac{x^2}{b-a}dx } \\
                   &amp;= \biggl[ \frac{x^x}{3(b-a)} \biggr]_{a}^{b} \\
                   &amp;= \frac{1}{x(b-a)}(b^3 - a^3) \\
                   &amp;= \frac{(b^2 + ab + a^2)(b-a)()}{3(b-a)} = \frac{a^2 + ab + b^2}{3}
    \end{align}
\end{split}\]</div>
<p>よって</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm Var}(X) &amp;= {\rm}E(X^2) - ({\rm E}(X))^2 \\
                     &amp;= \frac{a^2 + ab + b^2}{3} - \frac{(a + b)^2}{4} \\
                     &amp;= \frac{(b-a)^2}{12}
    \end{align}
\end{split}\]</div>
<p><u>python での擬似乱数生成</u></p>
<p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.uniform.html#scipy.stats.uniform"><code class="docutils literal notranslate"><span class="pre">scipy.stats.uniform</span></code></a> を用いて生成する. <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.uniform.html#scipy.stats.uniform"><code class="docutils literal notranslate"><span class="pre">scipy.stats.uniform</span></code></a> では <code class="docutils literal notranslate"><span class="pre">loc</span></code>, <code class="docutils literal notranslate"><span class="pre">scale</span></code> のパラメータによって区間 <code class="docutils literal notranslate"><span class="pre">[loc,</span> <span class="pre">loc</span> <span class="pre">+</span> <span class="pre">scale]</span></code> の一様分布を生成する. この時, <code class="docutils literal notranslate"><span class="pre">loc</span></code> <span class="math notranslate nohighlight">\( = a\)</span>, <code class="docutils literal notranslate"><span class="pre">scale</span></code> <span class="math notranslate nohighlight">\( = b -a\)</span> である.<br />
　また, <a class="reference external" href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.Generator.uniform.html"><code class="docutils literal notranslate"><span class="pre">numpy.random.Generator.uniform</span></code></a> を用いても生成できる. ただし擬似乱数生成器の機能しかない.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">uniform</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>

<span class="c1"># loc = 3, scale = 8 に関する一様分布に従った疑似乱数を size = 100000 だけ生成する (a = 3, b = 11).</span>
<span class="n">loc</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">scale</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">100000</span>
<span class="n">rvs</span> <span class="o">=</span> <span class="n">uniform</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>

<span class="c1"># numpy を使用した擬似乱数生成</span>
<span class="n">low</span> <span class="o">=</span> <span class="n">loc</span>
<span class="n">high</span> <span class="o">=</span> <span class="n">loc</span> <span class="o">+</span> <span class="n">scale</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">()</span>
<span class="n">rvs_numpy</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="n">low</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="n">high</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=========================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;一様分布・擬似乱数&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=========================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rvs</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">100</span><span class="p">])</span>

<span class="c1"># 擬似乱数から期待値・分散の計算</span>
<span class="n">exp_rvs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rvs</span><span class="p">)</span>
<span class="n">var_rvs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">rvs</span><span class="p">)</span>
<span class="n">max_rvs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">rvs</span><span class="p">)</span>
<span class="n">min_rvs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">rvs</span><span class="p">)</span>

<span class="c1"># 期待値・分散の理論値</span>
<span class="n">exp_true</span> <span class="o">=</span> <span class="n">uniform</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>
<span class="n">var_true</span> <span class="o">=</span> <span class="n">uniform</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=========================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;一様分布・期待値/分散&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=========================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;期待値(乱数 vs 真値): </span><span class="si">{</span><span class="n">exp_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">exp_true</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;分散(乱数 vs 真値): </span><span class="si">{</span><span class="n">var_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">var_true</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;最大値 (乱数): </span><span class="si">{</span><span class="n">max_rvs</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;最小値 (乱数): </span><span class="si">{</span><span class="n">min_rvs</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># 可視化</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;======================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;一様分布&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;======================================&quot;</span><span class="p">)</span>

<span class="c1"># x軸</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_rvs</span> <span class="o">+</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># 図の定義</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

<span class="c1"># 乱数によるヒストグラム</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">hist</span><span class="p">([</span><span class="n">rvs</span><span class="p">,</span> <span class="n">rvs_numpy</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="s2">&quot;skyblue&quot;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;[SciPy] random variables&quot;</span><span class="p">,</span> <span class="s2">&quot;[NumPy] random variables&quot;</span><span class="p">])</span>

<span class="c1"># 確率質量関数による真値</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">uniform</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;probability density function&quot;</span><span class="p">)</span>

<span class="c1"># ax1.set_title(&quot;Mass function&quot;)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=========================================
一様分布・擬似乱数
=========================================
[ 9.95065512  6.49813316  7.68515292  6.44018504  4.89156344  4.46324227
  6.32769051 10.04815304  4.85728661  7.75358878  4.89624001  4.46252287
  5.01374982 10.89559954  7.2098469   6.61909724  8.23607335  7.83938134
  5.23790672  7.76578471  7.51763625 10.03306316 10.69633023  5.63304553
  6.85612567  3.34050016  7.09844287  7.84154807  6.68040171  5.37666393
  8.06861187  5.37056701  7.73186379  4.72960485  9.90314483  6.28297915
  9.95946764  3.58221712  6.53383242  3.37646909  5.05601151  3.47242238
  6.81961715  4.73973759  8.46290581  5.4986219   4.82042336  4.70064754
  9.83655385  4.92753148  3.13477314  3.1993617   4.11165284 10.61340077
 10.81796988  5.26187975  3.40482608  7.48412709  6.75338749  3.03543786
  5.78534164  6.02825652  5.93540719  8.37468458 10.64147265  3.6829674
  9.66665689  3.10204102  8.22110997  4.66456886  8.42479926  7.69269491
  8.16260313  8.53234849  3.59284219  8.41011392  3.36416211  8.8423773
 10.68205912  3.14284725  6.08907305  3.25714644  8.79141958 10.96514209
  3.85622802  8.91389051 10.87117559  3.96466692  3.55756781  5.22799807
  5.71533204  6.63163321  7.84868259  6.40701899  9.72294278  6.32203265
  6.69899345  3.59193916  5.81241377  3.98780659]

=========================================
一様分布・期待値/分散
=========================================
期待値(乱数 vs 真値): 6.99414300335008 vs 7.0
分散(乱数 vs 真値): 5.343248378675635 vs 5.333333333333333
最大値 (乱数): 10.999995522198578
最小値 (乱数): 3.0001857230117492

======================================
一様分布
======================================
</pre></div>
</div>
<img alt="../_images/probability-distribution_65_1.png" src="../_images/probability-distribution_65_1.png" />
</div>
</div>
<p><u>ユースケース</u></p>
<ul class="simple">
<li><p>一様分布の擬似乱数をもとに他の分布の擬似乱数を生成</p></li>
<li><p>モンテカルロシミュレーションの初期値として一様分布疑似乱数を使用</p></li>
</ul>
</section>
<section id="u-1-5-2-u">
<h4><u>例 1.5.2 (正規分布)</u><a class="headerlink" href="#u-1-5-2-u" title="Permalink to this headline">#</a></h4>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p><u>確率密度関数</u></p>
<p><strong>正規分布</strong> (normal distribution, ガウス分布 &lt;Gaussian distribution&gt;ともいう) はパラメータ <span class="math notranslate nohighlight">\(\mu \geq 0, \sigma \gt 0\)</span> を用いて以下の確率密度関数をもつ分布. 後ほど証明するが, <span class="math notranslate nohighlight">\(\mu\)</span> は期待値, <span class="math notranslate nohighlight">\(\sigma^2\)</span> は分散となる.</p>
<div class="math notranslate nohighlight">
\[
    f(x) = \frac{1}{\sqrt{2\pi} \sigma} \exp{ \biggl( - \frac{(x -\mu)^2}{2 \sigma^2} \biggr) }
\]</div>
</div>
<p>ここで確率分布の性質である <a class="reference external" href="#math-1.5">(1.5)</a>, <a class="reference external" href="#math-1.6">(1.6)</a> を確認する.</p>
<p><u>数式 (1.5) の確認</u><br />
　確率密度関数の定義から <span class="math notranslate nohighlight">\(f(x) \geq 0\)</span> であることは自明.</p>
<p><u>数式 (1.6) の確認</u></p>
<p><span class="math notranslate nohighlight">\(y = x - \mu\)</span> とすると, <span class="math notranslate nohighlight">\(dy = dx\)</span> で以下の計算のようになる.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        \int_{- \infty}^{\infty}{f(x)dx} &amp;= \frac{1}{\sqrt{2\pi} \sigma} \int_{- \infty}^{ \infty }{ \exp{ \biggl( - \frac{(x -\mu)^2}{2 \sigma^2} \biggr) } dx} \\
                                         &amp;= \frac{1}{\sqrt{2\pi} \sigma} \int_{- \infty}^{ \infty }{ \exp{ \biggl( - \frac{ y^2 }{2 \sigma^2} \biggr) } dy} \\
                                         &amp;= \frac{1}{\sqrt{2\pi} \sigma} \cdot \sqrt{2\pi} \sigma \\
                                         &amp;= 1
    \end{align}
\end{split}\]</div>
<p>上記は以下の積分結果を利用している.</p>
<div class="math notranslate nohighlight">
\[
    \begin{align}
        I = \int_{- \infty}^{\infty}{ e^{-ax^2}dx } &amp;= \sqrt{\frac{\pi}{a}} \quad (a &gt; 0)
    \end{align}
\]</div>
<p>これは以下の計算から分かる.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        I^2 &amp;= \int_{- \infty}^{\infty}{ e^{-ax^2}dx } \int_{- \infty}^{\infty}{ e^{-ay^2}dy } \\
            &amp;= \int_{- \infty}^{\infty}{ \int_{- \infty}^{\infty}{ e^{ -a(x^2 + y^2) }dxdy } }
    \end{align}
\end{split}\]</div>
<p>ここで <span class="math notranslate nohighlight">\(x = r\cos {\theta}\)</span>, <span class="math notranslate nohighlight">\(y = r\sin {\theta}\)</span> と置換すると, ヤコビアンは <span class="math notranslate nohighlight">\(r\)</span> より <span class="math notranslate nohighlight">\(dxdy = rdrd\theta\)</span> で, <span class="math notranslate nohighlight">\(\theta: 0 \rightarrow 2\pi\)</span>, <span class="math notranslate nohighlight">\(r: 0 \rightarrow \infty\)</span> より</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        I^2 &amp;= \int_{ 0 }^{ \infty }{ \int_{ 0 }^{ 2\pi }{ e^{ -ar^2 }rdrd\theta } } \\
            &amp;= 2 \pi \int_{ 0 }^{ \infty }{ e^{ -ar^2 }rdr  } \\
            &amp;= 2 \pi \biggl[ \frac{e^{-ar^2}}{-2a} \biggr]_{0}^{\infty} = \frac{\pi}{a}
    \end{align}
\end{split}\]</div>
<p>よって,</p>
<div class="math notranslate nohighlight">
\[
    \begin{align}
        I = \sqrt{\frac{\pi}{a}} \quad
    \end{align}
\]</div>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p><u>期待値と分散</u></p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        &amp; {\rm E}(X) = \mu \\
        &amp; {\rm Var}(X) = \sigma^2
    \end{align}
\end{split}\]</div>
</div>
<p><u>証明</u><br />
　期待値については, 式 <a class="reference external" href="#math-1.15">(1.15)</a> より</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm E}(X) &amp;= \int_{ -\infty }^{ \infty }{ x \frac{1}{\sqrt{2\pi} \sigma} \exp{ \biggl( - \frac{(x -\mu)^2}{2 \sigma^2} \biggr) }dx } \\
                   &amp;= \int_{ -\infty }^{ \infty }{ \frac{1}{\sqrt{2\pi} \sigma} (\sigma y + \mu) \exp{ \biggl( - \frac{ y^2 }{2} \biggr) } \sigma dy } \quad (x-\mu=\sigma y) \\
                   &amp;= \frac{\sigma}{\sqrt{2 \pi}} \int_{ -\infty }^{ \infty }{ y \exp{\biggl( -\frac{y^2}{2} \biggr)} dy } + \frac{\mu}{\sqrt{2 \pi}} \int_{ -\infty }^{ \infty }{ \exp{\biggl( -\frac{y^2}{2} \biggr)} dy } \\
                   &amp;= \frac{\mu}{\sqrt{2 \pi}} \cdot \sqrt{2 \pi} = \mu
    \end{align}
\end{split}\]</div>
<p>と求められる. 第 1 項は奇関数のため 0 となる. また分散については <a class="reference external" href="#math-1.20">(1.20)</a> より <span class="math notranslate nohighlight">\({\rm E}(X^2)\)</span> を求めればよい.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm E}(X^2) &amp;= \int_{ -\infty }^{ \infty }{ x^2 \frac{1}{\sqrt{2\pi} \sigma} \exp{ \biggl( - \frac{(x -\mu)^2}{2 \sigma^2} \biggr) }dx } \\
                     &amp;= \frac{\sigma}{\sqrt{2 \pi} \sigma} \int_{ -\infty }^{ \infty }{ (\sigma y + \mu)^2 \exp{ \biggl( - \frac{y^2}{2} \biggr) }\sigma dy } \quad (x-\mu=\sigma y) \\
                     &amp;= \frac{1}{\sqrt{2 \pi}} \int_{ -\infty }^{ \infty }{ (\sigma^2 y^2 + 2 \sigma \mu y +  \mu^2) \exp{ \biggl( - \frac{y^2}{2} \biggr) } dy } \\
                     &amp;= \frac{\sigma^2}{\sqrt{2 \pi}} \int_{ -\infty }^{ \infty }{ y^2 \exp{ \biggl( - \frac{y^2}{2} \biggr) } dy } + \frac{\mu^2}{\sqrt{2 \pi}} \int_{ -\infty }^{ \infty }{ \exp{ \biggl( - \frac{y^2}{2} \biggr) } dy } \quad (\text{奇関数については0}) \\
                     &amp;= \frac{\sigma^2}{\sqrt{2 \pi}} \biggl\{ \biggl[ -yr^{\frac{-y^2}{2}}\biggr]_{-\infty}^{\infty} + \int_{ -\infty }^{ \infty }{ \exp{ \biggl( - \frac{y^2}{2} \biggr) } dy } \biggr\} + \frac{\mu^2}{\sqrt{2 \pi}} \int_{ -\infty }^{ \infty }{ \exp{ \biggl( - \frac{y^2}{2} \biggr) } dy } \quad (\text{第1項は部分積分}) \\
                     &amp;= \frac{\sigma^2}{\sqrt{2 \pi}} (0 + \sqrt{2 \pi}) + \frac{\mu^2}{\sqrt{2 \pi}} \cdot \sqrt{2 \pi} = \sigma^2 + \mu^2
    \end{align}
\end{split}\]</div>
<p>よって</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm Var}(X) &amp;= {\rm}E(X^2) - ({\rm E}(X))^2 \\
                     &amp;= \sigma^2 + \mu^2 - \mu^2 \\
                     &amp;= \sigma^2
    \end{align}
\end{split}\]</div>
<p><u>python での擬似乱数生成</u></p>
<p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.norm.html#scipy.stats.norm"><code class="docutils literal notranslate"><span class="pre">scipy.stats.norm</span></code></a> を用いて生成する.<br />
　また, <a class="reference external" href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.Generator.normal.html"><code class="docutils literal notranslate"><span class="pre">numpy.random.Generator.normal</span></code></a> を用いても生成できる. ただし擬似乱数生成器の機能しかない.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>

<span class="c1"># loc = 10, scale = 2 に関する正規分布に従った疑似乱数を size = 100000 だけ生成する.</span>
<span class="n">loc</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">scale</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">100000</span>
<span class="n">rvs</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>

<span class="c1"># numpy を使用した擬似乱数生成</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">()</span>
<span class="n">rvs_numpy</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=========================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;正規分布・擬似乱数&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=========================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rvs</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">100</span><span class="p">])</span>

<span class="c1"># 擬似乱数から期待値・分散の計算</span>
<span class="n">exp_rvs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rvs</span><span class="p">)</span>
<span class="n">var_rvs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">rvs</span><span class="p">)</span>
<span class="n">max_rvs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">rvs</span><span class="p">)</span>
<span class="n">min_rvs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">rvs</span><span class="p">)</span>

<span class="c1"># 期待値・分散の理論値</span>
<span class="n">exp_true</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>
<span class="n">var_true</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=========================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;正規分布・期待値/分散&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=========================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;期待値(乱数 vs 真値): </span><span class="si">{</span><span class="n">exp_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">exp_true</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;分散(乱数 vs 真値): </span><span class="si">{</span><span class="n">var_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">var_true</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;最大値 (乱数): </span><span class="si">{</span><span class="n">max_rvs</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;最小値 (乱数): </span><span class="si">{</span><span class="n">min_rvs</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># 可視化</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;======================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;正規分布&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;======================================&quot;</span><span class="p">)</span>

<span class="c1"># x軸</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_rvs</span> <span class="o">+</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># 図の定義</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

<span class="c1"># 乱数によるヒストグラム</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">hist</span><span class="p">([</span><span class="n">rvs</span><span class="p">,</span> <span class="n">rvs_numpy</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="s2">&quot;skyblue&quot;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;[SciPy] random variables&quot;</span><span class="p">,</span> <span class="s2">&quot;[NumPy] random variables&quot;</span><span class="p">])</span>

<span class="c1"># 確率質量関数による真値</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;probability density function&quot;</span><span class="p">)</span>

<span class="c1"># ax1.set_title(&quot;Mass function&quot;)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=========================================
正規分布・擬似乱数
=========================================
[ 8.52432291 11.18604672 10.93026812 10.48388263  8.50666357 11.69789225
 12.22680988 10.8029566   8.57399401  8.08640617 15.85768921 10.09683162
 11.15917967 13.33517135  9.92720679 11.20385501  9.77216305 11.47165924
 15.15221008  8.96859431  9.57802678  9.91454242 10.1840107  12.22317572
 10.3571056   6.67185227  9.65537319  7.56087489  6.75179813 11.5464493
  7.67711436 10.19913441 11.66578403 11.73806474 11.5578451  11.11489058
  8.21109545  5.53997255 11.42222609  8.21596144 11.63582202 11.2938368
  5.64247411 11.88785734 10.46772369  9.69514741 12.0394441  11.1483408
 11.09643666 11.76462401  8.81784898  7.38313185  9.3887632   5.4781994
 10.34234273  6.63793771  8.8504272   9.47458223 12.6327981  10.95263761
  7.32274152 10.68468876 10.16554401 12.70036991 11.2093694  10.074052
 11.66356431  9.15601016  9.85853301 10.40828189 10.12187743 10.49309865
  8.761231    8.66606476 11.89475823  9.47637695 10.30357235  9.79539862
  9.38233764 10.18309708  8.04538081  8.91961607  9.2691468   8.51418987
  9.11054661 11.77412534  9.97588353  9.64098193 11.45028499 12.30511758
 11.34507065  5.38769591  9.27063714 11.68652268 11.03349055  9.4549378
 11.98438313 15.5886565  12.77157173 10.12692325]

=========================================
正規分布・期待値/分散
=========================================
期待値(乱数 vs 真値): 10.012437311810839 vs 10.0
分散(乱数 vs 真値): 3.945113239964285 vs 4.0
最大値 (乱数): 18.34730195461606
最小値 (乱数): 1.8218283772568942

======================================
正規分布
======================================
</pre></div>
</div>
<img alt="../_images/probability-distribution_71_1.png" src="../_images/probability-distribution_71_1.png" />
</div>
</div>
<p><u>ユースケース</u></p>
<ul class="simple">
<li><p>工事中</p></li>
</ul>
</section>
<section id="u-1-5-3-u">
<h4><u>定理 1.5.3 (中心極限定理)</u><a class="headerlink" href="#u-1-5-3-u" title="Permalink to this headline">#</a></h4>
<p><strong>中心極限定理</strong> (central limit theorem) とは, いかなる確率分布でもその母集団から取り出した標本の平均値の分布は, 平均を計算する回数が大きくなるにつれて正規分布に近づくという定理. これを数学的に表現すると以下のように書ける.</p>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p>平均 <span class="math notranslate nohighlight">\(\mu\)</span>, 分散 <span class="math notranslate nohighlight">\(\sigma^2\)</span> の独立同分布の確率変数 <span class="math notranslate nohighlight">\(X_1, X_2, \cdots\)</span> に対して, <span class="math notranslate nohighlight">\(\overline{X}(n) = \frac{1}{n} \sum_{i=1}^{n}{X_i}\)</span> とおくと以下が成立する.</p>
<div class="math notranslate nohighlight">
\[
    \lim_{n \rightarrow \infty} {P \biggl(a \leq \frac{\overline{X}(n) - \mu}{\sigma / \sqrt{n}} \leq b \biggr)} = \int_{a}^{b}{ \frac{1}{\sqrt{2 \pi}} e^{-\frac{x^2}{2}} dx }
\]</div>
</div>
<p><u>証明</u></p>
<p><span class="math notranslate nohighlight">\(Y(n)\)</span> を以下のように定義する.</p>
<div class="math notranslate nohighlight">
\[
    Y(n) = \frac{\overline{X}(n) - \mu}{\sigma / \sqrt{n}}
\]</div>
<p>この時, <span class="math notranslate nohighlight">\(Y(n)\)</span> の積率母関数が <span class="math notranslate nohighlight">\(N(0,1)\)</span> の積率母関数に収束することを示せばよい.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        Y(n) &amp;= \frac{n\overline{X}(n) - n\mu}{\sigma \sqrt{n}} \\
             &amp;= \frac{ \sum_{i=1}^{n}{X_i} - \sum_{i=1}^{n}{\mu} }{\sigma \sqrt{n}} \\
             &amp;= \frac{1}{\sqrt{n}} \sum_{i=1}^{n}{ \frac{ X_i - \mu }{\sigma} }
    \end{align}
\end{split}\]</div>
<p>となるので, ここで確率変数 <span class="math notranslate nohighlight">\(Z_i = \dfrac{X_i - \mu}{\sigma}\)</span> を導入すると, <span class="math notranslate nohighlight">\(Z_i\)</span> は次の性質を示す.</p>
<div class="math notranslate nohighlight">
\[
    Y(n) = \frac{1}{\sqrt{n}} \sum_{i=1}^{n}{ Z_i } \quad {\rm E}(Z_i) = 0, \quad {\rm Var}(Z_i) = 1
\]</div>
<p><span class="math notranslate nohighlight">\(Y(n)\)</span> の積率母関数 <span class="math notranslate nohighlight">\(M_{Y(n)}(t)\)</span> は,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        M_{Y(n)}(t) &amp;= {\rm E}( \exp{ [ tY(n) ] } ) \\
                    &amp;= {\rm E}\biggl( \exp{ \biggl[ \frac{t}{\sqrt{n}} \sum_{i=1}^{n}{ Z_i } \biggr] } \biggr) \\
                    &amp;= {\rm E}\bigl( e^{\frac{t}{n}\sqrt{Z_1}} \times e^{\frac{t}{n}\sqrt{Z_2}} \times \cdots \times e^{\frac{t}{n}\sqrt{Z_n}} \bigr)
    \end{align}
\end{split}\]</div>
<p><span class="math notranslate nohighlight">\(X_1, X_2, \cdots\)</span> は互いに独立であり, その確率変数から定義された <span class="math notranslate nohighlight">\(Z_1, Z_2, \cdots\)</span> も互いに独立である. ゆえに上式は</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        M_{Y(n)}(t) &amp;= {\rm E}\bigl( e^{\frac{t}{n}\sqrt{Z_1}} \times e^{\frac{t}{n}\sqrt{Z_2}} \times \cdots \times e^{\frac{t}{n}\sqrt{Z_n}} \bigr) \\
                    &amp;= {\rm E}\bigl( e^{\frac{t}{n}\sqrt{Z_1}} \bigr) \times {\rm E}\bigl( e^{\frac{t}{n}\sqrt{Z_2}} \bigr) \times \cdots \times {\rm E}\bigl( e^{\frac{t}{n}\sqrt{Z_n}} \bigr)
    \end{align}
\end{split}\]</div>
<p>となる. また, <span class="math notranslate nohighlight">\(X_1, X_2, \cdots\)</span> は同じ確率分布であり, その確率変数から定義された <span class="math notranslate nohighlight">\(Z_1, Z_2, \cdots\)</span> も同じ確率分布なので上式はさらに</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        M_{Y(n)}(t) &amp;= \Bigl( {\rm E}\bigl( e^{\frac{t}{n}\sqrt{Z_1}} \bigr) \Bigr)^n \\
                    &amp;= \biggl( M_{Z_1} \biggl( \frac{t}{\sqrt{n}} \biggr) \biggr)^n \label{☆}\tag{☆}
    \end{align}
\end{split}\]</div>
<p>となり, <span class="math notranslate nohighlight">\(Z\)</span> の積率母関数の冪乗で表現できる. <span class="math notranslate nohighlight">\(M_{Z_1}(t)\)</span> に対してマクローリン展開を適応する.</p>
<div class="math notranslate nohighlight">
\[
    M_{Z_1}(t) = M_{Z_1}(0) + \left.\frac{dM_{Z_1}(t)}{dt}\right|_{t=0} t + \left.\frac{1}{2}\frac{d^2M_{Z_1}(t)}{dt^2}\right|_{t=0} t^2 + O(t^3)
\]</div>
<p>ここで,</p>
<div class="math notranslate nohighlight">
\[
    M_{Z_1}(0) = 1, \quad
    \left.\frac{dM_{Z_1}(t)}{dt}\right|_{t=0} = \mu_1 = {\rm E}(Z_1) = 0, \quad
    \left.\frac{1}{2}\frac{d^2M_{Z_1}(t)}{dt^2}\right|_{t=0} = \mu_2 = {\rm E}(X^2) = 1
\]</div>
<p>より <span class="math notranslate nohighlight">\(M_{Z_1}(t) = 1 + \dfrac{t^2}{2} + O(t^3)\)</span> である. よって</p>
<div class="math notranslate nohighlight">
\[
    M_{Z_1} \biggl( \frac{t}{\sqrt{n}} \biggr) = 1 + \frac{t^2}{2n} + O \biggl( \biggl( \frac{t}{\sqrt{n}} \biggr)^3 \biggr)
\]</div>
<p>なので, 式 <span class="math notranslate nohighlight">\((\ref{☆})\)</span> に代入すれば</p>
<div class="math notranslate nohighlight">
\[
    M_{Y_(n)} (t) = \biggl( 1 + \frac{t^2}{2n} + O \biggl( \biggl( \frac{t}{\sqrt{n}} \biggr)^3 \biggr) \biggr)^n.
\]</div>
<p>よって</p>
<div class="math notranslate nohighlight">
\[
    \lim_{n \rightarrow \infty}{M_{Y_(n)} (t)} = \lim_{n \rightarrow \infty}{ \biggl( 1 + \frac{t^2}{2n}  \biggr)^n } = e^{\frac{1}{2}t^2}
\]</div>
<p>これは <span class="math notranslate nohighlight">\(N(0,1)\)</span> の積率母関数と一致する.</p>
<p>python で中心極限定理を確認してみる.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">uniform</span><span class="p">,</span> <span class="n">norm</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>

<span class="c1"># ----------------------------------------------------------------------------------</span>
<span class="c1"># 一様分布に従う標本平均のサイズ数を増やすことで, 標本平均が正規分布に従うことの確認</span>
<span class="c1"># </span>
<span class="c1"># ** 1回の試行においてサンプル数を size で定義</span>
<span class="c1"># ** 標本平均のサイズ数については trials_list で徐々に増加</span>
<span class="c1"># ----------------------------------------------------------------------------------</span>
<span class="c1"># 図の定義</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>

<span class="c1"># x軸の定義</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.35</span><span class="p">,</span> <span class="mf">0.65</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>

<span class="c1"># 擬似乱数生成</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">trials_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">]</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">()</span>
<span class="n">j</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">for</span> <span class="n">trials</span> <span class="ow">in</span> <span class="n">trials_list</span><span class="p">:</span>
    <span class="n">means</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">trials</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">trials</span><span class="p">):</span>
        <span class="n">rvs</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
        <span class="n">means</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">rvs</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    
    <span class="c1"># 一様分布から抽出したサンプル平均を trials 回だけドローしたもののヒストグラム.</span>
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">means</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">stat</span><span class="o">=</span><span class="s2">&quot;probability&quot;</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;random variables&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>
    <span class="n">title</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;trials = </span><span class="si">{</span><span class="n">trials</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    
    <span class="c1"># 正規性を確認するための Q-Q プロット.</span>
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">j</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">stats</span><span class="o">.</span><span class="n">probplot</span><span class="p">(</span><span class="n">means</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="n">plt</span><span class="p">)</span>
    
    <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/probability-distribution_75_0.png" src="../_images/probability-distribution_75_0.png" />
</div>
</div>
</section>
<section id="u-1-5-4-u">
<h4><u>例 1.5.4 (対数正規分布)</u><a class="headerlink" href="#u-1-5-4-u" title="Permalink to this headline">#</a></h4>
<p><strong>負の二項分布</strong> (negative binomial distribution) は幾何分布を一般化されたものであり, <span class="math notranslate nohighlight">\(n\)</span> 回目の成功を得るまでの失敗の回数を <span class="math notranslate nohighlight">\(x\)</span> とした時の確率分布である.</p>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p><u>確率密度関数</u></p>
<p><span class="math notranslate nohighlight">\(x = 0, 1, \cdots\)</span> とする.</p>
<div class="math notranslate nohighlight">
\[
    f(x) = {}_{n+x-1}{\rm C}_{x} p^n q^x
\]</div>
</div>
<p>ここで確率分布の性質である <a class="reference external" href="#math-1.5">(1.5)</a>, <a class="reference external" href="#math-1.6">(1.6)</a> を確認する.</p>
<p><u>数式 (1.5) の確認</u><br />
　確率密度関数の定義から <span class="math notranslate nohighlight">\(f(x) \geq 0\)</span> であることは自明.</p>
<p><u>数式 (1.6) の確認</u></p>
<p>XXXXXX</p>
<div class="math notranslate nohighlight">
\[
    \sum_{x=0}^{\infty}{{}_{n+x-1}{\rm C}_{x}p^n q^x} = 1
\]</div>
<p>XXXXX</p>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p><u>期待値と分散</u></p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        &amp; {\rm E}(X) = \frac{nq}{p} \\
        &amp; {\rm Var}(X) = \frac{nq}{p^2}
    \end{align}
\end{split}\]</div>
</div>
<p><u>証明</u><br />
　期待値については, 式 <a class="reference external" href="#math-1.15">(1.15)</a> より</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm E}(X) &amp;= \sum_{x=0}^{\infty}{x {}_{ n+x-1 }{\rm C}_{ x } p^n q^x } \\
                   &amp;= \sum_{x=1}^{\infty}{x \frac{ (n+x-1)! }{ (n-1)! x! } p^n q^x } \\
                   &amp;= \sum_{x=1}^{\infty}{ \frac{ (n+x-1)! }{ (n-1)! (x-1)! } p^n q^x }
    \end{align}
\end{split}\]</div>
<p>と求められる. また分散については <a class="reference external" href="#math-1.20">(1.20)</a> より</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm Var}(X) &amp;= {\rm}E(X^2) - ({\rm E}(X))^2 \\
                     &amp;= {\rm}E(X(X-1)+X) - ({\rm E}(X))^2 \\
                     &amp;= {\rm}E(X(X-1)) + {\rm}E(X) - ({\rm E}(X))^2
    \end{align}
\end{split}\]</div>
<p><u>python での擬似乱数生成</u></p>
<p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.nbinom.html#scipy.stats.nbinom"><code class="docutils literal notranslate"><span class="pre">scipy.stats.nbinom</span></code></a> を用いて生成する.</p>
<p><u>ユースケース</u></p>
<ul class="simple">
<li><p>購入頻度が負の二項分布に従う (<a class="reference external" href="https://qiita.com/nijigen_plot/items/9570487b73ad01fff36b">購買回数の分布と負の二項分布の関係</a>).</p></li>
</ul>
</section>
<section id="u-1-5-5-u">
<h4><u>例 1.5.5 (指数分布)</u><a class="headerlink" href="#u-1-5-5-u" title="Permalink to this headline">#</a></h4>
<p><strong>負の二項分布</strong> (negative binomial distribution) は幾何分布を一般化されたものであり, <span class="math notranslate nohighlight">\(n\)</span> 回目の成功を得るまでの失敗の回数を <span class="math notranslate nohighlight">\(x\)</span> とした時の確率分布である.</p>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p><u>確率密度関数</u></p>
<p><span class="math notranslate nohighlight">\(x = 0, 1, \cdots\)</span> とする.</p>
<div class="math notranslate nohighlight">
\[
    f(x) = {}_{n+x-1}{\rm C}_{x} p^n q^x
\]</div>
</div>
<p>ここで確率分布の性質である <a class="reference external" href="#math-1.5">(1.5)</a>, <a class="reference external" href="#math-1.6">(1.6)</a> を確認する.</p>
<p><u>数式 (1.5) の確認</u><br />
　確率密度関数の定義から <span class="math notranslate nohighlight">\(f(x) \geq 0\)</span> であることは自明.</p>
<p><u>数式 (1.6) の確認</u></p>
<p>XXXXXX</p>
<div class="math notranslate nohighlight">
\[
    \sum_{x=0}^{\infty}{{}_{n+x-1}{\rm C}_{x}p^n q^x} = 1
\]</div>
<p>XXXXX</p>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p><u>期待値と分散</u></p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        &amp; {\rm E}(X) = \frac{nq}{p} \\
        &amp; {\rm Var}(X) = \frac{nq}{p^2}
    \end{align}
\end{split}\]</div>
</div>
<p><u>証明</u><br />
　期待値については, 式 <a class="reference external" href="#math-1.15">(1.15)</a> より</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm E}(X) &amp;= \sum_{x=0}^{\infty}{x {}_{ n+x-1 }{\rm C}_{ x } p^n q^x } \\
                   &amp;= \sum_{x=1}^{\infty}{x \frac{ (n+x-1)! }{ (n-1)! x! } p^n q^x } \\
                   &amp;= \sum_{x=1}^{\infty}{ \frac{ (n+x-1)! }{ (n-1)! (x-1)! } p^n q^x }
    \end{align}
\end{split}\]</div>
<p>と求められる. また分散については <a class="reference external" href="#math-1.20">(1.20)</a> より</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm Var}(X) &amp;= {\rm}E(X^2) - ({\rm E}(X))^2 \\
                     &amp;= {\rm}E(X(X-1)+X) - ({\rm E}(X))^2 \\
                     &amp;= {\rm}E(X(X-1)) + {\rm}E(X) - ({\rm E}(X))^2
    \end{align}
\end{split}\]</div>
<p><u>python での擬似乱数生成</u></p>
<p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.nbinom.html#scipy.stats.nbinom"><code class="docutils literal notranslate"><span class="pre">scipy.stats.nbinom</span></code></a> を用いて生成する.</p>
<p><u>ユースケース</u></p>
<ul class="simple">
<li><p>購入頻度が負の二項分布に従う (<a class="reference external" href="https://qiita.com/nijigen_plot/items/9570487b73ad01fff36b">購買回数の分布と負の二項分布の関係</a>).</p></li>
</ul>
</section>
<section id="u-1-5-6-u">
<h4><u>例 1.5.6 (ベータ分布)</u><a class="headerlink" href="#u-1-5-6-u" title="Permalink to this headline">#</a></h4>
<p><strong>負の二項分布</strong> (negative binomial distribution) は幾何分布を一般化されたものであり, <span class="math notranslate nohighlight">\(n\)</span> 回目の成功を得るまでの失敗の回数を <span class="math notranslate nohighlight">\(x\)</span> とした時の確率分布である.</p>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p><u>確率密度関数</u></p>
<p><span class="math notranslate nohighlight">\(x = 0, 1, \cdots\)</span> とする.</p>
<div class="math notranslate nohighlight">
\[
    f(x) = {}_{n+x-1}{\rm C}_{x} p^n q^x
\]</div>
</div>
<p>ここで確率分布の性質である <a class="reference external" href="#math-1.5">(1.5)</a>, <a class="reference external" href="#math-1.6">(1.6)</a> を確認する.</p>
<p><u>数式 (1.5) の確認</u><br />
　確率密度関数の定義から <span class="math notranslate nohighlight">\(f(x) \geq 0\)</span> であることは自明.</p>
<p><u>数式 (1.6) の確認</u></p>
<p>XXXXXX</p>
<div class="math notranslate nohighlight">
\[
    \sum_{x=0}^{\infty}{{}_{n+x-1}{\rm C}_{x}p^n q^x} = 1
\]</div>
<p>XXXXX</p>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p><u>期待値と分散</u></p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        &amp; {\rm E}(X) = \frac{nq}{p} \\
        &amp; {\rm Var}(X) = \frac{nq}{p^2}
    \end{align}
\end{split}\]</div>
</div>
<p><u>証明</u><br />
　期待値については, 式 <a class="reference external" href="#math-1.15">(1.15)</a> より</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm E}(X) &amp;= \sum_{x=0}^{\infty}{x {}_{ n+x-1 }{\rm C}_{ x } p^n q^x } \\
                   &amp;= \sum_{x=1}^{\infty}{x \frac{ (n+x-1)! }{ (n-1)! x! } p^n q^x } \\
                   &amp;= \sum_{x=1}^{\infty}{ \frac{ (n+x-1)! }{ (n-1)! (x-1)! } p^n q^x }
    \end{align}
\end{split}\]</div>
<p>と求められる. また分散については <a class="reference external" href="#math-1.20">(1.20)</a> より</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm Var}(X) &amp;= {\rm}E(X^2) - ({\rm E}(X))^2 \\
                     &amp;= {\rm}E(X(X-1)+X) - ({\rm E}(X))^2 \\
                     &amp;= {\rm}E(X(X-1)) + {\rm}E(X) - ({\rm E}(X))^2
    \end{align}
\end{split}\]</div>
<p><u>python での擬似乱数生成</u></p>
<p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.nbinom.html#scipy.stats.nbinom"><code class="docutils literal notranslate"><span class="pre">scipy.stats.nbinom</span></code></a> を用いて生成する.</p>
<p><u>ユースケース</u></p>
<ul class="simple">
<li><p>購入頻度が負の二項分布に従う (<a class="reference external" href="https://qiita.com/nijigen_plot/items/9570487b73ad01fff36b">購買回数の分布と負の二項分布の関係</a>).</p></li>
</ul>
</section>
<section id="u-1-5-7-u">
<h4><u>例 1.5.7 (コーシー分布)</u><a class="headerlink" href="#u-1-5-7-u" title="Permalink to this headline">#</a></h4>
<p><strong>負の二項分布</strong> (negative binomial distribution) は幾何分布を一般化されたものであり, <span class="math notranslate nohighlight">\(n\)</span> 回目の成功を得るまでの失敗の回数を <span class="math notranslate nohighlight">\(x\)</span> とした時の確率分布である.</p>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p><u>確率密度関数</u></p>
<p><span class="math notranslate nohighlight">\(x = 0, 1, \cdots\)</span> とする.</p>
<div class="math notranslate nohighlight">
\[
    f(x) = {}_{n+x-1}{\rm C}_{x} p^n q^x
\]</div>
</div>
<p>ここで確率分布の性質である <a class="reference external" href="#math-1.5">(1.5)</a>, <a class="reference external" href="#math-1.6">(1.6)</a> を確認する.</p>
<p><u>数式 (1.5) の確認</u><br />
　確率密度関数の定義から <span class="math notranslate nohighlight">\(f(x) \geq 0\)</span> であることは自明.</p>
<p><u>数式 (1.6) の確認</u></p>
<p>XXXXXX</p>
<div class="math notranslate nohighlight">
\[
    \sum_{x=0}^{\infty}{{}_{n+x-1}{\rm C}_{x}p^n q^x} = 1
\]</div>
<p>XXXXX</p>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p><u>期待値と分散</u></p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        &amp; {\rm E}(X) = \frac{nq}{p} \\
        &amp; {\rm Var}(X) = \frac{nq}{p^2}
    \end{align}
\end{split}\]</div>
</div>
<p><u>証明</u><br />
　期待値については, 式 <a class="reference external" href="#math-1.15">(1.15)</a> より</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm E}(X) &amp;= \sum_{x=0}^{\infty}{x {}_{ n+x-1 }{\rm C}_{ x } p^n q^x } \\
                   &amp;= \sum_{x=1}^{\infty}{x \frac{ (n+x-1)! }{ (n-1)! x! } p^n q^x } \\
                   &amp;= \sum_{x=1}^{\infty}{ \frac{ (n+x-1)! }{ (n-1)! (x-1)! } p^n q^x }
    \end{align}
\end{split}\]</div>
<p>と求められる. また分散については <a class="reference external" href="#math-1.20">(1.20)</a> より</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm Var}(X) &amp;= {\rm}E(X^2) - ({\rm E}(X))^2 \\
                     &amp;= {\rm}E(X(X-1)+X) - ({\rm E}(X))^2 \\
                     &amp;= {\rm}E(X(X-1)) + {\rm}E(X) - ({\rm E}(X))^2
    \end{align}
\end{split}\]</div>
<p><u>python での擬似乱数生成</u></p>
<p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.nbinom.html#scipy.stats.nbinom"><code class="docutils literal notranslate"><span class="pre">scipy.stats.nbinom</span></code></a> を用いて生成する.</p>
<p><u>ユースケース</u></p>
<ul class="simple">
<li><p>購入頻度が負の二項分布に従う (<a class="reference external" href="https://qiita.com/nijigen_plot/items/9570487b73ad01fff36b">購買回数の分布と負の二項分布の関係</a>).</p></li>
</ul>
</section>
<section id="u-1-5-8-u">
<h4><u>例 1.5.8 (パレート分布)</u><a class="headerlink" href="#u-1-5-8-u" title="Permalink to this headline">#</a></h4>
<p><strong>負の二項分布</strong> (negative binomial distribution) は幾何分布を一般化されたものであり, <span class="math notranslate nohighlight">\(n\)</span> 回目の成功を得るまでの失敗の回数を <span class="math notranslate nohighlight">\(x\)</span> とした時の確率分布である.</p>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p><u>確率密度関数</u></p>
<p><span class="math notranslate nohighlight">\(x = 0, 1, \cdots\)</span> とする.</p>
<div class="math notranslate nohighlight">
\[
    f(x) = {}_{n+x-1}{\rm C}_{x} p^n q^x
\]</div>
</div>
<p>ここで確率分布の性質である <a class="reference external" href="#math-1.5">(1.5)</a>, <a class="reference external" href="#math-1.6">(1.6)</a> を確認する.</p>
<p><u>数式 (1.5) の確認</u><br />
　確率密度関数の定義から <span class="math notranslate nohighlight">\(f(x) \geq 0\)</span> であることは自明.</p>
<p><u>数式 (1.6) の確認</u></p>
<p>XXXXXX</p>
<div class="math notranslate nohighlight">
\[
    \sum_{x=0}^{\infty}{{}_{n+x-1}{\rm C}_{x}p^n q^x} = 1
\]</div>
<p>XXXXX</p>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p><u>期待値と分散</u></p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        &amp; {\rm E}(X) = \frac{nq}{p} \\
        &amp; {\rm Var}(X) = \frac{nq}{p^2}
    \end{align}
\end{split}\]</div>
</div>
<p><u>証明</u><br />
　期待値については, 式 <a class="reference external" href="#math-1.15">(1.15)</a> より</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm E}(X) &amp;= \sum_{x=0}^{\infty}{x {}_{ n+x-1 }{\rm C}_{ x } p^n q^x } \\
                   &amp;= \sum_{x=1}^{\infty}{x \frac{ (n+x-1)! }{ (n-1)! x! } p^n q^x } \\
                   &amp;= \sum_{x=1}^{\infty}{ \frac{ (n+x-1)! }{ (n-1)! (x-1)! } p^n q^x }
    \end{align}
\end{split}\]</div>
<p>と求められる. また分散については <a class="reference external" href="#math-1.20">(1.20)</a> より</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm Var}(X) &amp;= {\rm}E(X^2) - ({\rm E}(X))^2 \\
                     &amp;= {\rm}E(X(X-1)+X) - ({\rm E}(X))^2 \\
                     &amp;= {\rm}E(X(X-1)) + {\rm}E(X) - ({\rm E}(X))^2
    \end{align}
\end{split}\]</div>
<p><u>python での擬似乱数生成</u></p>
<p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.nbinom.html#scipy.stats.nbinom"><code class="docutils literal notranslate"><span class="pre">scipy.stats.nbinom</span></code></a> を用いて生成する.</p>
<p><u>ユースケース</u></p>
<ul class="simple">
<li><p>購入頻度が負の二項分布に従う (<a class="reference external" href="https://qiita.com/nijigen_plot/items/9570487b73ad01fff36b">購買回数の分布と負の二項分布の関係</a>).</p></li>
</ul>
</section>
<section id="u-1-5-9-u">
<h4><u>例 1.5.9 (ワイブル分布)</u><a class="headerlink" href="#u-1-5-9-u" title="Permalink to this headline">#</a></h4>
<p><strong>負の二項分布</strong> (negative binomial distribution) は幾何分布を一般化されたものであり, <span class="math notranslate nohighlight">\(n\)</span> 回目の成功を得るまでの失敗の回数を <span class="math notranslate nohighlight">\(x\)</span> とした時の確率分布である.</p>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p><u>確率密度関数</u></p>
<p><span class="math notranslate nohighlight">\(x = 0, 1, \cdots\)</span> とする.</p>
<div class="math notranslate nohighlight">
\[
    f(x) = {}_{n+x-1}{\rm C}_{x} p^n q^x
\]</div>
</div>
<p>ここで確率分布の性質である <a class="reference external" href="#math-1.5">(1.5)</a>, <a class="reference external" href="#math-1.6">(1.6)</a> を確認する.</p>
<p><u>数式 (1.5) の確認</u><br />
　確率密度関数の定義から <span class="math notranslate nohighlight">\(f(x) \geq 0\)</span> であることは自明.</p>
<p><u>数式 (1.6) の確認</u></p>
<p>XXXXXX</p>
<div class="math notranslate nohighlight">
\[
    \sum_{x=0}^{\infty}{{}_{n+x-1}{\rm C}_{x}p^n q^x} = 1
\]</div>
<p>XXXXX</p>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p><u>期待値と分散</u></p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        &amp; {\rm E}(X) = \frac{nq}{p} \\
        &amp; {\rm Var}(X) = \frac{nq}{p^2}
    \end{align}
\end{split}\]</div>
</div>
<p><u>証明</u><br />
　期待値については, 式 <a class="reference external" href="#math-1.15">(1.15)</a> より</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm E}(X) &amp;= \sum_{x=0}^{\infty}{x {}_{ n+x-1 }{\rm C}_{ x } p^n q^x } \\
                   &amp;= \sum_{x=1}^{\infty}{x \frac{ (n+x-1)! }{ (n-1)! x! } p^n q^x } \\
                   &amp;= \sum_{x=1}^{\infty}{ \frac{ (n+x-1)! }{ (n-1)! (x-1)! } p^n q^x }
    \end{align}
\end{split}\]</div>
<p>と求められる. また分散については <a class="reference external" href="#math-1.20">(1.20)</a> より</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm Var}(X) &amp;= {\rm}E(X^2) - ({\rm E}(X))^2 \\
                     &amp;= {\rm}E(X(X-1)+X) - ({\rm E}(X))^2 \\
                     &amp;= {\rm}E(X(X-1)) + {\rm}E(X) - ({\rm E}(X))^2
    \end{align}
\end{split}\]</div>
<p><u>python での擬似乱数生成</u></p>
<p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.nbinom.html#scipy.stats.nbinom"><code class="docutils literal notranslate"><span class="pre">scipy.stats.nbinom</span></code></a> を用いて生成する.</p>
<p><u>ユースケース</u></p>
<ul class="simple">
<li><p>購入頻度が負の二項分布に従う (<a class="reference external" href="https://qiita.com/nijigen_plot/items/9570487b73ad01fff36b">購買回数の分布と負の二項分布の関係</a>).</p></li>
</ul>
<p><a id="2"></a></p>
</section>
</section>
</section>
<section id="id8">
<h2>2. 多次元確率分布<a class="headerlink" href="#id8" title="Permalink to this headline">#</a></h2>
<p>XXXX</p>
<p><a id="2.1"></a></p>
<section id="id9">
<h3>2.1. 期待値と分散<a class="headerlink" href="#id9" title="Permalink to this headline">#</a></h3>
<p>XXXX</p>
<p><a id="2.2"></a></p>
</section>
<section id="id10">
<h3>2.2. 周辺分布と条件付き分布<a class="headerlink" href="#id10" title="Permalink to this headline">#</a></h3>
<p>XXXX</p>
<p><a id="2.3"></a></p>
</section>
<section id="id11">
<h3>2.3. 多変量正規分布<a class="headerlink" href="#id11" title="Permalink to this headline">#</a></h3>
<p>XXXX</p>
<p><a id="3"></a></p>
</section>
</section>
<section id="id12">
<h2>3. 時系列データ<a class="headerlink" href="#id12" title="Permalink to this headline">#</a></h2>
<p>XXXX</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./analytics"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="../intro.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Welcome to my Analytics Sandbox</p>
        </div>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By The Jupyter Book Community<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>