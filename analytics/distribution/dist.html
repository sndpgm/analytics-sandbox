
<!DOCTYPE html>

<html>
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/><meta content="Docutils 0.17.1: http://docutils.sourceforge.net/" name="generator"/>
<title>確率分布 — Analytics Study Blog</title>
<!-- Loaded before other Sphinx assets -->
<link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet"/>
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet"/>
<link href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css" rel="stylesheet"/>
<link as="font" crossorigin="" href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2" rel="preload" type="font/woff2"/>
<link href="../../_static/pygments.css" rel="stylesheet" type="text/css">
<link href="../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" rel="stylesheet" type="text/css">
<link href="../../_static/togglebutton.css" rel="stylesheet" type="text/css">
<link href="../../_static/copybutton.css" rel="stylesheet" type="text/css">
<link href="../../_static/mystnb.css" rel="stylesheet" type="text/css">
<link href="../../_static/sphinx-thebe.css" rel="stylesheet" type="text/css"/>
<link href="../../_static/graphviz.css" rel="stylesheet" type="text/css"/>
<link href="../../_static/sphinx-codeautolink.css" rel="stylesheet" type="text/css"/>
<link href="../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" rel="stylesheet" type="text/css"/>
<!-- Pre-loaded scripts that we'll load fully later -->
<link as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf" rel="preload"/>
<script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
<script src="../../_static/jquery.js"></script>
<script src="../../_static/underscore.js"></script>
<script src="../../_static/doctools.js"></script>
<script src="../../_static/clipboard.min.js"></script>
<script src="../../_static/copybutton.js"></script>
<script src="../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
<script>let toggleHintShow = 'Click to show';</script>
<script>let toggleHintHide = 'Click to hide';</script>
<script>let toggleOpenOnPrint = 'true';</script>
<script src="../../_static/togglebutton.js"></script>
<script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
<script src="../../_static/design-tabs.js"></script>
<script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
<script async="async" src="../../_static/sphinx-thebe.js"></script>
<script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
<script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<link href="../../genindex.html" rel="index" title="Index">
<link href="../../search.html" rel="search" title="Search"/>
<link href="mdist.html" rel="next" title="多変量確率分布"/>
<link href="rvs.html" rel="prev" title="確率変数"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="None" name="docsearch:language"/>
<!-- Google Analytics -->
</link></link></link></link></link></link></head>
<body data-offset="60" data-spy="scroll" data-target="#bd-toc-nav">
<!-- Checkboxes to toggle the left sidebar -->
<input aria-label="Toggle navigation sidebar" class="sidebar-toggle" id="__navigation" name="__navigation" type="checkbox"/>
<label class="overlay overlay-navbar" for="__navigation">
<div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input aria-label="Toggle in-page Table of Contents" class="sidebar-toggle" id="__page-toc" name="__page-toc" type="checkbox"/>
<label class="overlay overlay-pagetoc" for="__page-toc">
<div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>
<div class="container-fluid" id="banner"></div>
<div class="container-xl">
<div class="row">
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
<div class="bd-sidebar__content">
<div class="bd-sidebar__top"><div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../index.html">
<!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
<img alt="logo" class="logo" src="../../_static/logo.png"/>
<h1 class="site-logo" id="site-title">Analytics Study Blog</h1>
</a>
</div><form action="../../search.html" class="bd-search d-flex align-items-center" method="get">
<i class="icon fas fa-search"></i>
<input aria-label="Search this book..." autocomplete="off" class="form-control" id="search-input" name="q" placeholder="Search this book..." type="search"/>
</form><nav aria-label="Main" class="bd-links" id="bd-docs-nav">
<div class="bd-toc-item active">
<ul class="nav bd-sidenav bd-sidenav__home-link">
<li class="toctree-l1">
<a class="reference internal" href="../../intro.html">
                    Welcome to my Analytics Sandbox
                </a>
</li>
</ul>
<p aria-level="2" class="caption" role="heading">
<span class="caption-text">
  確率変数と確率分布
 </span>
</p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1">
<a class="reference internal" href="rvs.html">
   確率変数
  </a>
</li>
<li class="toctree-l1 current active">
<a class="current reference internal" href="#">
   確率分布
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="mdist.html">
   多変量確率分布
  </a>
</li>
</ul>
<p aria-level="2" class="caption" role="heading">
<span class="caption-text">
  回帰モデル
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1">
<a class="reference internal" href="../regression/blm.html">
   ベイズ線形回帰モデル
  </a>
</li>
</ul>
<p aria-level="2" class="caption" role="heading">
<span class="caption-text">
  時系列モデル
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1">
<a class="reference internal" href="../tsa/ts.html">
   時系列データ
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../tsa/arma.html">
   ARMAモデル系
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../tsa/arima.html">
   ARIMAモデル系
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../tsa/ssm.html">
   状態空間モデル
  </a>
</li>
</ul>
<p aria-level="2" class="caption" role="heading">
<span class="caption-text">
  補足
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1">
<a class="reference internal" href="../math/calculus.html">
   微分積分学
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../math/linear_algebra.html">
   線形代数学
  </a>
</li>
</ul>
<p aria-level="2" class="caption" role="heading">
<span class="caption-text">
  API Documentation
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../api/sandbox/index.html">
<code class="xref py py-mod docutils literal notranslate">
<span class="pre">
     sandbox
    </span>
</code>
</a>
<input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox">
<label for="toctree-checkbox-1">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2 has-children">
<a class="reference internal" href="../../api/sandbox/datamodel/index.html">
<code class="xref py py-mod docutils literal notranslate">
<span class="pre">
       sandbox.datamodel
      </span>
</code>
</a>
<input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox">
<label for="toctree-checkbox-2">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l3">
<a class="reference internal" href="../../api/sandbox/datamodel/base/index.html">
<code class="xref py py-mod docutils literal notranslate">
<span class="pre">
         sandbox.datamodel.base
        </span>
</code>
</a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../api/sandbox/datamodel/ts_datamodel/index.html">
<code class="xref py py-mod docutils literal notranslate">
<span class="pre">
         sandbox.datamodel.ts_datamodel
        </span>
</code>
</a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../api/sandbox/datamodel/ts_simulator/index.html">
<code class="xref py py-mod docutils literal notranslate">
<span class="pre">
         sandbox.datamodel.ts_simulator
        </span>
</code>
</a>
</li>
</ul>
</input></li>
<li class="toctree-l2 has-children">
<a class="reference internal" href="../../api/sandbox/datasets/index.html">
<code class="xref py py-mod docutils literal notranslate">
<span class="pre">
       sandbox.datasets
      </span>
</code>
</a>
<input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox">
<label for="toctree-checkbox-3">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l3 has-children">
<a class="reference internal" href="../../api/sandbox/datasets/air_passengers/index.html">
<code class="xref py py-mod docutils literal notranslate">
<span class="pre">
         sandbox.datasets.air_passengers
        </span>
</code>
</a>
<input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
<label for="toctree-checkbox-4">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l4">
<a class="reference internal" href="../../api/sandbox/datasets/air_passengers/data/index.html">
<code class="xref py py-mod docutils literal notranslate">
<span class="pre">
           sandbox.datasets.air_passengers.data
          </span>
</code>
</a>
</li>
</ul>
</li>
<li class="toctree-l3 has-children">
<a class="reference internal" href="../../api/sandbox/datasets/blsallfood/index.html">
<code class="xref py py-mod docutils literal notranslate">
<span class="pre">
         sandbox.datasets.blsallfood
        </span>
</code>
</a>
<input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
<label for="toctree-checkbox-5">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l4">
<a class="reference internal" href="../../api/sandbox/datasets/blsallfood/data/index.html">
<code class="xref py py-mod docutils literal notranslate">
<span class="pre">
           sandbox.datasets.blsallfood.data
          </span>
</code>
</a>
</li>
</ul>
</li>
<li class="toctree-l3 has-children">
<a class="reference internal" href="../../api/sandbox/datasets/hakusan/index.html">
<code class="xref py py-mod docutils literal notranslate">
<span class="pre">
         sandbox.datasets.hakusan
        </span>
</code>
</a>
<input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
<label for="toctree-checkbox-6">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l4">
<a class="reference internal" href="../../api/sandbox/datasets/hakusan/data/index.html">
<code class="xref py py-mod docutils literal notranslate">
<span class="pre">
           sandbox.datasets.hakusan.data
          </span>
</code>
</a>
</li>
</ul>
</li>
<li class="toctree-l3 has-children">
<a class="reference internal" href="../../api/sandbox/datasets/maxtemp/index.html">
<code class="xref py py-mod docutils literal notranslate">
<span class="pre">
         sandbox.datasets.maxtemp
        </span>
</code>
</a>
<input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
<label for="toctree-checkbox-7">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l4">
<a class="reference internal" href="../../api/sandbox/datasets/maxtemp/data/index.html">
<code class="xref py py-mod docutils literal notranslate">
<span class="pre">
           sandbox.datasets.maxtemp.data
          </span>
</code>
</a>
</li>
</ul>
</li>
<li class="toctree-l3 has-children">
<a class="reference internal" href="../../api/sandbox/datasets/mye1f/index.html">
<code class="xref py py-mod docutils literal notranslate">
<span class="pre">
         sandbox.datasets.mye1f
        </span>
</code>
</a>
<input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
<label for="toctree-checkbox-8">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l4">
<a class="reference internal" href="../../api/sandbox/datasets/mye1f/data/index.html">
<code class="xref py py-mod docutils literal notranslate">
<span class="pre">
           sandbox.datasets.mye1f.data
          </span>
</code>
</a>
</li>
</ul>
</li>
<li class="toctree-l3 has-children">
<a class="reference internal" href="../../api/sandbox/datasets/nikkei225/index.html">
<code class="xref py py-mod docutils literal notranslate">
<span class="pre">
         sandbox.datasets.nikkei225
        </span>
</code>
</a>
<input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
<label for="toctree-checkbox-9">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l4">
<a class="reference internal" href="../../api/sandbox/datasets/nikkei225/data/index.html">
<code class="xref py py-mod docutils literal notranslate">
<span class="pre">
           sandbox.datasets.nikkei225.data
          </span>
</code>
</a>
</li>
</ul>
</li>
<li class="toctree-l3 has-children">
<a class="reference internal" href="../../api/sandbox/datasets/rtf/index.html">
<code class="xref py py-mod docutils literal notranslate">
<span class="pre">
         sandbox.datasets.rtf
        </span>
</code>
</a>
<input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
<label for="toctree-checkbox-10">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l4">
<a class="reference internal" href="../../api/sandbox/datasets/rtf/data/index.html">
<code class="xref py py-mod docutils literal notranslate">
<span class="pre">
           sandbox.datasets.rtf.data
          </span>
</code>
</a>
</li>
</ul>
</li>
<li class="toctree-l3 has-children">
<a class="reference internal" href="../../api/sandbox/datasets/whard/index.html">
<code class="xref py py-mod docutils literal notranslate">
<span class="pre">
         sandbox.datasets.whard
        </span>
</code>
</a>
<input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
<label for="toctree-checkbox-11">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l4">
<a class="reference internal" href="../../api/sandbox/datasets/whard/data/index.html">
<code class="xref py py-mod docutils literal notranslate">
<span class="pre">
           sandbox.datasets.whard.data
          </span>
</code>
</a>
</li>
</ul>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../api/sandbox/datasets/utils/index.html">
<code class="xref py py-mod docutils literal notranslate">
<span class="pre">
         sandbox.datasets.utils
        </span>
</code>
</a>
</li>
</ul>
</input></li>
<li class="toctree-l2 has-children">
<a class="reference internal" href="../../api/sandbox/ensemble/index.html">
<code class="xref py py-mod docutils literal notranslate">
<span class="pre">
       sandbox.ensemble
      </span>
</code>
</a>
<input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
<label for="toctree-checkbox-12">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l3">
<a class="reference internal" href="../../api/sandbox/ensemble/base/index.html">
<code class="xref py py-mod docutils literal notranslate">
<span class="pre">
         sandbox.ensemble.base
        </span>
</code>
</a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../api/sandbox/ensemble/boost/index.html">
<code class="xref py py-mod docutils literal notranslate">
<span class="pre">
         sandbox.ensemble.boost
        </span>
</code>
</a>
</li>
</ul>
</li>
<li class="toctree-l2 has-children">
<a class="reference internal" href="../../api/sandbox/features/index.html">
<code class="xref py py-mod docutils literal notranslate">
<span class="pre">
       sandbox.features
      </span>
</code>
</a>
<input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
<label for="toctree-checkbox-13">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l3">
<a class="reference internal" href="../../api/sandbox/features/features/index.html">
<code class="xref py py-mod docutils literal notranslate">
<span class="pre">
         sandbox.features.features
        </span>
</code>
</a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../api/sandbox/features/ts_calculator/index.html">
<code class="xref py py-mod docutils literal notranslate">
<span class="pre">
         sandbox.features.ts_calculator
        </span>
</code>
</a>
</li>
</ul>
</li>
<li class="toctree-l2 has-children">
<a class="reference internal" href="../../api/sandbox/graphics/index.html">
<code class="xref py py-mod docutils literal notranslate">
<span class="pre">
       sandbox.graphics
      </span>
</code>
</a>
<input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
<label for="toctree-checkbox-14">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l3">
<a class="reference internal" href="../../api/sandbox/graphics/ts_grapher/index.html">
<code class="xref py py-mod docutils literal notranslate">
<span class="pre">
         sandbox.graphics.ts_grapher
        </span>
</code>
</a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../api/sandbox/graphics/utils/index.html">
<code class="xref py py-mod docutils literal notranslate">
<span class="pre">
         sandbox.graphics.utils
        </span>
</code>
</a>
</li>
</ul>
</li>
<li class="toctree-l2 has-children">
<a class="reference internal" href="../../api/sandbox/metrics/index.html">
<code class="xref py py-mod docutils literal notranslate">
<span class="pre">
       sandbox.metrics
      </span>
</code>
</a>
<input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
<label for="toctree-checkbox-15">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l3">
<a class="reference internal" href="../../api/sandbox/metrics/score/index.html">
<code class="xref py py-mod docutils literal notranslate">
<span class="pre">
         sandbox.metrics.score
        </span>
</code>
</a>
</li>
</ul>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../api/sandbox/model_selection/index.html">
<code class="xref py py-mod docutils literal notranslate">
<span class="pre">
       sandbox.model_selection
      </span>
</code>
</a>
</li>
<li class="toctree-l2 has-children">
<a class="reference internal" href="../../api/sandbox/tsa/index.html">
<code class="xref py py-mod docutils literal notranslate">
<span class="pre">
       sandbox.tsa
      </span>
</code>
</a>
<input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/>
<label for="toctree-checkbox-16">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l3">
<a class="reference internal" href="../../api/sandbox/tsa/base/index.html">
<code class="xref py py-mod docutils literal notranslate">
<span class="pre">
         sandbox.tsa.base
        </span>
</code>
</a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../api/sandbox/tsa/sarimax/index.html">
<code class="xref py py-mod docutils literal notranslate">
<span class="pre">
         sandbox.tsa.sarimax
        </span>
</code>
</a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../api/sandbox/tsa/ssm/index.html">
<code class="xref py py-mod docutils literal notranslate">
<span class="pre">
         sandbox.tsa.ssm
        </span>
</code>
</a>
</li>
</ul>
</li>
<li class="toctree-l2 has-children">
<a class="reference internal" href="../../api/sandbox/utils/index.html">
<code class="xref py py-mod docutils literal notranslate">
<span class="pre">
       sandbox.utils
      </span>
</code>
</a>
<input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/>
<label for="toctree-checkbox-17">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l3">
<a class="reference internal" href="../../api/sandbox/utils/tools/index.html">
<code class="xref py py-mod docutils literal notranslate">
<span class="pre">
         sandbox.utils.tools
        </span>
</code>
</a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../api/sandbox/utils/validation/index.html">
<code class="xref py py-mod docutils literal notranslate">
<span class="pre">
         sandbox.utils.validation
        </span>
</code>
</a>
</li>
</ul>
</li>
</ul>
</input></li>
</ul>
</div>
</nav></div>
<div class="bd-sidebar__bottom">
<!-- To handle the deprecated key -->
<div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>
</div>
</div>
<div id="rtd-footer-container"></div>
</div>
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
<div class="header-article row sticky-top noprint">
<div class="col py-1 d-flex header-article-main">
<div class="header-article__left">
<label class="headerbtn" data-placement="right" data-toggle="tooltip" for="__navigation" title="Toggle navigation">
<span class="headerbtn__icon-container">
<i class="fas fa-bars"></i>
</span>
</label>
</div>
<div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
<button aria-label="Launch interactive content" class="headerbtn menu-dropdown__trigger">
<i class="fas fa-rocket"></i>
</button>
<div class="menu-dropdown__content">
<ul>
<li>
<a class="headerbtn" data-placement="left" data-toggle="tooltip" href="https://mybinder.org/v2/gh/sndpgm/analytics-sandbox/main?urlpath=lab/tree/docs/analytics/distribution/dist.ipynb" title="Launch on Binder">
<span class="headerbtn__icon-container">
<img src="../../_static/images/logo_binder.svg"/>
</span>
<span class="headerbtn__text-container">Binder</span>
</a>
</li>
<li>
<a class="headerbtn" data-placement="left" data-toggle="tooltip" href="https://colab.research.google.com/github/sndpgm/analytics-sandbox/blob/main/docs/analytics/distribution/dist.ipynb" title="Launch on Colab">
<span class="headerbtn__icon-container">
<img src="../../_static/images/logo_colab.png"/>
</span>
<span class="headerbtn__text-container">Colab</span>
</a>
</li>
</ul>
</div>
</div>
<button class="headerbtn" data-placement="bottom" data-toggle="tooltip" onclick="toggleFullScreen()" title="Fullscreen mode">
<span class="headerbtn__icon-container">
<i class="fas fa-expand"></i>
</span>
</button>
<div class="menu-dropdown menu-dropdown-repository-buttons">
<button aria-label="Source repositories" class="headerbtn menu-dropdown__trigger">
<i class="fab fa-github"></i>
</button>
<div class="menu-dropdown__content">
<ul>
<li>
<a class="headerbtn" data-placement="left" data-toggle="tooltip" href="https://github.com/sndpgm/analytics-sandbox" title="Source repository">
<span class="headerbtn__icon-container">
<i class="fab fa-github"></i>
</span>
<span class="headerbtn__text-container">repository</span>
</a>
</li>
<li>
<a class="headerbtn" data-placement="left" data-toggle="tooltip" href="https://github.com/sndpgm/analytics-sandbox/issues/new?title=Issue%20on%20page%20%2Fanalytics/distribution/dist.html&amp;body=Your%20issue%20content%20here." title="Open an issue">
<span class="headerbtn__icon-container">
<i class="fas fa-lightbulb"></i>
</span>
<span class="headerbtn__text-container">open issue</span>
</a>
</li>
<li>
<a class="headerbtn" data-placement="left" data-toggle="tooltip" href="https://github.com/sndpgm/analytics-sandbox/edit/main/docs/analytics/distribution/dist.ipynb" title="Edit this page">
<span class="headerbtn__icon-container">
<i class="fas fa-pencil-alt"></i>
</span>
<span class="headerbtn__text-container">suggest edit</span>
</a>
</li>
</ul>
</div>
</div>
<div class="menu-dropdown menu-dropdown-download-buttons">
<button aria-label="Download this page" class="headerbtn menu-dropdown__trigger">
<i class="fas fa-download"></i>
</button>
<div class="menu-dropdown__content">
<ul>
<li>
<a class="headerbtn" data-placement="left" data-toggle="tooltip" href="../../_sources/analytics/distribution/dist.ipynb" title="Download source file">
<span class="headerbtn__icon-container">
<i class="fas fa-file"></i>
</span>
<span class="headerbtn__text-container">.ipynb</span>
</a>
</li>
<li>
<button class="headerbtn" data-placement="left" data-toggle="tooltip" onclick="printPdf(this)" title="Print to PDF">
<span class="headerbtn__icon-container">
<i class="fas fa-file-pdf"></i>
</span>
<span class="headerbtn__text-container">.pdf</span>
</button>
</li>
</ul>
</div>
</div>
<label class="headerbtn headerbtn-page-toc" for="__page-toc">
<span class="headerbtn__icon-container">
<i class="fas fa-list"></i>
</span>
</label>
</div>
</div>
<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
<div class="tocsection onthispage pt-5 pb-3">
<i class="fas fa-list"></i> Contents
    </div>
<nav aria-label="Page" id="bd-toc-nav">
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#python">
   1. 確率分布を生成するPythonモジュール
  </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#scipy">
     1.1. SciPy
    </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#numpy">
     1.2. NumPy
    </a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#id2">
   2. 離散型の確率分布
  </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id3">
     例 2.1 (ベルヌーイ分布)
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id4">
       確率質量関数
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id5">
       期待値と分散
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#python-example-bernoulli">
       Python での確認
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id7">
       ユースケース
      </a>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id8">
     例 2.2 (二項分布)
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id9">
       確率質量関数
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id10">
       期待値と分散
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#python-example-binomial">
       Python での確認
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id12">
       ユースケース
      </a>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id13">
     例 2.3 (ポアソン分布)
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id14">
       確率質量関数
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id15">
       期待値と分散
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#python-example-poisson">
       Python での確認
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id17">
       ユースケース
      </a>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id18">
     例 2.4 (幾何分布)
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id19">
       確率質量関数
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id20">
       期待値と分散
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#python-example-geometric">
       Python での確認
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id22">
       ユースケース
      </a>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id23">
     例 2.5 (負の二項分布)
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id24">
       確率質量関数
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id25">
       期待値と分散
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#python-example-nbinom">
       Python での確認
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id27">
       ユースケース
      </a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#id28">
   3. 連続型の確率分布
  </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id29">
     例 3.1 (一様分布)
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id30">
       確率密度関数
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id31">
       期待値と分散
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#python-example-uniform">
       Python での確認
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id33">
       ユースケース
      </a>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#normal-distribution">
     例 3.2 (正規分布)
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id35">
       確率密度関数
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id36">
       命題 3.2.1 (ガウス積分)
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id37">
       期待値と分散
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#python-example-normal">
       Python での確認
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id39">
       ユースケース
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id40">
       定理 3.2.2 (中心極限定理)
      </a>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id41">
     例 3.3 (対数正規分布)
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id42">
       確率密度関数
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id43">
       期待値と分散
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#python-example-lognormal">
       Python での確認
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id45">
       ユースケース
      </a>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id46">
     例 3.4 (指数分布)
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id47">
       確率密度関数
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id48">
       期待値と分散
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#python-example-exponential">
       Python での確認
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id50">
       ユースケース
      </a>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id51">
     例 3.5 (ガンマ分布)
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id52">
       確率密度関数
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id53">
       期待値と分散
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id54">
       命題 3.5.1 (ガンマ関数の性質)
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#python-example-gamma">
       Python での確認
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id56">
       ユースケース
      </a>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id57">
     例 3.6 (ベータ分布)
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id58">
       確率密度関数
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id59">
       期待値と分散
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id60">
       命題 3.6.1 (ベータ関数の性質)
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#python-example-beta">
       Python での確認
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id62">
       ユースケース
      </a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</div>
</div>
<div class="article row">
<div class="col pl-md-3 pl-lg-5 content-container">
<!-- Table of contents that is only displayed when printing the page -->
<div class="onlyprint" id="jb-print-docs-body">
<h1>確率分布</h1>
<!-- Table of contents -->
<div id="print-main-content">
<div id="jb-print-toc">
<div>
<h2> Contents </h2>
</div>
<nav aria-label="Page">
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#python">
   1. 確率分布を生成するPythonモジュール
  </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#scipy">
     1.1. SciPy
    </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#numpy">
     1.2. NumPy
    </a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#id2">
   2. 離散型の確率分布
  </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id3">
     例 2.1 (ベルヌーイ分布)
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id4">
       確率質量関数
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id5">
       期待値と分散
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#python-example-bernoulli">
       Python での確認
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id7">
       ユースケース
      </a>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id8">
     例 2.2 (二項分布)
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id9">
       確率質量関数
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id10">
       期待値と分散
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#python-example-binomial">
       Python での確認
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id12">
       ユースケース
      </a>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id13">
     例 2.3 (ポアソン分布)
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id14">
       確率質量関数
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id15">
       期待値と分散
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#python-example-poisson">
       Python での確認
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id17">
       ユースケース
      </a>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id18">
     例 2.4 (幾何分布)
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id19">
       確率質量関数
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id20">
       期待値と分散
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#python-example-geometric">
       Python での確認
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id22">
       ユースケース
      </a>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id23">
     例 2.5 (負の二項分布)
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id24">
       確率質量関数
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id25">
       期待値と分散
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#python-example-nbinom">
       Python での確認
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id27">
       ユースケース
      </a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#id28">
   3. 連続型の確率分布
  </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id29">
     例 3.1 (一様分布)
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id30">
       確率密度関数
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id31">
       期待値と分散
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#python-example-uniform">
       Python での確認
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id33">
       ユースケース
      </a>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#normal-distribution">
     例 3.2 (正規分布)
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id35">
       確率密度関数
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id36">
       命題 3.2.1 (ガウス積分)
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id37">
       期待値と分散
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#python-example-normal">
       Python での確認
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id39">
       ユースケース
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id40">
       定理 3.2.2 (中心極限定理)
      </a>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id41">
     例 3.3 (対数正規分布)
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id42">
       確率密度関数
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id43">
       期待値と分散
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#python-example-lognormal">
       Python での確認
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id45">
       ユースケース
      </a>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id46">
     例 3.4 (指数分布)
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id47">
       確率密度関数
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id48">
       期待値と分散
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#python-example-exponential">
       Python での確認
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id50">
       ユースケース
      </a>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id51">
     例 3.5 (ガンマ分布)
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id52">
       確率密度関数
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id53">
       期待値と分散
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id54">
       命題 3.5.1 (ガンマ関数の性質)
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#python-example-gamma">
       Python での確認
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id56">
       ユースケース
      </a>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id57">
     例 3.6 (ベータ分布)
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id58">
       確率密度関数
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id59">
       期待値と分散
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id60">
       命題 3.6.1 (ベータ関数の性質)
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#python-example-beta">
       Python での確認
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id62">
       ユースケース
      </a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</div>
</div>
</div>
<main id="main-content" role="main">
<div>
<section class="tex2jax_ignore mathjax_ignore" id="id1">
<h1>確率分布<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h1>
<section id="python">
<h2>1. 確率分布を生成するPythonモジュール<a class="headerlink" href="#python" title="Permalink to this headline">#</a></h2>
<p>具体的な確率分布を確認する前に, Python にある確率分布生成に有効なモジュールについて説明.</p>
<section id="scipy">
<h3>1.1. SciPy<a class="headerlink" href="#scipy" title="Permalink to this headline">#</a></h3>
<p>高水準の科学計算を提供するモジュールである <a class="reference external" href="https://scipy.org">SciPy</a> を用いて様々な確率分布の乱数生成, 確率分布関数を取得することができる.</p>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/stats.html">関係モジュールドキュメント (<code class="docutils literal notranslate"><span class="pre">scipy.stats</span></code>)</a></p></li>
</ul>
<p><u>基本的な使い方</u><br/>
　モジュール構成として <code class="docutils literal notranslate"><span class="pre">scipy.stats.{確率分布名}</span></code> という形式で各確率分布のクラスが存在する.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># 二項分布の場合</span>
<span class="kn">from</span> <a class="sphinx-codeautolink-a" href="https://docs.scipy.org/doc/scipy/reference/stats.html#module-scipy.stats" title="scipy.stats"><span class="nn">scipy.stats</span></a> <span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.binom.html#scipy.stats.binom" title="scipy.stats.binom"><span class="n">binom</span></a>

<span class="c1"># 正規分布の場合</span>
<span class="kn">from</span> <a class="sphinx-codeautolink-a" href="https://docs.scipy.org/doc/scipy/reference/stats.html#module-scipy.stats" title="scipy.stats"><span class="nn">scipy.stats</span></a> <span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.norm.html#scipy.stats.norm" title="scipy.stats.norm"><span class="n">norm</span></a>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">import</span></code> した確率分布のクラスを用いて以下メソッドを利用することができる. 以下の <code class="docutils literal notranslate"><span class="pre">**param_kwargs</span></code> は確率分布ごとに変わりうるパラメータである. 例えば, <code class="docutils literal notranslate"><span class="pre">scipy.stats.norm</span></code> の場合は <code class="docutils literal notranslate"><span class="pre">loc</span></code>, <code class="docutils literal notranslate"><span class="pre">scale</span></code> が該当する.</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Class method</p></th>
<th class="head"><p></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">rvs(**param_kwargs,</span> <span class="pre">size=1,</span> <span class="pre">random_state=None)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">size</span></code> の数だけ分布に従った擬似乱数を生成.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">pdf(x,</span> <span class="pre">**param_kwargs)</span></code></p></td>
<td><p>(連続型の確率分布のみ存在) 確率密度関数の値 <span class="math notranslate nohighlight">\(f(x)\)</span>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">pmf(x,</span> <span class="pre">**param_kwargs)</span></code></p></td>
<td><p>(離散型の確率分布のみ存在) 確率質量関数の値 <span class="math notranslate nohighlight">\(f(x)\)</span>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">cdf(x,</span> <span class="pre">**param_kwargs)</span></code></p></td>
<td><p>累積確率分布の値 <span class="math notranslate nohighlight">\(F(x)\)</span>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">stats(**param_kwargs,</span> <span class="pre">moments="mv")</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">moments</span></code> の値によって統計値を取得 (<code class="docutils literal notranslate"><span class="pre">m</span></code>: 期待値, <code class="docutils literal notranslate"><span class="pre">v</span></code>: 分散, <code class="docutils literal notranslate"><span class="pre">s</span></code>: 歪度, <code class="docutils literal notranslate"><span class="pre">k</span></code>: 尖度).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">median(**param_kwargs)</span></code></p></td>
<td><p>分布のメディアン値.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">mean(**param_kwargs)</span></code></p></td>
<td><p>分布の期待値.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">var(**param_kwargs)</span></code></p></td>
<td><p>分布の分散.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">std(**param_kwargs)</span></code></p></td>
<td><p>分布の標準偏差.</p></td>
</tr>
</tbody>
</table>
<p><u>確率分布</u><br/>
　<code class="docutils literal notranslate"><span class="pre">**param_kwargs</span></code> で分布の形状を決めるにあたって必要な引数とセット.</p>
<ul class="simple">
<li><p>離散型</p>
<ul>
<li><p><a class="reference internal" href="#python-example-bernoulli"><span class="std std-ref">ベルヌーイ分布 ( <code class="docutils literal notranslate"><span class="pre">bernoulli</span></code> )</span></a></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> : 成功確率.</p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#python-example-binomial"><span class="std std-ref">二項分布 ( <code class="docutils literal notranslate"><span class="pre">binom</span></code> )</span></a></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> : 二項分布の試行回数.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> : 成功確率.</p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#python-example-poisson"><span class="std std-ref">ポアソン分布 ( <code class="docutils literal notranslate"><span class="pre">poisson</span></code> )</span></a></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">mu</span></code> : ポアソン分布の平均発生数 (期待値).</p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#python-example-geometric"><span class="std std-ref">幾何分布 ( <code class="docutils literal notranslate"><span class="pre">geom</span></code> )</span></a></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> : 成功確率.</p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#python-example-nbinom"><span class="std std-ref">負の二項分布 ( <code class="docutils literal notranslate"><span class="pre">nbinom</span></code> )</span></a></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> : 成功回数.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> : 成功確率.</p></li>
</ul>
</li>
</ul>
</li>
<li><p>連続型</p>
<ul>
<li><p><a class="reference internal" href="#python-example-uniform"><span class="std std-ref">一様分布 ( <code class="docutils literal notranslate"><span class="pre">uniform</span></code> )</span></a></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">loc=0</span></code> : 区間 <code class="docutils literal notranslate"><span class="pre">[loc,</span> <span class="pre">loc</span> <span class="pre">+</span> <span class="pre">scale]</span></code> で定義された一様分布の右値.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">scale=1</span></code> : 区間 <code class="docutils literal notranslate"><span class="pre">[loc,</span> <span class="pre">loc</span> <span class="pre">+</span> <span class="pre">scale]</span></code> で定義された一様分布の区間幅.</p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#python-example-normal"><span class="std std-ref">正規分布 ( <code class="docutils literal notranslate"><span class="pre">norm</span></code> )</span></a></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">loc</span></code> : 正規分布の期待値.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">scale</span></code> : 正規分布の標準偏差.</p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#python-example-lognormal"><span class="std std-ref">対数正規分布 ( <code class="docutils literal notranslate"><span class="pre">lognorm</span></code> )</span></a></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">s</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">scale</span></code></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#python-example-exponential"><span class="std std-ref">指数分布 ( <code class="docutils literal notranslate"><span class="pre">expon</span></code> )</span></a></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">scale</span></code></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#python-example-gamma"><span class="std std-ref">ガンマ分布 ( <code class="docutils literal notranslate"><span class="pre">gamma</span></code> )</span></a></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">a</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">scale</span></code></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#python-example-beta"><span class="std std-ref">ベータ分布 ( <code class="docutils literal notranslate"><span class="pre">beta</span></code> )</span></a></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">a</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">b</span></code></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</section>
<section id="numpy">
<h3>1.2. NumPy<a class="headerlink" href="#numpy" title="Permalink to this headline">#</a></h3>
<p>また行列演算の際に有効なモジュールである <a class="reference external" href="https://numpy.org">NumPy</a> においても乱数生成機能を持つ.</p>
<ul class="simple">
<li><p><a class="reference external" href="https://numpy.org/doc/stable/reference/random/generator.html">関係モジュールドキュメント (<code class="docutils literal notranslate"><span class="pre">numpy.random.Generator</span></code>)</a></p></li>
</ul>
<p><u>基本的な使い方</u><br/>
　モジュール構成として <code class="docutils literal notranslate"><span class="pre">numpy.random.Generator.{確率分布名}</span></code> という形式で各確率分布のクラスが存在する. 通常は <code class="docutils literal notranslate"><span class="pre">numpy.random.default_rng()</span></code> でコンストラクタを定義し, 確率分布に対応するモジュール ( <code class="docutils literal notranslate"><span class="pre">numpy.random.default_rang().{確率分布名}</span></code> ) を呼び出す方法で使う.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/index.html#module-numpy" title="numpy"><span class="nn">numpy</span></a> <span class="k">as</span> <span class="nn">np</span>

<span class="n">rng</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/random/generator.html#numpy.random.default_rng" title="numpy.random.default_rng"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span></a><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">12345</span><span class="p">)</span>
<span class="n">normal_rvs</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
<p>SciPy と違って各確率分布に対応した擬似乱数生成するメソッドが存在している.</p>
<p><u>確率分布</u><br/>
　確率分布に対応するメソッド名. <code class="docutils literal notranslate"><span class="pre">size</span></code> は共通して生成する乱数の個数.</p>
<ul class="simple">
<li><p>離散型</p>
<ul>
<li><p><a class="reference internal" href="#python-example-bernoulli"><span class="std std-ref">ベルヌーイ分布</span></a></p>
<ul>
<li><p>二項分布において <code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">=</span> <span class="pre">1</span></code> とする.</p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#python-example-binomial"><span class="std std-ref">二項分布 ( <code class="docutils literal notranslate"><span class="pre">binomial(n,</span> <span class="pre">p,</span> <span class="pre">size=None)</span></code> )</span></a></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> : 二項分布の試行回数.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> : 成功確率.</p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#python-example-poisson"><span class="std std-ref">ポアソン分布 ( <code class="docutils literal notranslate"><span class="pre">poisson(lam=1.0,</span> <span class="pre">size=None)</span></code> )</span></a></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">lam</span></code> : ポアソン分布の平均発生数 (期待値).</p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#python-example-geometric"><span class="std std-ref">幾何分布 ( <code class="docutils literal notranslate"><span class="pre">geometric(p,</span> <span class="pre">size=None)</span></code> )</span></a></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> : 成功確率.</p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#python-example-nbinom"><span class="std std-ref">負の二項分布 ( <code class="docutils literal notranslate"><span class="pre">negative_binomial</span></code> )</span></a></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> : 成功回数.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> : 成功確率.</p></li>
</ul>
</li>
</ul>
</li>
<li><p>連続型</p>
<ul>
<li><p><a class="reference internal" href="#python-example-uniform"><span class="std std-ref">一様分布 ( <code class="docutils literal notranslate"><span class="pre">uniform(low=0.0,</span> <span class="pre">high=1.0,</span> <span class="pre">size=None)</span></code> )</span></a></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">low</span></code> : 区間 <code class="docutils literal notranslate"><span class="pre">[low,</span> <span class="pre">high]</span></code> で定義された一様分布の右値.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">high</span></code> : 区間 <code class="docutils literal notranslate"><span class="pre">[low,</span> <span class="pre">high]</span></code> で定義された一様分布の左値.</p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#python-example-normal"><span class="std std-ref">正規分布 ( <code class="docutils literal notranslate"><span class="pre">normal(loc=0.0,</span> <span class="pre">scale=1.0,</span> <span class="pre">size=None)</span></code> )</span></a></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">loc</span></code> : 正規分布の期待値.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">scale</span></code> : 正規分布の標準偏差.</p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#python-example-lognormal"><span class="std std-ref">対数正規分布 ( <code class="docutils literal notranslate"><span class="pre">lognorm(mean=0.0,</span> <span class="pre">sigma=1.0,</span> <span class="pre">size=None)</span></code> )</span></a></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">mean</span></code> : もとになっている正規分布の期待値.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sigma</span></code> : もとになっている正規分布の標準偏差.</p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#python-example-exponential"><span class="std std-ref">指数分布 ( <code class="docutils literal notranslate"><span class="pre">exponential(scale=1.0,</span> <span class="pre">size=None)</span></code> )</span></a></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">scale</span></code></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#python-example-gamma"><span class="std std-ref">ガンマ分布 ( <code class="docutils literal notranslate"><span class="pre">gamma(shape,</span> <span class="pre">scale=1.0,</span> <span class="pre">size=None)</span></code> )</span></a></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">shape</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">scale</span></code></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#python-example-beta"><span class="std std-ref">ベータ分布 ( <code class="docutils literal notranslate"><span class="pre">beta(a,</span> <span class="pre">b,</span> <span class="pre">size=None)</span></code> )</span></a></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">a</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">b</span></code></p></li>
</ul>
</li>
</ul>
</li>
</ul>
<p>本セクションで使用するモジュールを予めインポート, 定義しておく.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.html#module-matplotlib.pyplot" title="matplotlib.pyplot"><span class="nn">matplotlib.pyplot</span></a> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/index.html#module-numpy" title="numpy"><span class="nn">numpy</span></a> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <a class="sphinx-codeautolink-a" href="https://docs.scipy.org/doc/scipy/reference/stats.html#module-scipy.stats" title="scipy.stats"><span class="nn">scipy.stats</span></a> <span class="kn">import</span> <span class="p">(</span>
    <a class="sphinx-codeautolink-a" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.bernoulli.html#scipy.stats.bernoulli" title="scipy.stats.bernoulli"><span class="n">bernoulli</span></a><span class="p">,</span>
    <a class="sphinx-codeautolink-a" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.beta.html#scipy.stats.beta" title="scipy.stats.beta"><span class="n">beta</span></a><span class="p">,</span>
    <a class="sphinx-codeautolink-a" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.binom.html#scipy.stats.binom" title="scipy.stats.binom"><span class="n">binom</span></a><span class="p">,</span>
    <a class="sphinx-codeautolink-a" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.expon.html#scipy.stats.expon" title="scipy.stats.expon"><span class="n">expon</span></a><span class="p">,</span>
    <a class="sphinx-codeautolink-a" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.gamma.html#scipy.stats.gamma" title="scipy.stats.gamma"><span class="n">gamma</span></a><span class="p">,</span>
    <a class="sphinx-codeautolink-a" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.geom.html#scipy.stats.geom" title="scipy.stats.geom"><span class="n">geom</span></a><span class="p">,</span>
    <a class="sphinx-codeautolink-a" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.lognorm.html#scipy.stats.lognorm" title="scipy.stats.lognorm"><span class="n">lognorm</span></a><span class="p">,</span>
    <a class="sphinx-codeautolink-a" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.nbinom.html#scipy.stats.nbinom" title="scipy.stats.nbinom"><span class="n">nbinom</span></a><span class="p">,</span>
    <a class="sphinx-codeautolink-a" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.norm.html#scipy.stats.norm" title="scipy.stats.norm"><span class="n">norm</span></a><span class="p">,</span>
    <a class="sphinx-codeautolink-a" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.poisson.html#scipy.stats.poisson" title="scipy.stats.poisson"><span class="n">poisson</span></a><span class="p">,</span>
    <a class="sphinx-codeautolink-a" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.uniform.html#scipy.stats.uniform" title="scipy.stats.uniform"><span class="n">uniform</span></a><span class="p">,</span>
<span class="p">)</span>

<a class="sphinx-codeautolink-a" href="https://seaborn.pydata.org/generated/seaborn.set.html#seaborn.set" title="seaborn.set"><span class="n">sns</span><span class="o">.</span><span class="n">set</span></a><span class="p">()</span>

<span class="n">rng</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/random/generator.html#numpy.random.default_rng" title="numpy.random.default_rng"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span></a><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">12345</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="id2">
<h2>2. 離散型の確率分布<a class="headerlink" href="#id2" title="Permalink to this headline">#</a></h2>
<section id="id3">
<h3>例 2.1 (ベルヌーイ分布)<a class="headerlink" href="#id3" title="Permalink to this headline">#</a></h3>
<p><strong>ベルヌーイ分布</strong> (Bernoulli distribution) コインの裏表のように2種類の可能な結果 (成功を S, 失敗を F) を生じる試行 (<strong>ベルヌーイ試行</strong> (Bernoulli trials) と言う) に対する確率分布.</p>
<section id="id4">
<h4>確率質量関数<a class="headerlink" href="#id4" title="Permalink to this headline">#</a></h4>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p>成功 S が起きる確率を <span class="math notranslate nohighlight">\(p\)</span> とした場合, 確率変数 <span class="math notranslate nohighlight">\(X\)</span> について成功 S の時に <span class="math notranslate nohighlight">\(X=1\)</span>, 失敗 F の時に <span class="math notranslate nohighlight">\(X = 0\)</span> とする. この時の確率質量関数は以下の通り.</p>
<div class="math notranslate nohighlight">
\[
    f(x) = p^x(1-p)^{1-x}
\]</div>
</div>
<p>ここで<a class="reference internal" href="rvs.html#discrete-distribution"><span class="std std-ref">離散型の確率分布の性質</span></a>を確認する.<br/>
　確率質量関数の定義から <span class="math notranslate nohighlight">\(f(x) \geq 0\)</span> であることは自明. また合計和についても以下から分かる.</p>
<div class="math notranslate nohighlight">
\[
    \begin{align}
        \sum_{x=0}^{1}{f(x)} = (1-p) + p = 1
    \end{align}
\]</div>
</section>
<section id="id5">
<h4>期待値と分散<a class="headerlink" href="#id5" title="Permalink to this headline">#</a></h4>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        &amp; {\rm E}(X) = p \\
        &amp; {\rm Var}(X) = p(1-p)
    \end{align}
\end{split}\]</div>
</div>
<p><u>証明</u><br/>
　<a class="reference internal" href="rvs.html#expectation"><span class="std std-ref">期待値の定義</span></a>より</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm E}(X) &amp;= \sum_{x=0}^{1}{xp^x(1-p)^{1-x}} \\
                   &amp;= p
    \end{align}
\end{split}\]</div>
<p>と計算できる. また分散について<a class="reference internal" href="rvs.html#expect-variance"><span class="std std-ref">分散と期待値の関係式</span></a>から <span class="math notranslate nohighlight">\({\rm E}(X^2)\)</span> を求めることで分散も求められる.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm E}(X^2) &amp;= \sum_{x=0}^{1}{x^2 p^x(1-p)^{1-x}} \\
                     &amp;= p
    \end{align}
\end{split}\]</div>
<p>よって</p>
<div class="math notranslate nohighlight">
\[
    {\rm Var}(X) = {\rm}E(X^2) - ({\rm E}(X))^2 = p - p^2 = p(1-p)
\]</div>
</section>
<section id="python-example-bernoulli">
<span id="id6"></span><h4>Python での確認<a class="headerlink" href="#python-example-bernoulli" title="Permalink to this headline">#</a></h4>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.bernoulli.html#scipy.stats.bernoulli">SciPy ( <code class="docutils literal notranslate"><span class="pre">scipy.stats.bernoulli</span></code> )</a></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> : 成功確率 <span class="math notranslate nohighlight">\(p\)</span></p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.Generator.binomial.html">NumPy ( <code class="docutils literal notranslate"><span class="pre">numpy.random.Generator.binomial</span></code> )</a></p>
<ul>
<li><p>ベルヌーイ分布単独のメソッドはないので <code class="docutils literal notranslate"><span class="pre">n=1</span></code> とする.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> : 成功確率 <span class="math notranslate nohighlight">\(p\)</span></p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 成功確率 p = 0.3 のベルヌーイ分布に従った疑似乱数を size = 10000 だけ生成.</span>
<span class="n">p</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">10000</span>

<span class="c1"># SciPy</span>
<span class="n">rvs</span> <span class="o">=</span> <span class="n">bernoulli</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="s2">"&gt; SciPy"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="n">rvs</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">100</span><span class="p">])</span>

<span class="c1"># NumPy</span>
<span class="n">rvs_numpy</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">binomial</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="s2">"&gt; NumPy"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="n">rvs_numpy</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">100</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&gt; SciPy
[0 0 0 1 0 1 1 0 0 0 1 0 0 0 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 0 0 1 0
 0 1 1 1 1 0 0 0 1 0 1 1 0 1 0 1 0 0 0 0 0 0 1 0 0 0 0 0 0 1 1 0 1 0 1 1 0
 1 1 0 0 0 0 0 0 1 0 0 0 0 0 0 0 1 0 0 0 1 0 1 0 0 1]
&gt; NumPy
[0 0 1 0 0 0 0 0 0 1 0 1 0 0 0 1 0 0 1 0 0 0 0 0 0 1 0 0 0 0 1 0 1 1 1 1 0
 1 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 1 0 1 0
 0 1 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 1 1 0 0 0 1 0 0]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 以降, 乱数から期待値・分散を計算するので関数化</span>
<span class="k">def</span> <span class="nf">calculate_stats</span><span class="p">(</span><span class="n">rvs</span><span class="p">):</span>
    <span class="sd">"""Calculate mean and variance from rvs</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    rvs : {numpy.ndarrary, list}</span>
<span class="sd">        Data to be calculated.</span>
<span class="sd">        </span>
<span class="sd">    Return</span>
<span class="sd">    ------</span>
<span class="sd">    Mean and variance.</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="ow">not</span> <a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#isinstance" title="isinstance"><span class="nb">isinstance</span></a><span class="p">(</span><span class="n">rvs</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/stdtypes.html#list" title="list"><span class="nb">list</span></a><span class="p">)):</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">"Speficed rvs must be np.ndarray or list"</span>
        <span class="k">raise</span> <a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="TypeError"><span class="ne">TypeError</span></a><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rvs</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">rvs</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 期待値・分散の理論値</span>
<span class="n">exp_true</span> <span class="o">=</span> <span class="n">bernoulli</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>
<span class="n">var_true</span> <span class="o">=</span> <span class="n">bernoulli</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>

<span class="c1"># 擬似乱数から期待値・分散の計算</span>
<span class="n">exp_rvs</span><span class="p">,</span> <span class="n">var_rvs</span> <span class="o">=</span> <span class="n">calculate_stats</span><span class="p">(</span><span class="n">rvs</span><span class="p">)</span>

<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="s2">"&gt; SciPy"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="sa">f</span><span class="s2">"期待値(乱数 vs 真値): </span><span class="si">{</span><span class="n">exp_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">exp_true</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="sa">f</span><span class="s2">"分散(乱数 vs 真値): </span><span class="si">{</span><span class="n">var_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">var_true</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

<span class="n">exp_rvs</span><span class="p">,</span> <span class="n">var_rvs</span> <span class="o">=</span> <span class="n">calculate_stats</span><span class="p">(</span><span class="n">rvs_numpy</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="s2">"&gt; NumPy"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="sa">f</span><span class="s2">"期待値(乱数 vs 真値): </span><span class="si">{</span><span class="n">exp_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">exp_true</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="sa">f</span><span class="s2">"分散(乱数 vs 真値): </span><span class="si">{</span><span class="n">var_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">var_true</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&gt; SciPy
期待値(乱数 vs 真値): 0.2983 vs 0.3
分散(乱数 vs 真値): 0.20931711000000006 vs 0.21
&gt; NumPy
期待値(乱数 vs 真値): 0.2951 vs 0.3
分散(乱数 vs 真値): 0.20801598999999996 vs 0.21
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 確率変数 x を渡すことで, それぞれに対応する確率質量関数の値を取得できる.</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">bernoulli</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>

<span class="c1"># 擬似乱数によるヒストグラムと確率質量関数の値を図示.</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span>
    <span class="p">[</span><span class="n">rvs</span><span class="p">,</span> <span class="n">rvs_numpy</span><span class="p">],</span>
    <span class="n">bins</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
    <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="s2">"blue"</span><span class="p">,</span> <span class="s2">"green"</span><span class="p">],</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="p">[</span><span class="s2">"SciPy"</span><span class="p">,</span> <span class="s2">"NumPy"</span><span class="p">],</span>
<span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"PMF"</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">"red"</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Bernoulli Distribution (p = </span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s2">)"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, 'Bernoulli Distribution (p = 0.3)')
</pre></div>
</div>
<img alt="../../_images/dist_14_1.png" src="../../_images/dist_14_1.png">
</img></div>
</div>
</section>
<section id="id7">
<h4>ユースケース<a class="headerlink" href="#id7" title="Permalink to this headline">#</a></h4>
<p>単独で使用することはあまりないが, 統計モデルの一部にベルヌーイ分布を仮定することが多い. 現象が2パターンしか取り得ないような「会員登録の実施有無」, 「レビュー記事に対して高評価をするかしないか」, 「購買行動を行うか否か」にベルヌーイ分布を仮定する.</p>
<ul class="simple">
<li><p>商品レビューが有用かどうか (<a class="reference external" href="https://www.jstage.jst.go.jp/article/jsaikbs/118/0/118_05/_pdf">柴田と伊東, 2019</a>. この論文内ではベルヌーイ分布による評価の代替評価を提案している.)</p></li>
<li><p>ECサイト利用者に対して施策を売った際にどういったセグメントグループに効果的に機能したかを推定するモデル内において, セグメントグループの購買有無に対してベルヌーイ分布を仮定 (<a class="reference external" href="https://ipsj.ixsq.nii.ac.jp/ej/?action=repository_action_common_download&amp;item_id=185104&amp;item_no=1&amp;attribute_id=1&amp;file_no=1">松嵜ら, 2017</a>)</p></li>
</ul>
</section>
</section>
<section id="id8">
<h3>例 2.2 (二項分布)<a class="headerlink" href="#id8" title="Permalink to this headline">#</a></h3>
<p><strong>二項分布</strong> (binomial distribution) は結果が 2 つの試行 (成功を S, 失敗を F) を何度も繰り返すことによって起こる確率分布.</p>
<section id="id9">
<h4>確率質量関数<a class="headerlink" href="#id9" title="Permalink to this headline">#</a></h4>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p>S が 確率 <span class="math notranslate nohighlight">\(p (0 \leq p \leq 1)\)</span> で <span class="math notranslate nohighlight">\(x\)</span> 回, F が確率 <span class="math notranslate nohighlight">\(1-p\)</span> で <span class="math notranslate nohighlight">\(n-x\)</span> 回生じるとすると, <span class="math notranslate nohighlight">\(x=0,1, \cdots, n\)</span> であって, その確率質量関数は以下の通り.</p>
<div class="math notranslate nohighlight">
\[
    f(x) = {}_n{\rm C}_{x} p^x (1-p)^{n-x}
\]</div>
</div>
<p>確率変数 <span class="math notranslate nohighlight">\(X\)</span> が 二項分布に従っていることを <span class="math notranslate nohighlight">\(X \sim Bi(n, p)\)</span> と記載する.</p>
<p>ここで<a class="reference internal" href="rvs.html#discrete-distribution"><span class="std std-ref">離散型の確率分布の性質</span></a>を確認する.<br/>
　確率質量関数の定義から <span class="math notranslate nohighlight">\(f(x) \geq 0\)</span> であることは自明. また合計和については下記よりまさに二項展開式より 1 となる.</p>
<div class="math notranslate nohighlight">
\[
    \begin{align}
        \sum_{x=0}^{n}{ {}_n{\rm C}_{x} p^x (1-p)^{n-x} } = {(1-p) + p}^n = 1.
    \end{align}
\]</div>
</section>
<section id="id10">
<h4>期待値と分散<a class="headerlink" href="#id10" title="Permalink to this headline">#</a></h4>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        &amp; {\rm E}(X) = np \\
        &amp; {\rm Var}(X) = np(1-p)
    \end{align}
\end{split}\]</div>
</div>
<p><u>証明</u><br/>
　<a class="reference internal" href="rvs.html#expectation"><span class="std std-ref">期待値の定義</span></a>より</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm E}(X) &amp;= \sum_{x=0}^{n}{ x{}_n{\rm C}_{x} p^x (1-p)^{n-x} } \\
                   &amp;= \sum_{x=1}^{n}{ n{}_{n-1}{\rm C}_{x-1} p^x (1-p)^{n-x} } \quad (\text{二項係数の性質より} x{}_n{\rm C}_{x} = n{}_{n-1}{\rm C}_{x-1})\\
                   &amp;= \sum_{x=1}^{n}{ n{}_{n-1}{\rm C}_{x-1} p^x (1-p)^{n-x} } \\
                   &amp;= np \sum_{x=1}^{n}{ {}_{n-1}{\rm C}_{x-1} p^{x-1} (1-p)^{n-x} } \\
                   &amp;= np \sum_{x'=0}^{n'}{ {}_{n'}{\rm C}_{x'} p^{x'} (1-p)^{n'-x'} } \quad(n-1=n', x-1=x') \\
                   &amp;= np
    \end{align}
\end{split}\]</div>
<p>と計算できる. また分散について<a class="reference internal" href="rvs.html#expect-variance"><span class="std std-ref">分散と期待値の関係式</span></a>から</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm V}(X) &amp;= {\rm E}(X^2) - ({\rm E}(X))^2 \\
                   &amp;= {\rm E}(X(X-1) + X) - ({\rm E}(X))^2 \\
                   &amp;= {\rm E}(X(X-1)) + {\rm E}(X) - ({\rm E}(X))^2
    \end{align}
\end{split}\]</div>
<p>より <span class="math notranslate nohighlight">\({\rm E}(X(X-1))\)</span> を求めれば良い. 二項係数について</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        &amp; {}_n{\rm C}_{x} = \frac{n}{x} {}_{n-1}{\rm C}_{x-1} = \frac{n}{x} \cdot \frac{n-1}{x-1} \cdot {}_{n-2}{\rm C}_{x-2} \\
        &amp;\Leftrightarrow x(x-1) {}_n{\rm C}_{x} = n(n-1) {}_{n-2}{\rm C}_{x-2}
    \end{align}
\end{split}\]</div>
<p>より</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm E}(X(X-1)) &amp;= \sum_{x=0}^{n}{ x(x-1) {}_n{\rm C}_{x} p^x (1-p)^{n-x} } \\
                        &amp;= \sum_{x=2}^{n}{ n(n-1) {}_{n-2}{\rm C}_{x-2} p^x (1-p)^{n-x} } \\
                        &amp;= n(n-1)p^2 \sum_{x=2}^{n}{ {}_{n-2}{\rm C}_{x-2} p^{x-2} (1-p)^{n-x} } \\
                        &amp;= n(n-1)p^2 \sum_{x"=0}^{n"}{ {}_{n"}{\rm C}_{x"} p^{x"} (1-p)^{n"-x"} } \quad (n-2=n", x-2=x")\\
                        &amp;= n(n-1)p^2
    \end{align}
\end{split}\]</div>
<p>よって</p>
<div class="math notranslate nohighlight">
\[
    {\rm Var}(X) = n(n-1)p^2 + np - (np)^2 = np(1-p).
\]</div>
</section>
<section id="python-example-binomial">
<span id="id11"></span><h4>Python での確認<a class="headerlink" href="#python-example-binomial" title="Permalink to this headline">#</a></h4>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.binom.html#scipy.stats.binom">SciPy ( <code class="docutils literal notranslate"><span class="pre">scipy.stats.binom</span></code> )</a></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> : ベルヌーイ試行回数 <span class="math notranslate nohighlight">\(n\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> : 成功確率 <span class="math notranslate nohighlight">\(p\)</span>.</p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.Generator.binomial.html">NumPy ( <code class="docutils literal notranslate"><span class="pre">numpy.random.Generator.binomial</span></code> )</a></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> : ベルヌーイ試行回数 <span class="math notranslate nohighlight">\(n\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> : 成功確率 <span class="math notranslate nohighlight">\(p\)</span>.</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 試行回数 n = 10, 成功確率 p = 0.3 の二項分布に従った疑似乱数を size = 10000 だけ生成する.</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">p</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">10000</span>

<span class="c1"># SciPy</span>
<span class="n">rvs</span> <span class="o">=</span> <span class="n">binom</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="s2">"&gt; SciPy"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="n">rvs</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">100</span><span class="p">])</span>

<span class="c1"># NumPy</span>
<span class="n">rvs_numpy</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">binomial</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="s2">"&gt; NumPy"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="n">rvs_numpy</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">100</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&gt; SciPy
[4 3 3 5 3 4 2 5 2 6 2 1 3 3 2 3 6 2 3 2 0 4 4 2 2 4 4 2 4 4 1 3 2 4 1 3 3
 3 2 3 6 6 2 3 4 4 2 2 2 4 4 0 3 4 3 6 3 4 4 1 5 3 3 3 4 4 5 4 2 4 3 3 4 2
 4 4 1 2 3 2 1 3 5 4 5 3 4 4 3 2 3 2 4 4 1 4 4 4 5 0]
&gt; NumPy
[5 5 4 2 4 2 4 3 2 3 3 1 6 2 4 5 3 5 6 1 3 4 6 4 7 3 4 2 3 2 5 4 5 2 4 2 3
 3 3 5 2 4 3 2 5 2 2 2 3 1 4 2 2 2 5 4 3 3 5 1 3 4 5 4 4 5 5 2 2 2 7 1 3 2
 4 4 1 3 1 0 1 5 2 6 3 2 5 3 2 2 1 4 3 5 2 4 5 1 3 5]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 期待値・分散の理論値</span>
<span class="n">exp_true</span> <span class="o">=</span> <span class="n">binom</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>
<span class="n">var_true</span> <span class="o">=</span> <span class="n">binom</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>

<span class="c1"># 擬似乱数から期待値・分散の計算</span>
<span class="n">exp_rvs</span><span class="p">,</span> <span class="n">var_rvs</span> <span class="o">=</span> <span class="n">calculate_stats</span><span class="p">(</span><span class="n">rvs</span><span class="p">)</span>

<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="s2">"&gt; SciPy"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="sa">f</span><span class="s2">"期待値(乱数 vs 真値): </span><span class="si">{</span><span class="n">exp_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">exp_true</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="sa">f</span><span class="s2">"分散(乱数 vs 真値): </span><span class="si">{</span><span class="n">var_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">var_true</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

<span class="n">exp_rvs</span><span class="p">,</span> <span class="n">var_rvs</span> <span class="o">=</span> <span class="n">calculate_stats</span><span class="p">(</span><span class="n">rvs_numpy</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="s2">"&gt; NumPy"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="sa">f</span><span class="s2">"期待値(乱数 vs 真値): </span><span class="si">{</span><span class="n">exp_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">exp_true</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="sa">f</span><span class="s2">"分散(乱数 vs 真値): </span><span class="si">{</span><span class="n">var_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">var_true</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&gt; SciPy
期待値(乱数 vs 真値): 2.9986 vs 3.0
分散(乱数 vs 真値): 2.11139804 vs 2.0999999999999996
&gt; NumPy
期待値(乱数 vs 真値): 3.0054 vs 3.0
分散(乱数 vs 真値): 2.14157084 vs 2.0999999999999996
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 確率変数 x を渡すことで, それぞれに対応する確率質量関数の値を取得できる.</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">binom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>

<span class="c1"># 擬似乱数によるヒストグラムと確率質量関数の値を図示.</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span>
    <span class="p">[</span><span class="n">rvs</span><span class="p">,</span> <span class="n">rvs_numpy</span><span class="p">],</span>
    <span class="n">bins</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
    <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="s2">"blue"</span><span class="p">,</span> <span class="s2">"green"</span><span class="p">],</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="p">[</span><span class="s2">"SciPy"</span><span class="p">,</span> <span class="s2">"NumPy"</span><span class="p">],</span>
<span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"PMF"</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">"red"</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Binomial Distribution (n = </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">, p = </span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s2">)"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, 'Binomial Distribution (n = 10, p = 0.3)')
</pre></div>
</div>
<img alt="../../_images/dist_22_1.png" src="../../_images/dist_22_1.png">
</img></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># n = 10 で固定し p のみを動かした時の波形の違い.</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

<span class="n">ps</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]</span>
<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">ps</span><span class="p">:</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">binom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>
    <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"p = </span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s2">"</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x1284c1690&gt;
</pre></div>
</div>
<img alt="../../_images/dist_23_1.png" src="../../_images/dist_23_1.png">
</img></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># p = 0.3 で固定し n のみを動かした時の波形の違い.</span>
<span class="n">p</span> <span class="o">=</span> <span class="mf">0.3</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax3</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

<span class="n">ns</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">30</span><span class="p">]</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#max" title="max"><span class="nb">max</span></a><span class="p">(</span><span class="n">ns</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">ns</span><span class="p">:</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">binom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>
    <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"n = </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">"</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>

<span class="n">ax3</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x1284972e0&gt;
</pre></div>
</div>
<img alt="../../_images/dist_24_1.png" src="../../_images/dist_24_1.png"/>
</div>
</div>
</section>
<section id="id12">
<h4>ユースケース<a class="headerlink" href="#id12" title="Permalink to this headline">#</a></h4>
<ul class="simple">
<li><p>バナー広告のインプレッション数 <span class="math notranslate nohighlight">\(n\)</span> 回のうち, クリック率 <span class="math notranslate nohighlight">\(p\)</span> で広告がクリックされる回数 (<a class="reference external" href="http://www.orsj.or.jp/archive2/or57-10/or57_10_574.pdf">本橋ら, 2012</a>)</p></li>
<li><p>特定のサービスにおいて <span class="math notranslate nohighlight">\(n\)</span> 人の利用ユーザーのうち, 確率 <span class="math notranslate nohighlight">\(p\)</span> で解約する人数</p></li>
<li><p>特定の病気において <span class="math notranslate nohighlight">\(n\)</span> 人の被験者のうち, 病気の発症率 <span class="math notranslate nohighlight">\(p\)</span> がどのように変わるか</p></li>
</ul>
</section>
</section>
<section id="id13">
<h3>例 2.3 (ポアソン分布)<a class="headerlink" href="#id13" title="Permalink to this headline">#</a></h3>
<p><strong>ポアソン分布</strong> (Poisson distribution) とは, 二項分布において <span class="math notranslate nohighlight">\(n\)</span> が大 (すなわち大量の観測) である一方, <span class="math notranslate nohighlight">\(p\)</span> が小 (すなわち希少現象) である分布.</p>
<section id="id14">
<h4>確率質量関数<a class="headerlink" href="#id14" title="Permalink to this headline">#</a></h4>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p><span class="math notranslate nohighlight">\(\lambda &gt; 0, x \geq 0\)</span> として確率質量関数は以下の通り.</p>
<div class="math notranslate nohighlight">
\[
    f(x) = \frac{e^{-\lambda} \lambda^{x}}{x!}
\]</div>
</div>
<p>ここで<a class="reference internal" href="rvs.html#discrete-distribution"><span class="std std-ref">離散型の確率分布の性質</span></a>を確認する.<br/>
　確率質量関数の定義から <span class="math notranslate nohighlight">\(f(x) \geq 0\)</span> であることは自明. また, <span class="math notranslate nohighlight">\(e^x\)</span> について<a class="reference external" href="https://ja.wikipedia.org/wiki/%E3%83%86%E3%82%A4%E3%83%A9%E3%83%BC%E5%B1%95%E9%96%8B">マクローリン展開</a>から</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        e^x &amp;= 1 + \frac{x}{1!} + \frac{x^2}{2!} + \cdots + \frac{x^k}{k!} + \cdots \\
            &amp;= \sum_{k=0}^{\infty}{\frac{x^k}{k!}}
    \end{align}
\end{split}\]</div>
<p>と書けるので,</p>
<div class="math notranslate nohighlight">
\[
\sum_{x=0}^{\infty}{f(x)} = \sum_{x=0}^{\infty}{\frac{e^{-\lambda} \lambda^{x}}{x!}} = e^{-\lambda} \sum_{x=0}^{\infty}{\frac{ \lambda^{x}}{x!}} = e^{-\lambda} \cdot e^{\lambda} = 1
\]</div>
<p>と分かる.</p>
<p>確率変数 <span class="math notranslate nohighlight">\(X\)</span> がポアソン分布に従う時, <span class="math notranslate nohighlight">\(X \sim Po(\lambda)\)</span> または <span class="math notranslate nohighlight">\(X \sim Poisson(\lambda)\)</span> と記載する.</p>
</section>
<section id="id15">
<h4>期待値と分散<a class="headerlink" href="#id15" title="Permalink to this headline">#</a></h4>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        &amp; {\rm E}(X) = \lambda \\
        &amp; {\rm Var}(X) = \lambda
    \end{align}
\end{split}\]</div>
</div>
<p><u>証明</u><br/>
　<a class="reference internal" href="rvs.html#expectation"><span class="std std-ref">期待値の定義</span></a>より</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm E}(X) &amp;= \sum_{x=0}^{\infty}{x\frac{e^{-\lambda}\lambda^{x}}{x!}} \\
                   &amp;= \lambda e^{-\lambda}\sum_{x=1}^{\infty}{\frac{\lambda^{x-1}}{(x-1)!}} \\
                   &amp;= \lambda e^{-\lambda} \cdot e^{\lambda} \\
                   &amp;= \lambda
    \end{align}
\end{split}\]</div>
<p>と計算できる. また分散について<a class="reference internal" href="rvs.html#expect-variance"><span class="std std-ref">分散と期待値の関係式</span></a>から <span class="math notranslate nohighlight">\({\rm E}(X^2)\)</span> を求めることで分散も求められる.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm E}(X^2) &amp;= \sum_{x=0}^{\infty}{x^2\frac{e^{-\lambda}\lambda^{x}}{x!}} \\
                     &amp;= \sum_{x=0}^{\infty}{\{x(x-1) + x\} \frac{e^{-\lambda}\lambda^{x}}{x!}} \\
                     &amp;= \lambda^2 e^{-\lambda}\sum_{x=2}^{\infty}{\frac{\lambda^{x-2}}{(x-2)!}} + \lambda e^{-\lambda}\sum_{x=1}^{\infty}{\frac{\lambda^{x-1}}{(x-1)!}} \\
                     &amp;= \lambda^2 + \lambda \\
    \end{align}
\end{split}\]</div>
<p>よって</p>
<div class="math notranslate nohighlight">
\[
    {\rm Var}(X) = {\rm}E(X^2) - ({\rm E}(X))^2 = \lambda^2 + \lambda - \lambda^2 = \lambda
\]</div>
</section>
<section id="python-example-poisson">
<span id="id16"></span><h4>Python での確認<a class="headerlink" href="#python-example-poisson" title="Permalink to this headline">#</a></h4>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.poisson.html#scipy.stats.poisson">SciPy ( <code class="docutils literal notranslate"><span class="pre">scipy.stats.poisson</span></code> )</a></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">mu</span></code> : <span class="math notranslate nohighlight">\(\lambda\)</span>.</p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.Generator.poisson.html">NumPy ( <code class="docutils literal notranslate"><span class="pre">numpy.random.Generator.poisson</span></code> )</a></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">lam</span></code> : <span class="math notranslate nohighlight">\(\lambda\)</span>.</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># lambda = 5.0 のポアソン分布に従った疑似乱数を size = 10000 だけ生成する.</span>
<span class="n">mu</span> <span class="o">=</span> <span class="n">lam</span> <span class="o">=</span> <span class="mf">5.0</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">10000</span>

<span class="c1"># SciPy</span>
<span class="n">rvs</span> <span class="o">=</span> <span class="n">poisson</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="n">mu</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="s2">"&gt; SciPy"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="n">rvs</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">100</span><span class="p">])</span>

<span class="c1"># NumPy</span>
<span class="n">rvs_numpy</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">poisson</span><span class="p">(</span><span class="n">lam</span><span class="o">=</span><span class="n">lam</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="s2">"&gt; NumPy"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="n">rvs_numpy</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">100</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&gt; SciPy
[ 2  4  6  5  8  7  2  7  5  7  3  5  5  4  3  4  6  5  1  5  7  8  9  3
  2  4  4  9  5  8  4 11  4  5  3  6  5  8  4  5  7  5  4  5  4  8  3  6
  4  1  5  4  3  6  3  5  2  5  6  5  9  7  5  3  6  8  5  1  2  4  4  2
  1  6 11  3  3  8  8  8  4  6  5  9  8  3  4  2  4  3  6  8  3  7  2  4
  4  4  3  6]
&gt; NumPy
[ 3  4 10  3  3  2 13  6  5  2  6  5  5  2  5  4  3  3  4  6  8  6  8  7
  4  5  3  4  7  7  4  3  7  6  4  4  2  5  2  7  3  4  5  4  6  5  4  8
  6  3  4  3  3  5  2  3  4  6  2  6  4  7  5  5  6  3  5  9  4  3  1  5
  2  5  6  1  5  5  7 10  6  7  5  8  3  5  2  3  3  1  4  5  1  5  6 12
  5  5  3  5]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 期待値・分散の理論値</span>
<span class="n">exp_true</span> <span class="o">=</span> <span class="n">poisson</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="n">mu</span><span class="p">)</span>
<span class="n">var_true</span> <span class="o">=</span> <span class="n">poisson</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="n">mu</span><span class="p">)</span>

<span class="c1"># 擬似乱数から期待値・分散の計算</span>
<span class="n">exp_rvs</span><span class="p">,</span> <span class="n">var_rvs</span> <span class="o">=</span> <span class="n">calculate_stats</span><span class="p">(</span><span class="n">rvs</span><span class="p">)</span>

<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="s2">"&gt; SciPy"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="sa">f</span><span class="s2">"期待値(乱数 vs 真値): </span><span class="si">{</span><span class="n">exp_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">exp_true</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="sa">f</span><span class="s2">"分散(乱数 vs 真値): </span><span class="si">{</span><span class="n">var_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">var_true</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

<span class="n">exp_rvs</span><span class="p">,</span> <span class="n">var_rvs</span> <span class="o">=</span> <span class="n">calculate_stats</span><span class="p">(</span><span class="n">rvs_numpy</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="s2">"&gt; NumPy"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="sa">f</span><span class="s2">"期待値(乱数 vs 真値): </span><span class="si">{</span><span class="n">exp_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">exp_true</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="sa">f</span><span class="s2">"分散(乱数 vs 真値): </span><span class="si">{</span><span class="n">var_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">var_true</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&gt; SciPy
期待値(乱数 vs 真値): 5.0104 vs 5.0
分散(乱数 vs 真値): 5.010091840000001 vs 5.0
&gt; NumPy
期待値(乱数 vs 真値): 5.0234 vs 5.0
分散(乱数 vs 真値): 4.98485244 vs 5.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 確率変数 x を渡すことで, それぞれに対応する確率質量関数の値を取得できる.</span>
<span class="n">rvs_max</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#max" title="max"><span class="nb">max</span></a><span class="p">(</span><span class="n">rvs</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">rvs_numpy</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">rvs_max</span> <span class="o">+</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">poisson</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="n">mu</span><span class="p">)</span>

<span class="c1"># 擬似乱数によるヒストグラムと確率質量関数の値を図示.</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span>
    <span class="p">[</span><span class="n">rvs</span><span class="p">,</span> <span class="n">rvs_numpy</span><span class="p">],</span>
    <span class="n">bins</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
    <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="s2">"blue"</span><span class="p">,</span> <span class="s2">"green"</span><span class="p">],</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="p">[</span><span class="s2">"SciPy"</span><span class="p">,</span> <span class="s2">"NumPy"</span><span class="p">],</span>
<span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"PMF"</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">"red"</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Poisson Distribution (lambda = </span><span class="si">{</span><span class="n">mu</span><span class="si">}</span><span class="s2">)"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, 'Poisson Distribution (lambda = 5.0)')
</pre></div>
</div>
<img alt="../../_images/dist_32_1.png" src="../../_images/dist_32_1.png"/>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># lambda を動かした時の波形の違い.</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

<span class="n">mus</span> <span class="o">=</span> <span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">7.0</span><span class="p">,</span> <span class="mf">11.0</span><span class="p">,</span> <span class="mf">13.0</span><span class="p">,</span> <span class="mf">15.0</span><span class="p">]</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="k">for</span> <span class="n">mu</span> <span class="ow">in</span> <span class="n">mus</span><span class="p">:</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">poisson</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="n">mu</span><span class="p">)</span>
    <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"lambda = </span><span class="si">{</span><span class="n">mu</span><span class="si">}</span><span class="s2">"</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x12800d1e0&gt;
</pre></div>
</div>
<img alt="../../_images/dist_33_1.png" src="../../_images/dist_33_1.png"/>
</div>
</div>
<p>二項分布において <span class="math notranslate nohighlight">\(n \rightarrow \infty, p \rightarrow 0\)</span> とすることでポアソン分布に近づく. ここで <span class="math notranslate nohighlight">\(\lambda = np\)</span> とすれば確率質量関数 <span class="math notranslate nohighlight">\(f(x)\)</span> は</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        f(x) &amp;= {}_n{\rm C}_{x} \Bigl( \frac{\lambda}{n} \Bigr)^x \Bigl( 1 - \frac{\lambda}{n} \Bigr)^{n-x} \\
             &amp;= \frac{n(n-1) \cdots (n-x+1)}{x!} \frac{\lambda^x}{n^x} \Bigl( 1 - \frac{\lambda}{n} \Bigr)^n \Bigl( 1 - \frac{\lambda}{n} \Bigr)^{-x} \\
             &amp;= \frac{\lambda^x}{x!} \Bigl( 1 - \frac{\lambda}{n} \Bigr)^n \Bigl( 1 - \frac{1}{n} \Bigr) \Bigl( 1 - \frac{2}{n} \Bigr) \cdots \Bigl( 1 - \frac{k-1}{n} \Bigr) \Bigl( 1 - \frac{\lambda}{n} \Bigr)^{-x}
    \end{align}
\end{split}\]</div>
<p>ここで, <span class="math notranslate nohighlight">\(n \rightarrow \infty\)</span> とした時, <span class="math notranslate nohighlight">\(m = 1, 2, \cdots, k-1\)</span> とすれば</p>
<div class="math notranslate nohighlight">
\[
\lim_{n \rightarrow \infty}{\Bigl( 1 - \frac{m}{n} \Bigr)} = 0, \quad \lim_{n \rightarrow \infty}{\Bigl( 1 - \frac{\lambda}{n} \Bigr)^{-x}} = 0 \quad \lim_{n \rightarrow \infty}{\Bigl( 1 - \frac{\lambda}{n} \Bigr)^n} = e^{-\lambda}
\]</div>
<p>なので,</p>
<div class="math notranslate nohighlight">
\[
    \lim_{n \rightarrow \infty}{f(x)} = \frac{e^{-\lambda} \lambda^{x}}{x!}
\]</div>
<p>とポアソン分布になる. 実際に python で二項分布とポアソン分布を比較する.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># x軸</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># 図の定義</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

<span class="c1"># ポアソン分布</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">poisson</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
<span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"Poisson (lambda = 2.0)"</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">"red"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>

<span class="c1"># 二項分布</span>
<span class="n">scales</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">,</span> <span class="mi">100000</span><span class="p">])</span>
<span class="n">base_n</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">base_p</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="k">for</span> <span class="n">scale</span> <span class="ow">in</span> <span class="n">scales</span><span class="p">:</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">base_n</span> <span class="o">*</span> <span class="n">scale</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">base_p</span> <span class="o">/</span> <span class="n">scale</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">binom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>
    <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"Binomial (n = </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">, p = </span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s2">)"</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">"dashed"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">"Binomial vs Poisson"</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x11bd17250&gt;
</pre></div>
</div>
<img alt="../../_images/dist_35_1.png" src="../../_images/dist_35_1.png"/>
</div>
</div>
</section>
<section id="id17">
<h4>ユースケース<a class="headerlink" href="#id17" title="Permalink to this headline">#</a></h4>
<ul class="simple">
<li><p>交通事故件数</p></li>
<li><p>大量生産の不良品数 (<a class="reference external" href="https://notebook.community/STREAM3/pyisc/docs/pyISC_simple_anomaly_example">pyISC Example: Simple Anomaly Detection with Frequency Data</a>)</p></li>
<li><p>破産件数</p></li>
<li><p>火災件数</p></li>
<li><p>砲弾命中数</p></li>
<li><p>遺伝子の突然変異数</p></li>
<li><p>電話の呼び数</p></li>
<li><p>渋滞していない高速道路の料金ゲートへの車の到着台数</p></li>
<li><p>医学研究において顕微鏡視野に入る区画当たりのバクテリア数</p></li>
<li><p>物理現象として単位時間当たりのガイガー計数管の読み数</p></li>
</ul>
</section>
</section>
<section id="id18">
<h3>例 2.4 (幾何分布)<a class="headerlink" href="#id18" title="Permalink to this headline">#</a></h3>
<p>成功 S (発生確率 <span class="math notranslate nohighlight">\(p\)</span>) と失敗 F (発生確率 <span class="math notranslate nohighlight">\(q = 1- p\)</span>) の 2 通りしかない試行を次々と続ける試行を考える. 最初の成功 S が出現するまでの試行回数を <span class="math notranslate nohighlight">\(x\)</span> とするならば <span class="math notranslate nohighlight">\(x = 1, 2, 3, \cdots\)</span> であり以下の確率質量関数で表現される確率分布を<strong>幾何分布</strong> (geometric distribution) という.</p>
<section id="id19">
<h4>確率質量関数<a class="headerlink" href="#id19" title="Permalink to this headline">#</a></h4>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p><span class="math notranslate nohighlight">\(0 \lt p \lt 1, q = 1 - p\)</span> とする.</p>
<div class="math notranslate nohighlight">
\[
    f(x) = pq^{x-1} \quad (x = 1, 2, 3, \cdots)
\]</div>
</div>
<p>これは <span class="math notranslate nohighlight">\(x\)</span> に応じて幾何級数 (等比数列) 的に減じていくため幾何分布という.<br/>
　ここで<a class="reference internal" href="rvs.html#discrete-distribution"><span class="std std-ref">離散型の確率分布の性質</span></a>を確認する.<br/>
　確率質量関数の定義から <span class="math notranslate nohighlight">\(f(x) \geq 0\)</span> であることは自明. また, <span class="math notranslate nohighlight">\(0 \lt p \lt 1 \Rightarrow 0 \lt q \lt 1\)</span> なので無限等比級数の和から</p>
<div class="math notranslate nohighlight">
\[
\sum_{x=1}^{\infty}{f(x)} = p\sum_{x=1}^{\infty}{q} = p \cdot \frac{1}{1-q} = p \cdot \frac{1}{p} = 1
\]</div>
<p>と分かる.</p>
</section>
<section id="id20">
<h4>期待値と分散<a class="headerlink" href="#id20" title="Permalink to this headline">#</a></h4>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        &amp; {\rm E}(X) = \frac{1}{p} \\
        &amp; {\rm Var}(X) = \frac{q}{p^2}
    \end{align}
\end{split}\]</div>
</div>
<p><u>証明</u><br/>
　<a class="reference internal" href="rvs.html#expectation"><span class="std std-ref">期待値の定義</span></a>より</p>
<div class="math notranslate nohighlight">
\[
    \begin{align}
        {\rm E}(X) = \sum_{x=1}^{\infty}{x pq^{x-1}} = p \sum_{x=1}^{\infty}{ xq^{x-1} }
    \end{align}
\]</div>
<p><span class="math notranslate nohighlight">\(0 \lt q \lt 1\)</span> において</p>
<div class="math notranslate nohighlight">
\[
    g(q) = \sum_{x = 0}^{\infty}{q^x} = \frac{1}{1-q}
\]</div>
<p>を考える. 第 3 項については無限等比級数の和から分かる. <span class="math notranslate nohighlight">\(q\)</span> について微分すると</p>
<div class="math notranslate nohighlight">
\[
    g'(q) = \sum_{x = 1}^{\infty}{xq^{x-1}} = \frac{1}{(1-q)^2}
\]</div>
<p>となり <span class="math notranslate nohighlight">\(p = 1 - q\)</span> であることに注意して,</p>
<div class="math notranslate nohighlight">
\[
    {\rm E}(X) = p \sum_{x=1}^{\infty}{ xq^{x-1} } = p \cdot \frac{1}{(1-q)^2} = \frac{1}{p}
\]</div>
<p>と求められる. また分散について<a class="reference internal" href="rvs.html#expect-variance"><span class="std std-ref">分散と期待値の関係式</span></a>から</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm Var}(X) &amp;= {\rm}E(X^2) - ({\rm E}(X))^2 \\
                     &amp;= {\rm}E(X(X-1)+X) - ({\rm E}(X))^2 \\
                     &amp;= {\rm}E(X(X-1)) + {\rm}E(X) - ({\rm E}(X))^2
    \end{align}
\end{split}\]</div>
<p>第 2 式から弟 3 式への変換は<a class="reference internal" href="rvs.html#expectation-property"><span class="std std-ref">期待値の4番目の性質</span></a>を用いている.
　<span class="math notranslate nohighlight">\({\rm}E(X(X-1))\)</span> を求めれば分散が求められる. 上で用いた <span class="math notranslate nohighlight">\(g(q)\)</span> を 2 階微分すると</p>
<div class="math notranslate nohighlight">
\[
    g''(q) = \sum_{x = 2}^{\infty}{x(x-1)q^{x-2}} = \frac{2}{(1-q)^3}
\]</div>
<p>なので</p>
<div class="math notranslate nohighlight">
\[
    {\rm E}(X(X-1)) = pq \sum_{x=2}^{\infty}{ x(x-1)q^{x-2} } = pq \frac{2}{(1-q)^3} = \frac{2(1-q)}{p^2}
\]</div>
<p>となり分散は</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm Var}(X) &amp;= {\rm}E(X(X-1)) + {\rm}E(X) - ({\rm E}(X))^2 \\
                     &amp;= \frac{2(1-q)}{p^2} + \frac{1}{p} - \frac{1}{p^2} \\
                     &amp;= \frac{1-p}{p^2} \\
                     &amp;= \frac{q}{p^2}
    \end{align}
\end{split}\]</div>
<p>と分かる.</p>
</section>
<section id="python-example-geometric">
<span id="id21"></span><h4>Python での確認<a class="headerlink" href="#python-example-geometric" title="Permalink to this headline">#</a></h4>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.geom.html#scipy.stats.geom">SciPy ( <code class="docutils literal notranslate"><span class="pre">scipy.stats.geom</span></code> )</a></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> : 成功確率 <span class="math notranslate nohighlight">\(p\)</span>.</p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.Generator.geometric.html">NumPy ( <code class="docutils literal notranslate"><span class="pre">numpy.random.Generator.geometric</span></code> )</a></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> : 成功確率 <span class="math notranslate nohighlight">\(p\)</span>.</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># p = 0.30 の幾何分布に従った疑似乱数を size = 10000 だけ生成する.</span>
<span class="n">p</span> <span class="o">=</span> <span class="mf">0.30</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">10000</span>

<span class="c1"># SciPy</span>
<span class="n">rvs</span> <span class="o">=</span> <span class="n">geom</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="s2">"&gt; SciPy"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="n">rvs</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">100</span><span class="p">])</span>

<span class="c1"># NumPy</span>
<span class="n">rvs_numpy</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">geometric</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="s2">"&gt; NumPy"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="n">rvs_numpy</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">100</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&gt; SciPy
[ 2  1  1  2  4  1  2  9  2  1  2  6  4  1  1  1  1  1  6  1  1  1  5  1
  2  2  2  2  1  7  4  1  9  1  1  1  5  7  6  3  5  1  6  1  1  4  1  1
  6  5  3  1  5  9  5  3  3  4  1  2  2  1  3 14  1  4  1  2  6 13  1  2
  2  6  3  2  5  1  6  3  1  5 16  1  4  2  3  2  1  7  1  6  2  6  3  4
  4  3  3  6]
&gt; NumPy
[ 3  1  3  1  2  2  2  2  3  1  3  3  1  1  1  7  1  4  1  5  8  2  3  2
  1  3  2  5  3  1  3  7  3  1  3  5  1  4  1  1  1  1  8  4  3  1  3  4
  2  2  1  8  1  1  2 10  7  3  2  5  4  2  1  6  9  3  5  3  1  1  4  3
  8  2  2  1  1  5  1  1  7  3  9  3  6  1  1  1  2  6  1  3  2  3  1  1
  6  1  1  1]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 幾何分布の場合には乱数の分散が理想値からやや離れている (SciPy側のコードの確認が必要可能性がある).</span>
<span class="c1"># 期待値・分散の理論値</span>
<span class="n">exp_true</span> <span class="o">=</span> <span class="n">geom</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>
<span class="n">var_true</span> <span class="o">=</span> <span class="n">geom</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>

<span class="c1"># 擬似乱数から期待値・分散の計算</span>
<span class="n">exp_rvs</span><span class="p">,</span> <span class="n">var_rvs</span> <span class="o">=</span> <span class="n">calculate_stats</span><span class="p">(</span><span class="n">rvs</span><span class="p">)</span>

<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="s2">"&gt; SciPy"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="sa">f</span><span class="s2">"期待値(乱数 vs 真値): </span><span class="si">{</span><span class="n">exp_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">exp_true</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="sa">f</span><span class="s2">"分散(乱数 vs 真値): </span><span class="si">{</span><span class="n">var_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">var_true</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

<span class="n">exp_rvs</span><span class="p">,</span> <span class="n">var_rvs</span> <span class="o">=</span> <span class="n">calculate_stats</span><span class="p">(</span><span class="n">rvs_numpy</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="s2">"&gt; NumPy"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="sa">f</span><span class="s2">"期待値(乱数 vs 真値): </span><span class="si">{</span><span class="n">exp_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">exp_true</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="sa">f</span><span class="s2">"分散(乱数 vs 真値): </span><span class="si">{</span><span class="n">var_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">var_true</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&gt; SciPy
期待値(乱数 vs 真値): 3.3714 vs 3.3333333333333335
分散(乱数 vs 真値): 8.19786204 vs 7.777777777777779
&gt; NumPy
期待値(乱数 vs 真値): 3.3007 vs 3.3333333333333335
分散(乱数 vs 真値): 7.4182795100000005 vs 7.777777777777779
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 確率変数 x を渡すことで, それぞれに対応する確率質量関数の値を取得できる.</span>
<span class="n">rvs_max</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#max" title="max"><span class="nb">max</span></a><span class="p">(</span><span class="n">rvs</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">rvs_numpy</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">rvs_max</span> <span class="o">+</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">geom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>

<span class="c1"># 擬似乱数によるヒストグラムと確率質量関数の値を図示.</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span>
    <span class="p">[</span><span class="n">rvs</span><span class="p">,</span> <span class="n">rvs_numpy</span><span class="p">],</span>
    <span class="n">bins</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
    <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="s2">"blue"</span><span class="p">,</span> <span class="s2">"green"</span><span class="p">],</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="p">[</span><span class="s2">"SciPy"</span><span class="p">,</span> <span class="s2">"NumPy"</span><span class="p">],</span>
<span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"PMF"</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">"red"</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Geometrix Distribution (p = </span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s2">)"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, 'Geometrix Distribution (p = 0.3)')
</pre></div>
</div>
<img alt="../../_images/dist_43_1.png" src="../../_images/dist_43_1.png"/>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># p を動かした時の波形の違い.</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

<span class="n">ps</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.20</span><span class="p">,</span> <span class="mf">0.30</span><span class="p">,</span> <span class="mf">0.40</span><span class="p">,</span> <span class="mf">0.50</span><span class="p">,</span> <span class="mf">0.60</span><span class="p">]</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">ps</span><span class="p">:</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">geom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>
    <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"p = </span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s2">"</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x128959f30&gt;
</pre></div>
</div>
<img alt="../../_images/dist_44_1.png" src="../../_images/dist_44_1.png"/>
</div>
</div>
</section>
<section id="id22">
<h4>ユースケース<a class="headerlink" href="#id22" title="Permalink to this headline">#</a></h4>
<ul class="simple">
<li><p>1年について確率 <span class="math notranslate nohighlight">\(p\)</span> で起こる災害が <span class="math notranslate nohighlight">\(x\)</span> 年以内に発生する分布として捕捉.</p></li>
</ul>
</section>
</section>
<section id="id23">
<h3>例 2.5 (負の二項分布)<a class="headerlink" href="#id23" title="Permalink to this headline">#</a></h3>
<p><strong>負の二項分布</strong> (negative binomial distribution) は幾何分布を一般化されたものであり, <span class="math notranslate nohighlight">\(n\)</span> 回目の成功を得るまでの失敗の回数を <span class="math notranslate nohighlight">\(x\)</span> とした時の確率分布である.</p>
<section id="id24">
<h4>確率質量関数<a class="headerlink" href="#id24" title="Permalink to this headline">#</a></h4>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p><span class="math notranslate nohighlight">\(x = 0, 1, \cdots\)</span> とする.</p>
<div class="math notranslate nohighlight">
\[
    f(x) = {}_{n+x-1}{\rm C}_{x} p^n q^x
\]</div>
</div>
<p><span class="math notranslate nohighlight">\(n=1\)</span> の時に幾何分布となる. ちなみに, 二項分布で二項係数に負も認めれば負の二項分布が求められるため, この名称となっている.<br/>
　ここで<a class="reference internal" href="rvs.html#discrete-distribution"><span class="std std-ref">離散型の確率分布の性質</span></a>を確認する.</p>
<p>確率質量関数の定義から <span class="math notranslate nohighlight">\(f(x) \geq 0\)</span> であることは自明. また確率質量関数の和が 1 となることについては, 負の二項展開式について考えるとすぐに導出できる. <span class="math notranslate nohighlight">\(n \in \mathbb{N}\)</span>, <span class="math notranslate nohighlight">\(r\)</span> <span class="math notranslate nohighlight">\((0 \leq r \leq n, r \in \mathbb{N})\)</span> として</p>
<div class="math notranslate nohighlight">
\[
    (1 + t)^{-n} = \sum_{x=0}^{n}{{}_{-n}{\rm C}_{x}t^x}
\]</div>
<p>とかけ,</p>
<div class="math notranslate nohighlight">
\[
    {}_{-n}{\rm C}_{x} = (-1)^x {}_{n+x-1}{\rm C}_{x}
\]</div>
<p>と表せる.
　<span class="math notranslate nohighlight">\(t = -(1-p)\)</span> として</p>
<div class="math notranslate nohighlight">
\[
    \frac{1}{p^n} = {1 -(1-p)}^{-n} = \sum_{x=0}^{\infty}{{}_{-n}{\rm C}_{x}(-(1-p))^x} = \sum_{x=0}^{\infty}{{}_{n+x-1}{\rm C}_{x}(1-p)^x}
\]</div>
<p>となるので, <span class="math notranslate nohighlight">\(q = 1 - p\)</span> であり上式に <span class="math notranslate nohighlight">\(p^n\)</span> をかけて</p>
<div class="math notranslate nohighlight">
\[
    \sum_{x=0}^{\infty}{{}_{n+x-1}{\rm C}_{x}p^n q^x} = 1
\]</div>
<p>となる.</p>
</section>
<section id="id25">
<h4>期待値と分散<a class="headerlink" href="#id25" title="Permalink to this headline">#</a></h4>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        &amp; {\rm E}(X) = \frac{nq}{p} \\
        &amp; {\rm Var}(X) = \frac{nq}{p^2}
    \end{align}
\end{split}\]</div>
</div>
<p><u>証明</u><br/>
　<a class="reference internal" href="rvs.html#expectation"><span class="std std-ref">期待値の定義</span></a>より</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm E}(X) &amp;= \sum_{x=0}^{\infty}{x {}_{ n+x-1 }{\rm C}_{ x } p^n q^x } \\
                   &amp;= \sum_{x=1}^{\infty}{x \frac{ (n+x-1)! }{ (n-1)! x! } p^n q^x } \\
                   &amp;= \sum_{x=1}^{\infty}{ \frac{ (n+x-1)! }{ (n-1)! (x-1)! } p^n q^x }
    \end{align}
\end{split}\]</div>
<p>ここで <span class="math notranslate nohighlight">\(y = x - 1\)</span>, <span class="math notranslate nohighlight">\(N = n + 1\)</span> と置換すると</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm E}(X) &amp;= \sum_{y=0}^{\infty}{ \frac{ (y + N -1)! }{ ( N-2 )! y! } p^{ N-1 } q^{ y+1 } } \\
                   &amp;= \frac{ q }{ p }(N-1) \sum_{y=0}^{\infty}{ \frac{ (y + N -1 )! }{ ( N-1 )! y! } p^{ N } q^{ y } } \\
                   &amp;= \frac{ q }{ p }(N-1) \\
                   &amp;= \frac{nq}{p}
    \end{align}
\end{split}\]</div>
<p>と求められる. また分散について<a class="reference internal" href="rvs.html#expect-variance"><span class="std std-ref">分散と期待値の関係式</span></a>から</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm Var}(X) &amp;= {\rm}E(X^2) - ({\rm E}(X))^2 \\
                     &amp;= {\rm}E(X(X-1)+X) - ({\rm E}(X))^2 \\
                     &amp;= {\rm}E(X(X-1)) + {\rm}E(X) - ({\rm E}(X))^2
    \end{align}
\end{split}\]</div>
<p>第 2 式から弟 3 式への変換は<a class="reference internal" href="rvs.html#expectation-property"><span class="std std-ref">期待値の4番目の性質</span></a>を用いている.<br/>
　<span class="math notranslate nohighlight">\({\rm}E(X(X-1))\)</span> を求めれば分散が求められるので,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm E}(X(X-1)) &amp;= \sum_{x=0}^{\infty}{ x(x-1) {}_{ n+x-1 }{\rm C}_{ x } p^n q^x } \\
                        &amp;= \sum_{x=1}^{\infty}{ x(x-1) \frac{ (n+x-1)! }{ (n-1)! x! } p^n q^x } \\
                        &amp;= \sum_{x=2}^{\infty}{ \frac{ (n+x-1)! }{ (n-1)! (x-2)! } p^n q^x }
    \end{align}
\end{split}\]</div>
<p>となる. ここで <span class="math notranslate nohighlight">\(y = x - 2\)</span>, <span class="math notranslate nohighlight">\(N = n + 2\)</span> と置換すると</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm E}(X(X-1)) &amp;= \sum_{y=0}^{\infty}{ \frac{ (N + y - 1)! }{ (N - 3)! y! } p^{N - 2} q^{y + 2} } \\
                        &amp;= \frac{q^2}{p^2}(N-1)(N-2) \sum_{y=0}^{\infty}{ \frac{ (N+y-1)! }{ (N-1)! y! } p^{N} q^{y} } \\
                        &amp;= \frac{q^2}{p^2}(N-1)(N-2) \\
                        &amp;= \frac{q^2}{p^2}n(n + 1)
    \end{align}
\end{split}\]</div>
<p>となり分散は</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm Var}(X) &amp;= {\rm}E(X(X-1)) + {\rm}E(X) - ({\rm E}(X))^2 \\
                     &amp;= \frac{q^2}{p^2}n(n + 1) + \frac{nq}{p} - \frac{n^2 q^2}{p^2} \\
                     &amp;= \frac{nq}{p^2}
    \end{align}
\end{split}\]</div>
<p>と分かる.</p>
</section>
<section id="python-example-nbinom">
<span id="id26"></span><h4>Python での確認<a class="headerlink" href="#python-example-nbinom" title="Permalink to this headline">#</a></h4>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.nbinom.html#scipy.stats.nbinom">SciPy ( <code class="docutils literal notranslate"><span class="pre">scipy.stats.nbinom</span></code> )</a></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> : 成功回数 <span class="math notranslate nohighlight">\(n\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> : 成功確率 <span class="math notranslate nohighlight">\(p\)</span>.</p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.Generator.negative_binomial.html">NumPy ( <code class="docutils literal notranslate"><span class="pre">numpy.random.Generator.negative_binomial</span></code> )</a></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> : 成功回数 <span class="math notranslate nohighlight">\(n\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> : 成功確率 <span class="math notranslate nohighlight">\(p\)</span>.</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 成功確率 p = 0.20 の事象において n = 4 回成功するまでの失敗回数に関する負の二項分布に従った疑似乱数を size = 10000 だけ生成する.</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">p</span> <span class="o">=</span> <span class="mf">0.20</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">10000</span>

<span class="c1"># SciPy</span>
<span class="n">rvs</span> <span class="o">=</span> <span class="n">nbinom</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="s2">"&gt; SciPy"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="n">rvs</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">100</span><span class="p">])</span>

<span class="c1"># NumPy</span>
<span class="n">rvs_numpy</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">negative_binomial</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="s2">"&gt; NumPy"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="n">rvs_numpy</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">100</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&gt; SciPy
[15 12  3 14  5 15 19 32 18  4 21 27  9 11 22  8 11 17 11 14 15  5 13 19
 11 17 11 27  8 19 31 19 21 21  6 26 11 11  7 22 23 13  4 29 21 10 14 13
 15 35 30 14 16 11 28 26 18 16 22  9 10 28 25 31 33 22 16 22 10 27 30 14
 12 16 19  4 17  7 33 15 10 11 20 10 17 10 24  7  3  9 11 19 18  8 26  8
  9 21 10 12]
&gt; NumPy
[19 34 25  3  8 16 18 12 44 10  5 26 11 16 28 12  6 14  6 19 23 14  3 23
 22 15 16 14 10 29  6 20 16  5 25  5 10 10 21  9  9 21 25 29 13 22  4 21
  6 15 22 12 18 17 18 14 33 12  6 25 38 17 15  2 16 14 20  3 10  8 19 14
 33 14  5 16 62 22 16 53 10 43 23 34 17 12  8  3 17 19 12  0 19 38 12 24
 10 13  9  6]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 負の二項分布の場合は NumPy の乱理想値からやや離れている.</span>
<span class="c1"># 期待値・分散の理論値</span>
<span class="n">exp_true</span> <span class="o">=</span> <span class="n">nbinom</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>
<span class="n">var_true</span> <span class="o">=</span> <span class="n">nbinom</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>

<span class="c1"># 擬似乱数から期待値・分散の計算</span>
<span class="n">exp_rvs</span><span class="p">,</span> <span class="n">var_rvs</span> <span class="o">=</span> <span class="n">calculate_stats</span><span class="p">(</span><span class="n">rvs</span><span class="p">)</span>

<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="s2">"&gt; SciPy"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="sa">f</span><span class="s2">"期待値(乱数 vs 真値): </span><span class="si">{</span><span class="n">exp_rvs</span><span class="si">}</span><span class="s2"> vs｜ </span><span class="si">{</span><span class="n">exp_true</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="sa">f</span><span class="s2">"分散(乱数 vs 真値): </span><span class="si">{</span><span class="n">var_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">var_true</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

<span class="n">exp_rvs</span><span class="p">,</span> <span class="n">var_rvs</span> <span class="o">=</span> <span class="n">calculate_stats</span><span class="p">(</span><span class="n">rvs_numpy</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="s2">"&gt; NumPy"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="sa">f</span><span class="s2">"期待値(乱数 vs 真値): </span><span class="si">{</span><span class="n">exp_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">exp_true</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="sa">f</span><span class="s2">"分散(乱数 vs 真値): </span><span class="si">{</span><span class="n">var_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">var_true</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&gt; SciPy
期待値(乱数 vs 真値): 15.929 vs｜ 16.0
分散(乱数 vs 真値): 80.167559 vs 79.99999999999999
&gt; NumPy
期待値(乱数 vs 真値): 16.0454 vs 16.0
分散(乱数 vs 真値): 82.54973884 vs 79.99999999999999
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 確率変数 x を渡すことで, それぞれに対応する確率質量関数の値を取得できる.</span>
<span class="n">rvs_max</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#max" title="max"><span class="nb">max</span></a><span class="p">(</span><span class="n">rvs</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">rvs_numpy</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">rvs_max</span> <span class="o">+</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">nbinom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>

<span class="c1"># 擬似乱数によるヒストグラムと確率質量関数の値を図示.</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span>
    <span class="p">[</span><span class="n">rvs</span><span class="p">,</span> <span class="n">rvs_numpy</span><span class="p">],</span>
    <span class="n">bins</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
    <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="s2">"blue"</span><span class="p">,</span> <span class="s2">"green"</span><span class="p">],</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="p">[</span><span class="s2">"SciPy"</span><span class="p">,</span> <span class="s2">"NumPy"</span><span class="p">],</span>
<span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"PMF"</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">"red"</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Negative Binomial Distribution (n = </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">, p = </span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s2">)"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, 'Negative Binomial Distribution (n = 4, p = 0.2)')
</pre></div>
</div>
<img alt="../../_images/dist_52_1.png" src="../../_images/dist_52_1.png"/>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># n = 4 で固定し p のみを動かした時の波形の違い.</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

<span class="n">ps</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.10</span><span class="p">,</span> <span class="mf">0.20</span><span class="p">,</span> <span class="mf">0.40</span><span class="p">,</span> <span class="mf">0.80</span><span class="p">]</span>
<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">ps</span><span class="p">:</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">nbinom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>
    <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"p = </span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s2">"</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x126f3d000&gt;
</pre></div>
</div>
<img alt="../../_images/dist_53_1.png" src="../../_images/dist_53_1.png"/>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># p = 0.2 で固定し n のみを動かした時の波形の違い.</span>
<span class="n">p</span> <span class="o">=</span> <span class="mf">0.2</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax3</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

<span class="n">ns</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">30</span><span class="p">]</span>

<span class="c1"># x 軸設定</span>
<span class="c1"># ns 最大の時の乱数を生成し, その最大値をもとに x 軸の行列を作成.</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">nbinom</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#max" title="max"><span class="nb">max</span></a><span class="p">(</span><span class="n">ns</span><span class="p">),</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">ns</span><span class="p">:</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">nbinom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>
    <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"n = </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">"</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>

<span class="n">ax3</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x127d3f0a0&gt;
</pre></div>
</div>
<img alt="../../_images/dist_54_1.png" src="../../_images/dist_54_1.png"/>
</div>
</div>
</section>
<section id="id27">
<h4>ユースケース<a class="headerlink" href="#id27" title="Permalink to this headline">#</a></h4>
<ul class="simple">
<li><p>購入頻度が負の二項分布に従う (<a class="reference external" href="https://qiita.com/nijigen_plot/items/9570487b73ad01fff36b">購買回数の分布と負の二項分布の関係</a>).</p></li>
</ul>
</section>
</section>
</section>
<section id="id28">
<h2>3. 連続型の確率分布<a class="headerlink" href="#id28" title="Permalink to this headline">#</a></h2>
<section id="id29">
<h3>例 3.1 (一様分布)<a class="headerlink" href="#id29" title="Permalink to this headline">#</a></h3>
<section id="id30">
<h4>確率密度関数<a class="headerlink" href="#id30" title="Permalink to this headline">#</a></h4>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p><strong>一様分布</strong> (uniform distribution) は <span class="math notranslate nohighlight">\(a &lt; b\)</span> とした時に以下の確率密度関数で表現される確率分布のことを指す.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        f(x) = \begin{cases}
            \dfrac{1}{b-a} &amp; (a \leq x \leq b) \\
            0             &amp; (x &lt; a, b &lt; x)
        \end{cases}
    \end{align}
\end{split}\]</div>
</div>
<p>ここで<a class="reference internal" href="rvs.html#continuous-distribution"><span class="std std-ref">連続型の確率分布の性質</span></a>を確認する.<br/>
　確率密度関数の定義から <span class="math notranslate nohighlight">\(f(x) \geq 0\)</span> であることは自明. また, 以下の計算から</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        \int_{- \infty}^{\infty}{f(x)dx} &amp;= \int_{- \infty}^{a}{0 \cdot dx} + \int_{- \infty}^{\infty}{\frac{dx}{b-a}} + \int_{b}^{\infty}{0 \cdot dx} \\
                                         &amp;= \biggl[ \frac{x}{b-a} \biggr]_{a}^{b} \\
                                         &amp;= \frac{b}{b-a} - \frac{a}{b-a} = 1.
    \end{align}
\end{split}\]</div>
</section>
<section id="id31">
<h4>期待値と分散<a class="headerlink" href="#id31" title="Permalink to this headline">#</a></h4>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        &amp; {\rm E}(X) = \frac{a + b}{2} \\
        &amp; {\rm Var}(X) = \frac{(b-a)^2}{12}
    \end{align}
\end{split}\]</div>
</div>
<p><u>証明</u><br/>
　<a class="reference internal" href="rvs.html#expectation"><span class="std std-ref">期待値の定義</span></a>より</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm E}(X) &amp;= \int_{ a }^{ b }{ \frac{x}{b-a}dx } \\
                   &amp;= \biggl[ \frac{x^2}{2(b-a)} \biggr]_{a}^{b} \\
                   &amp;= \frac{1}{2(b-a)}(b^2 - a^2) \\
                   &amp;= \frac{(b+a)(b-a)}{2(b-a)} = \frac{a + b}{2}
    \end{align}
\end{split}\]</div>
<p>と求められる. また分散について<a class="reference internal" href="rvs.html#expect-variance"><span class="std std-ref">分散と期待値の関係式</span></a>から <span class="math notranslate nohighlight">\({\rm E}(X^2)\)</span> を求めればよい.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm E}(X^2) &amp;= \int_{ a }^{ b }{ \frac{x^2}{b-a}dx } \\
                   &amp;= \biggl[ \frac{x^x}{3(b-a)} \biggr]_{a}^{b} \\
                   &amp;= \frac{1}{x(b-a)}(b^3 - a^3) \\
                   &amp;= \frac{(b^2 + ab + a^2)(b-a)()}{3(b-a)} = \frac{a^2 + ab + b^2}{3}
    \end{align}
\end{split}\]</div>
<p>よって</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm Var}(X) &amp;= {\rm}E(X^2) - ({\rm E}(X))^2 \\
                     &amp;= \frac{a^2 + ab + b^2}{3} - \frac{(a + b)^2}{4} \\
                     &amp;= \frac{(b-a)^2}{12}
    \end{align}
\end{split}\]</div>
</section>
<section id="python-example-uniform">
<span id="id32"></span><h4>Python での確認<a class="headerlink" href="#python-example-uniform" title="Permalink to this headline">#</a></h4>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.uniform.html#scipy.stats.uniform">SciPy ( <code class="docutils literal notranslate"><span class="pre">scipy.stats.uniform</span></code> )</a></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">loc</span></code> : <span class="math notranslate nohighlight">\(a\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">scale</span></code> : <span class="math notranslate nohighlight">\(b - a\)</span></p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.Generator.uniform.html">NumPy ( <code class="docutils literal notranslate"><span class="pre">numpy.random.Generator.uniform</span></code> )</a></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">low</span></code> : <span class="math notranslate nohighlight">\(a\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">high</span></code> : <span class="math notranslate nohighlight">\(b\)</span></p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 区間 [3, 8] に関する一様分布に従った疑似乱数を size = 10000 だけ生成.</span>
<span class="n">a</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">b</span> <span class="o">=</span> <span class="mi">8</span>

<span class="n">loc</span> <span class="o">=</span> <span class="n">a</span>
<span class="n">scale</span> <span class="o">=</span> <span class="n">b</span> <span class="o">-</span> <span class="n">a</span>
<span class="n">low</span> <span class="o">=</span> <span class="n">a</span>
<span class="n">high</span> <span class="o">=</span> <span class="n">b</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">10000</span>

<span class="c1"># SciPy</span>
<span class="n">rvs</span> <span class="o">=</span> <span class="n">uniform</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="s2">"&gt; SciPy"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="n">rvs</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">20</span><span class="p">])</span>

<span class="c1"># NumPy</span>
<span class="n">rvs_numpy</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="n">low</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="n">high</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="s2">"&gt; NumPy"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="n">rvs_numpy</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">20</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&gt; SciPy
[3.75843393 6.59998926 5.79577119 5.16210093 4.05742917 7.64219607
 5.82097128 4.546907   3.5121066  6.61254131 5.07530536 3.74150033
 4.08594648 5.99744444 7.56967911 6.23403422 5.50281702 4.10875559
 5.91974928 4.79386684]
&gt; NumPy
[7.22090427 4.98426609 7.55452031 3.1926514  6.32169067 4.0104301
 7.9795091  4.4106398  7.99999312 3.92861151 6.61590431 5.92276641
 5.46060353 7.87279737 5.88647738 3.32982649 4.38343301 3.95296044
 7.59929556 7.11639124]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 期待値・分散の理論値</span>
<span class="n">exp_true</span> <span class="o">=</span> <span class="n">uniform</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>
<span class="n">var_true</span> <span class="o">=</span> <span class="n">uniform</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>

<span class="c1"># 擬似乱数から期待値・分散の計算</span>
<span class="n">exp_rvs</span><span class="p">,</span> <span class="n">var_rvs</span> <span class="o">=</span> <span class="n">calculate_stats</span><span class="p">(</span><span class="n">rvs</span><span class="p">)</span>

<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="s2">"&gt; SciPy"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="sa">f</span><span class="s2">"期待値(乱数 vs 真値): </span><span class="si">{</span><span class="n">exp_rvs</span><span class="si">}</span><span class="s2"> vs｜ </span><span class="si">{</span><span class="n">exp_true</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="sa">f</span><span class="s2">"分散(乱数 vs 真値): </span><span class="si">{</span><span class="n">var_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">var_true</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

<span class="n">exp_rvs</span><span class="p">,</span> <span class="n">var_rvs</span> <span class="o">=</span> <span class="n">calculate_stats</span><span class="p">(</span><span class="n">rvs_numpy</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="s2">"&gt; NumPy"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="sa">f</span><span class="s2">"期待値(乱数 vs 真値): </span><span class="si">{</span><span class="n">exp_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">exp_true</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="sa">f</span><span class="s2">"分散(乱数 vs 真値): </span><span class="si">{</span><span class="n">var_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">var_true</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&gt; SciPy
期待値(乱数 vs 真値): 5.490774606667145 vs｜ 5.5
分散(乱数 vs 真値): 2.07764450286235 vs 2.083333333333333
&gt; NumPy
期待値(乱数 vs 真値): 5.500166337412839 vs 5.5
分散(乱数 vs 真値): 2.0828626544358886 vs 2.083333333333333
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 確率変数 x を渡すことで, それぞれに対応する確率密度関数の値を取得できる.</span>
<span class="n">rvs_max</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#max" title="max"><span class="nb">max</span></a><span class="p">(</span><span class="n">rvs</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">rvs_numpy</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="n">rvs_min</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#min" title="min"><span class="nb">min</span></a><span class="p">(</span><span class="n">rvs</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">rvs_numpy</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">rvs_min</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="n">rvs_max</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">uniform</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>

<span class="c1"># 擬似乱数によるヒストグラムと確率密度関数の値を図示.</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span>
    <span class="p">[</span><span class="n">rvs</span><span class="p">,</span> <span class="n">rvs_numpy</span><span class="p">],</span>
    <span class="n">bins</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
    <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="s2">"blue"</span><span class="p">,</span> <span class="s2">"green"</span><span class="p">],</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="p">[</span><span class="s2">"SciPy"</span><span class="p">,</span> <span class="s2">"NumPy"</span><span class="p">],</span>
<span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"PDF"</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">"red"</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Uniform Distribution [</span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">b</span><span class="si">}</span><span class="s2">]"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, 'Uniform Distribution [3, 8]')
</pre></div>
</div>
<img alt="../../_images/dist_63_1.png" src="../../_images/dist_63_1.png"/>
</div>
</div>
</section>
<section id="id33">
<h4>ユースケース<a class="headerlink" href="#id33" title="Permalink to this headline">#</a></h4>
<ul class="simple">
<li><p>一様分布の擬似乱数をもとに他の分布の擬似乱数を生成</p></li>
<li><p>モンテカルロシミュレーションの初期値として一様分布疑似乱数を使用</p></li>
</ul>
</section>
</section>
<section id="normal-distribution">
<span id="id34"></span><h3>例 3.2 (正規分布)<a class="headerlink" href="#normal-distribution" title="Permalink to this headline">#</a></h3>
<section id="id35">
<h4>確率密度関数<a class="headerlink" href="#id35" title="Permalink to this headline">#</a></h4>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p><strong>正規分布</strong> (normal distribution, ガウス分布 &lt;Gaussian distribution&gt;ともいう) はパラメータ <span class="math notranslate nohighlight">\(\mu \geq 0, \sigma \gt 0\)</span> を用いて以下の確率密度関数をもつ分布. 後ほど証明するが, <span class="math notranslate nohighlight">\(\mu\)</span> は期待値, <span class="math notranslate nohighlight">\(\sigma^2\)</span> は分散となる.</p>
<div class="math notranslate nohighlight">
\[
    f(x) = \frac{1}{\sqrt{2\pi} \sigma} \exp{ \biggl( - \frac{(x -\mu)^2}{2 \sigma^2} \biggr) }
\]</div>
</div>
<p>ここで<a class="reference internal" href="rvs.html#continuous-distribution"><span class="std std-ref">連続型の確率分布の性質</span></a>を確認する.<br/>
　確率密度関数の定義から <span class="math notranslate nohighlight">\(f(x) \geq 0\)</span> であることは自明. また, <span class="math notranslate nohighlight">\(y = x - \mu\)</span> とすると, <span class="math notranslate nohighlight">\(dy = dx\)</span> で以下の計算のようになる.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        \int_{- \infty}^{\infty}{f(x)dx} &amp;= \frac{1}{\sqrt{2\pi} \sigma} \int_{- \infty}^{ \infty }{ \exp{ \biggl( - \frac{(x -\mu)^2}{2 \sigma^2} \biggr) } dx} \\
                                         &amp;= \frac{1}{\sqrt{2\pi} \sigma} \underline{ \int_{- \infty}^{ \infty }{ \exp{ \biggl( - \frac{ y^2 }{2 \sigma^2} \biggr) } dy} } \\
                                         &amp;= \frac{1}{\sqrt{2\pi} \sigma} \cdot \sqrt{2\pi} \sigma \\
                                         &amp;= 1.
    \end{align}
\end{split}\]</div>
<p>上記の下線部分は以下の<a class="reference internal" href="#gaussian-integral"><span class="std std-ref">ガウス積分</span></a>の結果を利用している.</p>
</section>
<section id="id36">
<h4>命題 3.2.1 (ガウス積分)<a class="headerlink" href="#id36" title="Permalink to this headline">#</a></h4>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<div class="math notranslate nohighlight" id="gaussian-integral">
\[
    \begin{align}
        I = \int_{- \infty}^{\infty}{ e^{-ax^2}dx } &amp;= \sqrt{\frac{\pi}{a}} \quad (a &gt; 0)
    \end{align}
\]</div>
</div>
<p><u>証明</u></p>
<p>これは以下の計算から分かる.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        I^2 &amp;= \int_{- \infty}^{\infty}{ e^{-ax^2}dx } \int_{- \infty}^{\infty}{ e^{-ay^2}dy } \\
            &amp;= \int_{- \infty}^{\infty}{ \int_{- \infty}^{\infty}{ e^{ -a(x^2 + y^2) }dxdy } }
    \end{align}
\end{split}\]</div>
<p>ここで <span class="math notranslate nohighlight">\(x = r\cos {\theta}\)</span>, <span class="math notranslate nohighlight">\(y = r\sin {\theta}\)</span> と置換すると, ヤコビアンは <span class="math notranslate nohighlight">\(r\)</span> より <span class="math notranslate nohighlight">\(dxdy = rdrd\theta\)</span> で, <span class="math notranslate nohighlight">\(\theta: 0 \rightarrow 2\pi\)</span>, <span class="math notranslate nohighlight">\(r: 0 \rightarrow \infty\)</span> より</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        I^2 &amp;= \int_{ 0 }^{ \infty }{ \int_{ 0 }^{ 2\pi }{ e^{ -ar^2 }rdrd\theta } } \\
            &amp;= 2 \pi \int_{ 0 }^{ \infty }{ e^{ -ar^2 }rdr  } \\
            &amp;= 2 \pi \biggl[ \frac{e^{-ar^2}}{-2a} \biggr]_{0}^{\infty} = \frac{\pi}{a}
    \end{align}
\end{split}\]</div>
<p>よって,</p>
<div class="math notranslate nohighlight">
\[
    \begin{align}
        I = \sqrt{\frac{\pi}{a}} \quad
    \end{align}
\]</div>
</section>
<section id="id37">
<h4>期待値と分散<a class="headerlink" href="#id37" title="Permalink to this headline">#</a></h4>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        &amp; {\rm E}(X) = \mu \\
        &amp; {\rm Var}(X) = \sigma^2
    \end{align}
\end{split}\]</div>
</div>
<p><u>証明</u><br/>
　<a class="reference internal" href="rvs.html#expectation"><span class="std std-ref">期待値の定義</span></a>より</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm E}(X) &amp;= \int_{ -\infty }^{ \infty }{ x \frac{1}{\sqrt{2\pi} \sigma} \exp{ \biggl( - \frac{(x -\mu)^2}{2 \sigma^2} \biggr) }dx } \\
                   &amp;= \int_{ -\infty }^{ \infty }{ \frac{1}{\sqrt{2\pi} \sigma} (\sigma y + \mu) \exp{ \biggl( - \frac{ y^2 }{2} \biggr) } \sigma dy } \quad (x-\mu=\sigma y) \\
                   &amp;= \frac{\sigma}{\sqrt{2 \pi}} \int_{ -\infty }^{ \infty }{ y \exp{\biggl( -\frac{y^2}{2} \biggr)} dy } + \frac{\mu}{\sqrt{2 \pi}} \int_{ -\infty }^{ \infty }{ \exp{\biggl( -\frac{y^2}{2} \biggr)} dy } \\
                   &amp;= \frac{\mu}{\sqrt{2 \pi}} \cdot \sqrt{2 \pi} = \mu
    \end{align}
\end{split}\]</div>
<p>と求められる. 第 1 項は奇関数のため 0 となる. また分散について<a class="reference internal" href="rvs.html#expect-variance"><span class="std std-ref">分散と期待値の関係式</span></a>から <span class="math notranslate nohighlight">\({\rm E}(X^2)\)</span> を求めればよい.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm E}(X^2) &amp;= \int_{ -\infty }^{ \infty }{ x^2 \frac{1}{\sqrt{2\pi} \sigma} \exp{ \biggl( - \frac{(x -\mu)^2}{2 \sigma^2} \biggr) }dx } \\
                     &amp;= \frac{\sigma}{\sqrt{2 \pi} \sigma} \int_{ -\infty }^{ \infty }{ (\sigma y + \mu)^2 \exp{ \biggl( - \frac{y^2}{2} \biggr) }\sigma dy } \quad (x-\mu=\sigma y) \\
                     &amp;= \frac{1}{\sqrt{2 \pi}} \int_{ -\infty }^{ \infty }{ (\sigma^2 y^2 + 2 \sigma \mu y +  \mu^2) \exp{ \biggl( - \frac{y^2}{2} \biggr) } dy } \\
                     &amp;= \frac{\sigma^2}{\sqrt{2 \pi}} \int_{ -\infty }^{ \infty }{ y^2 \exp{ \biggl( - \frac{y^2}{2} \biggr) } dy } + \frac{\mu^2}{\sqrt{2 \pi}} \int_{ -\infty }^{ \infty }{ \exp{ \biggl( - \frac{y^2}{2} \biggr) } dy } \quad (\text{奇関数については0}) \\
                     &amp;= \frac{\sigma^2}{\sqrt{2 \pi}} \biggl\{ \biggl[ -yr^{\frac{-y^2}{2}}\biggr]_{-\infty}^{\infty} + \int_{ -\infty }^{ \infty }{ \exp{ \biggl( - \frac{y^2}{2} \biggr) } dy } \biggr\} + \frac{\mu^2}{\sqrt{2 \pi}} \int_{ -\infty }^{ \infty }{ \exp{ \biggl( - \frac{y^2}{2} \biggr) } dy } \quad (\text{第1項は部分積分}) \\
                     &amp;= \frac{\sigma^2}{\sqrt{2 \pi}} (0 + \sqrt{2 \pi}) + \frac{\mu^2}{\sqrt{2 \pi}} \cdot \sqrt{2 \pi} = \sigma^2 + \mu^2
    \end{align}
\end{split}\]</div>
<p>よって</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm Var}(X) &amp;= {\rm}E(X^2) - ({\rm E}(X))^2 \\
                     &amp;= \sigma^2 + \mu^2 - \mu^2 \\
                     &amp;= \sigma^2
    \end{align}
\end{split}\]</div>
</section>
<section id="python-example-normal">
<span id="id38"></span><h4>Python での確認<a class="headerlink" href="#python-example-normal" title="Permalink to this headline">#</a></h4>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.norm.html#scipy.stats.norm">SciPy ( <code class="docutils literal notranslate"><span class="pre">scipy.stats.norm</span></code> )</a></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">loc</span></code> : 期待値 <span class="math notranslate nohighlight">\(\mu\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">scale</span></code> : 標準偏差 <span class="math notranslate nohighlight">\(\sigma\)</span>.</p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.Generator.normal.html">NumPy ( <code class="docutils literal notranslate"><span class="pre">numpy.random.Generator.normmal</span></code> )</a></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">loc</span></code> : 期待値 <span class="math notranslate nohighlight">\(\mu\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">scale</span></code> : 標準偏差 <span class="math notranslate nohighlight">\(\sigma\)</span>.</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># loc = 10, scale = 2 に関する正規分布に従った疑似乱数を size = 10000 だけ生成する.</span>
<span class="n">loc</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">scale</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">10000</span>

<span class="c1"># SciPy</span>
<span class="n">rvs</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="s2">"&gt; SciPy"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="n">rvs</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">20</span><span class="p">])</span>

<span class="c1"># NumPy</span>
<span class="n">rvs_numpy</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="s2">"&gt; NumPy"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="n">rvs_numpy</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">20</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&gt; SciPy
[ 8.95353858  6.1612591  13.1668338  12.32073863  9.68621154  7.21122577
 10.17107731  7.21271022 10.93265927 11.04653432 11.84003385 11.11752755
 12.75331174  8.22744887  9.11020875  8.14469788 13.02858057 10.40541213
  8.55083475 10.04265609]
&gt; NumPy
[ 8.70461874 11.39812729  8.50115066 10.33695154 10.55931471  9.32878914
  9.00163263 13.17880852 10.83535446 13.12140641  9.68146009  7.14082452
 11.13919738 10.15912164 10.97671707  9.2598795   8.10412987 10.77052253
  9.94839874  7.1912721 ]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 期待値・分散の理論値</span>
<span class="n">exp_true</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>
<span class="n">var_true</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>

<span class="c1"># 擬似乱数から期待値・分散の計算</span>
<span class="n">exp_rvs</span><span class="p">,</span> <span class="n">var_rvs</span> <span class="o">=</span> <span class="n">calculate_stats</span><span class="p">(</span><span class="n">rvs</span><span class="p">)</span>

<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="s2">"&gt; SciPy"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="sa">f</span><span class="s2">"期待値(乱数 vs 真値): </span><span class="si">{</span><span class="n">exp_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">exp_true</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="sa">f</span><span class="s2">"分散(乱数 vs 真値): </span><span class="si">{</span><span class="n">var_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">var_true</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

<span class="n">exp_rvs</span><span class="p">,</span> <span class="n">var_rvs</span> <span class="o">=</span> <span class="n">calculate_stats</span><span class="p">(</span><span class="n">rvs_numpy</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="s2">"&gt; NumPy"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="sa">f</span><span class="s2">"期待値(乱数 vs 真値): </span><span class="si">{</span><span class="n">exp_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">exp_true</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="sa">f</span><span class="s2">"分散(乱数 vs 真値): </span><span class="si">{</span><span class="n">var_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">var_true</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&gt; SciPy
期待値(乱数 vs 真値): 9.959527453921048 vs 10.0
分散(乱数 vs 真値): 3.981167894577839 vs 4.0
&gt; NumPy
期待値(乱数 vs 真値): 10.022351940478329 vs 10.0
分散(乱数 vs 真値): 3.992217287294061 vs 4.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 確率変数 x を渡すことで, それぞれに対応する確率密度関数の値を取得できる.</span>
<span class="n">rvs_max</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#max" title="max"><span class="nb">max</span></a><span class="p">(</span><span class="n">rvs</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">rvs_numpy</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="n">rvs_min</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#min" title="min"><span class="nb">min</span></a><span class="p">(</span><span class="n">rvs</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">rvs_numpy</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">rvs_min</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="n">rvs_max</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>

<span class="c1"># 擬似乱数によるヒストグラムと確率密度関数の値を図示.</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span>
    <span class="p">[</span><span class="n">rvs</span><span class="p">,</span> <span class="n">rvs_numpy</span><span class="p">],</span>
    <span class="n">bins</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
    <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="s2">"blue"</span><span class="p">,</span> <span class="s2">"green"</span><span class="p">],</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="p">[</span><span class="s2">"SciPy"</span><span class="p">,</span> <span class="s2">"NumPy"</span><span class="p">],</span>
<span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"PDF"</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">"red"</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Normal Distribution N(</span><span class="si">{</span><span class="n">loc</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">scale</span><span class="o">**</span><span class="mi">2</span><span class="si">}</span><span class="s2">)"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, 'Normal Distribution N(10, 4)')
</pre></div>
</div>
<img alt="../../_images/dist_72_1.png" src="../../_images/dist_72_1.png"/>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># loc = 10 で固定し scale のみを動かした時の波形の違い.</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

<span class="n">loc</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">scales</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">]</span>
<span class="k">for</span> <span class="n">scale</span> <span class="ow">in</span> <span class="n">scales</span><span class="p">:</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>
    <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"sigma = </span><span class="si">{</span><span class="n">scale</span><span class="si">}</span><span class="s2">"</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x1290b1ff0&gt;
</pre></div>
</div>
<img alt="../../_images/dist_73_1.png" src="../../_images/dist_73_1.png"/>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># scale = 2 で固定し loc のみを動かした時の波形の違い.</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax3</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

<span class="n">locs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">]</span>
<span class="n">scale</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span>
    <span class="n">norm</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#min" title="min"><span class="nb">min</span></a><span class="p">(</span><span class="n">locs</span><span class="p">),</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">norm</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#max" title="max"><span class="nb">max</span></a><span class="p">(</span><span class="n">locs</span><span class="p">),</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
    <span class="mf">0.05</span><span class="p">,</span>
<span class="p">)</span>
<span class="k">for</span> <span class="n">loc</span> <span class="ow">in</span> <span class="n">locs</span><span class="p">:</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>
    <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"mu = </span><span class="si">{</span><span class="n">loc</span><span class="si">}</span><span class="s2">"</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>

<span class="n">ax3</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x12908f9a0&gt;
</pre></div>
</div>
<img alt="../../_images/dist_74_1.png" src="../../_images/dist_74_1.png"/>
</div>
</div>
</section>
<section id="id39">
<h4>ユースケース<a class="headerlink" href="#id39" title="Permalink to this headline">#</a></h4>
<ul class="simple">
<li><p>工事中</p></li>
</ul>
</section>
<section id="id40">
<h4>定理 3.2.2 (中心極限定理)<a class="headerlink" href="#id40" title="Permalink to this headline">#</a></h4>
<p><strong>中心極限定理</strong> (central limit theorem) とは, いかなる確率分布でもその母集団から取り出した標本の平均値の分布は, 平均を計算する回数が大きくなるにつれて正規分布に近づくという定理. これを数学的に表現すると以下のように書ける.</p>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p>平均 <span class="math notranslate nohighlight">\(\mu\)</span>, 分散 <span class="math notranslate nohighlight">\(\sigma^2\)</span> の独立同分布の確率変数 <span class="math notranslate nohighlight">\(X_1, X_2, \cdots\)</span> に対して, <span class="math notranslate nohighlight">\(\overline{X}(n) = \frac{1}{n} \sum_{i=1}^{n}{X_i}\)</span> とおくと以下が成立する.</p>
<div class="math notranslate nohighlight">
\[
    \lim_{n \rightarrow \infty} {P \biggl(a \leq \frac{\overline{X}(n) - \mu}{\sigma / \sqrt{n}} \leq b \biggr)} = \int_{a}^{b}{ \frac{1}{\sqrt{2 \pi}} e^{-\frac{x^2}{2}} dx }
\]</div>
</div>
<p><u>証明</u></p>
<p><span class="math notranslate nohighlight">\(Y(n)\)</span> を以下のように定義する.</p>
<div class="math notranslate nohighlight">
\[
    Y(n) = \frac{\overline{X}(n) - \mu}{\sigma / \sqrt{n}}
\]</div>
<p>この時, <span class="math notranslate nohighlight">\(Y(n)\)</span> の積率母関数が <span class="math notranslate nohighlight">\(N(0,1)\)</span> の積率母関数に収束することを示せばよい.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        Y(n) &amp;= \frac{n\overline{X}(n) - n\mu}{\sigma \sqrt{n}} \\
             &amp;= \frac{ \sum_{i=1}^{n}{X_i} - \sum_{i=1}^{n}{\mu} }{\sigma \sqrt{n}} \\
             &amp;= \frac{1}{\sqrt{n}} \sum_{i=1}^{n}{ \frac{ X_i - \mu }{\sigma} }
    \end{align}
\end{split}\]</div>
<p>となるので, ここで確率変数 <span class="math notranslate nohighlight">\(Z_i = \dfrac{X_i - \mu}{\sigma}\)</span> を導入すると, <span class="math notranslate nohighlight">\(Z_i\)</span> は次の性質を示す.</p>
<div class="math notranslate nohighlight">
\[
    Y(n) = \frac{1}{\sqrt{n}} \sum_{i=1}^{n}{ Z_i } \quad {\rm E}(Z_i) = 0, \quad {\rm Var}(Z_i) = 1
\]</div>
<p><span class="math notranslate nohighlight">\(Y(n)\)</span> の積率母関数 <span class="math notranslate nohighlight">\(M_{Y(n)}(t)\)</span> は,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        M_{Y(n)}(t) &amp;= {\rm E}( \exp{ [ tY(n) ] } ) \\
                    &amp;= {\rm E}\biggl( \exp{ \biggl[ \frac{t}{\sqrt{n}} \sum_{i=1}^{n}{ Z_i } \biggr] } \biggr) \\
                    &amp;= {\rm E}\bigl( e^{\frac{t}{n}\sqrt{Z_1}} \times e^{\frac{t}{n}\sqrt{Z_2}} \times \cdots \times e^{\frac{t}{n}\sqrt{Z_n}} \bigr)
    \end{align}
\end{split}\]</div>
<p><span class="math notranslate nohighlight">\(X_1, X_2, \cdots\)</span> は互いに独立であり, その確率変数から定義された <span class="math notranslate nohighlight">\(Z_1, Z_2, \cdots\)</span> も互いに独立である. ゆえに上式は</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        M_{Y(n)}(t) &amp;= {\rm E}\bigl( e^{\frac{t}{n}\sqrt{Z_1}} \times e^{\frac{t}{n}\sqrt{Z_2}} \times \cdots \times e^{\frac{t}{n}\sqrt{Z_n}} \bigr) \\
                    &amp;= {\rm E}\bigl( e^{\frac{t}{n}\sqrt{Z_1}} \bigr) \times {\rm E}\bigl( e^{\frac{t}{n}\sqrt{Z_2}} \bigr) \times \cdots \times {\rm E}\bigl( e^{\frac{t}{n}\sqrt{Z_n}} \bigr)
    \end{align}
\end{split}\]</div>
<p>となる. また, <span class="math notranslate nohighlight">\(X_1, X_2, \cdots\)</span> は同じ確率分布であり, その確率変数から定義された <span class="math notranslate nohighlight">\(Z_1, Z_2, \cdots\)</span> も同じ確率分布なので上式はさらに</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        M_{Y(n)}(t) &amp;= \Bigl( {\rm E}\bigl( e^{\frac{t}{n}\sqrt{Z_1}} \bigr) \Bigr)^n \\
                    &amp;= \biggl( M_{Z_1} \biggl( \frac{t}{\sqrt{n}} \biggr) \biggr)^n \label{☆}\tag{☆}
    \end{align}
\end{split}\]</div>
<p>となり, <span class="math notranslate nohighlight">\(Z\)</span> の積率母関数の冪乗で表現できる. <span class="math notranslate nohighlight">\(M_{Z_1}(t)\)</span> に対してマクローリン展開を適応する.</p>
<div class="math notranslate nohighlight">
\[
    M_{Z_1}(t) = M_{Z_1}(0) + \left.\frac{dM_{Z_1}(t)}{dt}\right|_{t=0} t + \left.\frac{1}{2}\frac{d^2M_{Z_1}(t)}{dt^2}\right|_{t=0} t^2 + O(t^3)
\]</div>
<p>ここで,</p>
<div class="math notranslate nohighlight">
\[
    M_{Z_1}(0) = 1, \quad
    \left.\frac{dM_{Z_1}(t)}{dt}\right|_{t=0} = \mu_1 = {\rm E}(Z_1) = 0, \quad
    \left.\frac{1}{2}\frac{d^2M_{Z_1}(t)}{dt^2}\right|_{t=0} = \mu_2 = {\rm E}(X^2) = 1
\]</div>
<p>より <span class="math notranslate nohighlight">\(M_{Z_1}(t) = 1 + \dfrac{t^2}{2} + O(t^3)\)</span> である. よって</p>
<div class="math notranslate nohighlight">
\[
    M_{Z_1} \biggl( \frac{t}{\sqrt{n}} \biggr) = 1 + \frac{t^2}{2n} + O \biggl( \biggl( \frac{t}{\sqrt{n}} \biggr)^3 \biggr)
\]</div>
<p>なので, 式 <span class="math notranslate nohighlight">\((\ref{☆})\)</span> に代入すれば</p>
<div class="math notranslate nohighlight">
\[
    M_{Y_(n)} (t) = \biggl( 1 + \frac{t^2}{2n} + O \biggl( \biggl( \frac{t}{\sqrt{n}} \biggr)^3 \biggr) \biggr)^n.
\]</div>
<p>よって</p>
<div class="math notranslate nohighlight">
\[
    \lim_{n \rightarrow \infty}{M_{Y_(n)} (t)} = \lim_{n \rightarrow \infty}{ \biggl( 1 + \frac{t^2}{2n}  \biggr)^n } = e^{\frac{1}{2}t^2}
\]</div>
<p>これは <span class="math notranslate nohighlight">\(N(0,1)\)</span> の積率母関数と一致する.</p>
<p>python で中心極限定理を確認してみる.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ----------------------------------------------------------------------------------</span>
<span class="c1"># 一様分布に従う標本平均のサイズ数を増やすことで, 標本平均が正規分布に従うことの確認</span>
<span class="c1">#</span>
<span class="c1"># ** 1回の試行においてサンプル数を size で定義</span>
<span class="c1"># ** 標本平均のサイズ数については trials_list で徐々に増加</span>
<span class="c1"># ----------------------------------------------------------------------------------</span>

<span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://docs.scipy.org/doc/scipy/reference/stats.html#module-scipy.stats" title="scipy.stats"><span class="nn">scipy.stats</span></a> <span class="k">as</span> <span class="nn">st</span>

<span class="c1"># 図の定義</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>

<span class="c1"># x軸の定義</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.35</span><span class="p">,</span> <span class="mf">0.65</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>

<span class="c1"># 擬似乱数生成</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">trials_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">]</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">()</span>
<span class="n">j</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">for</span> <span class="n">trials</span> <span class="ow">in</span> <span class="n">trials_list</span><span class="p">:</span>
    <span class="n">means</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">trials</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/stdtypes.html#range" title="range"><span class="nb">range</span></a><span class="p">(</span><span class="n">trials</span><span class="p">):</span>
        <span class="n">rvs</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
        <span class="n">means</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">rvs</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

    <span class="c1"># 一様分布から抽出したサンプル平均を trials 回だけドローしたもののヒストグラム.</span>
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span>
        <span class="n">means</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">stat</span><span class="o">=</span><span class="s2">"probability"</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"random variables"</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span>
    <span class="p">)</span>
    <span class="n">title</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"trials = </span><span class="si">{</span><span class="n">trials</span><span class="si">}</span><span class="s2">"</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>

    <span class="c1"># 正規性を確認するための Q-Q プロット.</span>
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span>
    <a class="sphinx-codeautolink-a" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.probplot.html#scipy.stats.probplot" title="scipy.stats.probplot"><span class="n">st</span><span class="o">.</span><span class="n">probplot</span></a><span class="p">(</span><span class="n">means</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="n">plt</span><span class="p">)</span>

    <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/dist_78_0.png" src="../../_images/dist_78_0.png"/>
</div>
</div>
</section>
</section>
<section id="id41">
<h3>例 3.3 (対数正規分布)<a class="headerlink" href="#id41" title="Permalink to this headline">#</a></h3>
<section id="id42">
<h4>確率密度関数<a class="headerlink" href="#id42" title="Permalink to this headline">#</a></h4>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p><span class="math notranslate nohighlight">\(\log{X} \sim N(\mu, \sigma^2)\)</span> の時に元の <span class="math notranslate nohighlight">\(X (&gt;0)\)</span> は<strong>対数正規分布</strong> (log-normal distribution) に従うといい, 確率密度関数は以下のように表現できる.</p>
<div class="math notranslate nohighlight">
\[
    \begin{align}
        f(x) = \frac{1}{\sqrt{2 \pi} \sigma x} \exp{ \biggl( - \frac{ (\log {x} -\mu)^2 }{ 2 \sigma^2 } \biggr) }
    \end{align}
\]</div>
</div>
<p>これは <a class="reference internal" href="rvs.html#exmaple-normal-lognormal"><span class="std std-ref">例 4.2 (正規分布と対数正規分布)</span></a> でも説明したように, <span class="math notranslate nohighlight">\(y = \log(x)\)</span> として <span class="math notranslate nohighlight">\(y \sim N(\mu, \sigma^2)\)</span> の場合に上式の密度関数が得られる.<br/>
　ここで<a class="reference internal" href="rvs.html#continuous-distribution"><span class="std std-ref">連続型の確率分布の性質</span></a>を確認する. 確率密度関数の定義から <span class="math notranslate nohighlight">\(f(x) \geq 0\)</span> であることは自明. また, <span class="math notranslate nohighlight">\(y = \log{x} \Leftrightarrow x = e^y\)</span> として,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        \int_{ 0 }^{ \infty }{ \frac{1}{\sqrt{2\pi} \sigma x} \exp{ \biggl( - \frac{( \log{x} -\mu)^2}{2 \sigma^2} \biggr) } dx} 
            &amp;= \int_{ -\infty }^{ \infty }{ \frac{1}{\sqrt{2\pi} \sigma e^y} \exp{ \biggl( - \frac{( y -\mu)^2}{2 \sigma^2} \biggr) } e^y dy} \\
            &amp;= \int_{ -\infty }^{ \infty }{ \frac{1}{\sqrt{2\pi} \sigma} \exp{ \biggl( - \frac{( y -\mu)^2}{2 \sigma^2} \biggr) } dy}
    \end{align}
\end{split}\]</div>
<p>となり正規分布と同じ式なので 1 となる.</p>
</section>
<section id="id43">
<h4>期待値と分散<a class="headerlink" href="#id43" title="Permalink to this headline">#</a></h4>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        &amp; {\rm E}(X) = \exp{ \biggl( \mu + \frac{\sigma^2}{2} \biggr) } \\
        &amp; {\rm Var}(X) = \exp{ ( 2\mu + 2\sigma^2) } - \exp{ ( 2\mu + \sigma^2) }
    \end{align}
\end{split}\]</div>
</div>
<p><u>証明</u><br/>
　<a class="reference internal" href="rvs.html#expectation"><span class="std std-ref">期待値の定義</span></a>と <span class="math notranslate nohighlight">\(y = \log{x} \Leftrightarrow x = e^y\)</span> で <span class="math notranslate nohighlight">\(dx = e^y dy\)</span> より</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm E}(X) &amp;= \int_{0}^{\infty}{ x \frac{1}{\sqrt{2 \pi} \sigma x} \exp{ \biggl( - \frac{ (\log {x} -\mu)^2 }{ 2 \sigma^2 } \biggr) } dx } \\
                   &amp;= \int_{-\infty}^{\infty}{ e^y \frac{1}{\sqrt{2 \pi} \sigma e^y} \exp{ \biggl( - \frac{ (y -\mu)^2 }{ 2 \sigma^2 } \biggr) } e^y dy } \\
                   &amp;= \int_{-\infty}^{\infty}{ \frac{1}{\sqrt{2 \pi} \sigma } \exp{ \biggl( - \frac{ (y -\mu)^2 }{ 2 \sigma^2 } + y \biggr) } dy }
    \end{align}
\end{split}\]</div>
<p><span class="math notranslate nohighlight">\(\exp\)</span> の中身を平方完成すると以下のようになる.</p>
<div class="math notranslate nohighlight">
\[
    - \frac{ (y -\mu)^2 }{ 2 \sigma^2 } + y = - \frac{(y - \mu - \sigma^2)^2 }{2 \sigma^2} + \mu + \frac{\sigma^2}{2}
\]</div>
<p>ここで, <span class="math notranslate nohighlight">\(t = y - \mu - \sigma^2\)</span> と置換して</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm E}(X) &amp;= \int_{-\infty}^{\infty}{ \frac{1}{\sqrt{2 \pi} \sigma } \exp{ \biggl( - \frac{(y - \mu - \sigma^2)^2 }{2 \sigma^2} + \mu + \frac{\sigma^2}{2} \biggr) } dy } \\
                   &amp;= \int_{-\infty}^{\infty}{ \frac{1}{\sqrt{2 \pi} \sigma } \exp{ \biggl( - \frac{ t^2 }{2 \sigma^2} + \mu + \frac{\sigma^2}{2} \biggr) } dy } \\
                   &amp;= \exp{ \biggl( \mu + \frac{\sigma^2}{2} \biggr) } \underline{\int_{-\infty}^{\infty}{ \frac{1}{\sqrt{2 \pi} \sigma } \exp{ \biggl( - \frac{ t^2 }{2 \sigma^2} \biggr) } dt }} \\
                   &amp;= \exp{ \biggl( \mu + \frac{\sigma^2}{2} \biggr) }
    \end{align}
\end{split}\]</div>
<p>と求められる. 下線部分は <a class="reference internal" href="#gaussian-integral"><span class="std std-ref">ガウス積分</span></a> によって計算できる.
また分散については<a class="reference internal" href="rvs.html#expect-variance"><span class="std std-ref">分散と期待値の関係式</span></a>より</p>
<div class="math notranslate nohighlight">
\[
    \begin{align}
        {\rm Var}(X) &amp;= {\rm}E(X^2) - ({\rm E}(X))^2
    \end{align}
\]</div>
<p>なので <span class="math notranslate nohighlight">\({\rm}E(X^2)\)</span> を求める.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm E}(X^2) &amp;= \int_{0}^{\infty}{ x^2 \frac{1}{\sqrt{2 \pi} \sigma x} \exp{ \biggl( - \frac{ (\log {x} -\mu)^2 }{ 2 \sigma^2 } \biggr) } dx } \\
                   &amp;= \int_{-\infty}^{\infty}{ e^{2y} \frac{1}{\sqrt{2 \pi} \sigma e^y} \exp{ \biggl( - \frac{ (y -\mu)^2 }{ 2 \sigma^2 } \biggr) } e^y dy } \\
                   &amp;= \int_{-\infty}^{\infty}{ \frac{1}{\sqrt{2 \pi} \sigma } \exp{ \biggl( - \frac{ (y -\mu)^2 }{ 2 \sigma^2 } + 2y \biggr) } dy } \\
                   &amp;= \int_{-\infty}^{\infty}{ \frac{1}{\sqrt{2 \pi} \sigma } \exp{ \biggl( - \frac{(y - \mu - 2 \sigma^2)^2 }{2 \sigma^2} + 2 (\mu + \sigma^2) \biggr) } dy } \\
                   &amp;= \exp{ (2\mu + 2\sigma^2 ) } \int_{-\infty}^{\infty}{ \frac{1}{\sqrt{2 \pi} \sigma } \exp{ \biggl( - \frac{(y - \mu - 2 \sigma^2)^2 }{2 \sigma^2} \biggr) } dy } \\
                   &amp;= \exp{ (2\mu + 2\sigma^2 ) } \underline{ \int_{-\infty}^{\infty}{ \frac{1}{\sqrt{2 \pi} \sigma } \exp{ \biggl( - \frac{t^2 }{2 \sigma^2} \biggr) } dt } \quad (t = y - \mu - 2\sigma^2) } \\
                   &amp;= \exp{ (2\mu + 2\sigma^2 ) }
    \end{align}
\end{split}\]</div>
<p>である. 下線部分は <a class="reference internal" href="#gaussian-integral"><span class="std std-ref">ガウス積分</span></a> によって計算できる.
よって</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm Var}(X) &amp;= {\rm}E(X^2) - ({\rm E}(X))^2 \\
                     &amp;= \exp{ ( 2\mu + 2\sigma^2) } - \exp{ ( 2\mu + \sigma^2) }.
    \end{align}
\end{split}\]</div>
</section>
<section id="python-example-lognormal">
<span id="id44"></span><h4>Python での確認<a class="headerlink" href="#python-example-lognormal" title="Permalink to this headline">#</a></h4>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.lognorm.html#scipy.stats.lognorm">SciPy ( <code class="docutils literal notranslate"><span class="pre">scipy.stats.lognorm</span></code> )</a></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">s</span></code> : 元になっている正規分布の標準偏差 <span class="math notranslate nohighlight">\(\sigma\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">scale</span></code> : 元になっている正規分布の期待値 <span class="math notranslate nohighlight">\(\mu\)</span> を用いて <span class="math notranslate nohighlight">\(\exp{(\mu)}\)</span> に対応.</p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.Generator.lognormal.html">NumPy ( <code class="docutils literal notranslate"><span class="pre">numpy.random.Generator.lognormal</span></code> )</a></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">mean</span></code> : 元になっている正規分布の期待値 <span class="math notranslate nohighlight">\(\mu\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sigma</span></code> : 元になっている正規分布の標準偏差 <span class="math notranslate nohighlight">\(\sigma\)</span>.</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 元になっている正規分布の平均が 2, 標準偏差が 1 である対数正規分布に従った疑似乱数を size = 10000 だけ生成する.</span>
<span class="n">mean</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">sigma</span>
<span class="n">scale</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">mean</span><span class="p">)</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">10000</span>

<span class="c1"># SciPy</span>
<span class="n">rvs</span> <span class="o">=</span> <span class="n">lognorm</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="s2">"&gt; SciPy"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="n">rvs</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">20</span><span class="p">])</span>

<span class="c1"># NumPy</span>
<span class="n">rvs_numpy</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">lognormal</span><span class="p">(</span><span class="n">mean</span><span class="o">=</span><span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="s2">"&gt; NumPy"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="n">rvs_numpy</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">20</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&gt; SciPy
[ 11.51581117  18.90737653  26.80442656 117.49935348   5.2741957
   1.12226914  25.61915748   3.01707231  30.80043909   8.43581563
   3.1355021    4.30859465   3.30985404   2.82409186  11.9543758
   7.12392431  10.35005829   2.65472522  10.10150922   8.56721693]
&gt; NumPy
[11.49187436  6.29665655  0.93466196 10.56411863 26.17893914  8.6133689
  6.38189167  8.15984599  3.00800504 43.61725663 16.28332367 11.89424213
  6.7370621   5.11887745 16.84545889 13.12049581  5.80339338  8.91730092
  8.60557099 14.58879037]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 期待値・分散の理論値</span>
<span class="n">exp_true</span> <span class="o">=</span> <span class="n">lognorm</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>
<span class="n">var_true</span> <span class="o">=</span> <span class="n">lognorm</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>

<span class="c1"># 擬似乱数から期待値・分散の計算</span>
<span class="n">exp_rvs</span><span class="p">,</span> <span class="n">var_rvs</span> <span class="o">=</span> <span class="n">calculate_stats</span><span class="p">(</span><span class="n">rvs</span><span class="p">)</span>

<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="s2">"&gt; SciPy"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="sa">f</span><span class="s2">"期待値(乱数 vs 真値): </span><span class="si">{</span><span class="n">exp_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">exp_true</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="sa">f</span><span class="s2">"分散(乱数 vs 真値): </span><span class="si">{</span><span class="n">var_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">var_true</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

<span class="n">exp_rvs</span><span class="p">,</span> <span class="n">var_rvs</span> <span class="o">=</span> <span class="n">calculate_stats</span><span class="p">(</span><span class="n">rvs_numpy</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="s2">"&gt; NumPy"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="sa">f</span><span class="s2">"期待値(乱数 vs 真値): </span><span class="si">{</span><span class="n">exp_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">exp_true</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="sa">f</span><span class="s2">"分散(乱数 vs 真値): </span><span class="si">{</span><span class="n">var_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">var_true</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&gt; SciPy
期待値(乱数 vs 真値): 12.080901648109892 vs 12.182493960703473
分散(乱数 vs 真値): 230.49366820947247 vs 255.0156343901585
&gt; NumPy
期待値(乱数 vs 真値): 11.967411367616918 vs 12.182493960703473
分散(乱数 vs 真値): 219.93271479652057 vs 255.0156343901585
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 確率変数 x を渡すことで, それぞれに対応する確率密度関数の値を取得できる.</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">lognorm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>

<span class="c1"># 擬似乱数によるヒストグラムと確率密度関数の値を図示.</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span>
    <span class="p">[</span><span class="n">rvs</span><span class="p">,</span> <span class="n">rvs_numpy</span><span class="p">],</span>
    <span class="n">bins</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
    <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="s2">"blue"</span><span class="p">,</span> <span class="s2">"green"</span><span class="p">],</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="p">[</span><span class="s2">"SciPy"</span><span class="p">,</span> <span class="s2">"NumPy"</span><span class="p">],</span>
<span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"PDF"</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">"red"</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Log-normal Distribution"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, 'Log-normal Distribution')
</pre></div>
</div>
<img alt="../../_images/dist_85_1.png" src="../../_images/dist_85_1.png"/>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># s = 1 で固定し scale のみを動かした時の波形の違い.</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

<span class="n">scales</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">4</span><span class="p">)]</span>
<span class="n">s</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">)</span>
<span class="k">for</span> <span class="n">scale</span> <span class="ow">in</span> <span class="n">scales</span><span class="p">:</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">lognorm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>
    <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"mu = </span><span class="si">{</span><a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#round" title="round"><span class="nb">round</span></a><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">scale</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2">, sigma = </span><span class="si">{</span><span class="n">s</span><span class="si">}</span><span class="s2">"</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x1290b1f00&gt;
</pre></div>
</div>
<img alt="../../_images/dist_86_1.png" src="../../_images/dist_86_1.png"/>
</div>
</div>
</section>
<section id="id45">
<h4>ユースケース<a class="headerlink" href="#id45" title="Permalink to this headline">#</a></h4>
<ul class="simple">
<li><p>世帯年収</p></li>
</ul>
</section>
</section>
<section id="id46">
<h3>例 3.4 (指数分布)<a class="headerlink" href="#id46" title="Permalink to this headline">#</a></h3>
<section id="id47">
<h4>確率密度関数<a class="headerlink" href="#id47" title="Permalink to this headline">#</a></h4>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p><strong>指数分布</strong> (exponential distribution) は <span class="math notranslate nohighlight">\(\lambda &gt; 0\)</span> として以下の確率密度関数で表現できる.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        f(x) = \begin{cases}
            \lambda e^{-\lambda x}  &amp; (x \geq 0) \\
            0 &amp; (x &lt; 0)
        \end{cases}
    \end{align}
\end{split}\]</div>
</div>
<p>ここで<a class="reference internal" href="rvs.html#continuous-distribution"><span class="std std-ref">連続型の確率分布の性質</span></a>を確認する. 確率密度関数の定義から <span class="math notranslate nohighlight">\(f(x) \geq 0\)</span> であることは自明. また,</p>
<div class="math notranslate nohighlight">
\[
    \begin{align}
        \int_{0}^{\infty}{\lambda e^{-\lambda x} dx} = \biggl[ -e^{-\lambda x} \biggr]_{0}^{\infty} = 1
    \end{align}
\]</div>
</section>
<section id="id48">
<h4>期待値と分散<a class="headerlink" href="#id48" title="Permalink to this headline">#</a></h4>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        &amp; {\rm E}(X) = \frac{1}{\lambda} \\
        &amp; {\rm Var}(X) = \frac{1}{\lambda^2}
    \end{align}
\end{split}\]</div>
</div>
<p><u>証明</u><br/>
　<a class="reference internal" href="rvs.html#expectation"><span class="std std-ref">期待値の定義</span></a>より</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm E}(X) &amp;= \int_{0}^{\infty}{x \lambda e^{-\lambda x} dx } \\
                   &amp;= \biggl[ -xe^{-\lambda x} \biggr]_{0}^{\infty} + \int_{0}^{\infty}{e^{-\lambda x}dx} \\
                   &amp;= \biggl[ -\frac{1}{\lambda} e^{-\lambda x} \biggr]_{0}^{\infty} \\
                   &amp;= \frac{1}{\lambda}
    \end{align}
\end{split}\]</div>
<p>と求められる. また分散について<a class="reference internal" href="rvs.html#expect-variance"><span class="std std-ref">分散と期待値の関係式</span></a>から <span class="math notranslate nohighlight">\({\rm E}(X^2)\)</span> を求めればよい. 部分積分を 2 回行うことで計算できる.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm E}(X^2) &amp;= \int_{0}^{\infty}{x^2 \lambda e^{-\lambda x} dx} \\
                     &amp;= \biggl[ -x^2e^{-\lambda x} \biggr]_{0}^{\infty} - \frac{2}{\lambda} \biggl[ -xe^{-\lambda x} \biggr]_{0}^{\infty} + \frac{2}{\lambda} \int_{0}^{\infty}{e^{-\lambda x}dx} \\
                     &amp;= \frac{2}{\lambda}\biggl[ -\frac{1}{\lambda} e^{-\lambda x} \biggr]_{0}^{\infty} \\
                     &amp;= \frac{2}{\lambda^2}
    \end{align}
\end{split}\]</div>
<p>よって</p>
<div class="math notranslate nohighlight">
\[
    \begin{align}
        {\rm Var}(X) = \frac{2}{\lambda^2} - \frac{1}{\lambda^2} = \frac{1}{\lambda^2}.
    \end{align}
\]</div>
</section>
<section id="python-example-exponential">
<span id="id49"></span><h4>Python での確認<a class="headerlink" href="#python-example-exponential" title="Permalink to this headline">#</a></h4>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.expon.html#scipy.stats.expon">SciPy ( <code class="docutils literal notranslate"><span class="pre">scipy.stats.expon</span></code> )</a></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">scale</span></code> : <span class="math notranslate nohighlight">\(\dfrac{1}{\lambda}\)</span> に対応.</p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.Generator.exponential.html">NumPy ( <code class="docutils literal notranslate"><span class="pre">numpy.random.Generator.exponential</span></code> )</a></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">scale</span></code> : <span class="math notranslate nohighlight">\(\dfrac{1}{\lambda}\)</span> に対応.</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># lam = 10 に関する指数分布に従った疑似乱数を size = 10000 だけ生成する.</span>
<span class="n">lam</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">scale</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">lam</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">10000</span>

<span class="c1"># SciPy</span>
<span class="n">rvs</span> <span class="o">=</span> <span class="n">expon</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="s2">"&gt; SciPy"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="n">rvs</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">20</span><span class="p">])</span>

<span class="c1"># NumPy</span>
<span class="n">rvs_numpy</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">exponential</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="s2">"&gt; NumPy"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="n">rvs_numpy</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">20</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&gt; SciPy
[0.10436538 0.23076359 0.00483081 0.06553507 0.21370625 0.05445505
 0.04290342 0.03644293 0.13897985 0.04747918 0.24191002 0.04758563
 0.15497038 0.14048006 0.08198076 0.19302339 0.01630937 0.06122759
 0.00030391 0.0044874 ]
&gt; NumPy
[0.06293273 0.10265414 0.09364228 0.04255953 0.05236125 0.05317996
 0.07908863 0.05277057 0.01317143 0.02526677 0.01937384 0.1070748
 0.23904441 0.03776057 0.02656617 0.01279303 0.13872364 0.01220859
 0.1887649  0.12916844]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 期待値・分散の理論値</span>
<span class="n">exp_true</span> <span class="o">=</span> <span class="n">expon</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>
<span class="n">var_true</span> <span class="o">=</span> <span class="n">expon</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>

<span class="c1"># 擬似乱数から期待値・分散の計算</span>
<span class="n">exp_rvs</span><span class="p">,</span> <span class="n">var_rvs</span> <span class="o">=</span> <span class="n">calculate_stats</span><span class="p">(</span><span class="n">rvs</span><span class="p">)</span>

<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="s2">"&gt; SciPy"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="sa">f</span><span class="s2">"期待値(乱数 vs 真値): </span><span class="si">{</span><span class="n">exp_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">exp_true</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="sa">f</span><span class="s2">"分散(乱数 vs 真値): </span><span class="si">{</span><span class="n">var_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">var_true</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

<span class="n">exp_rvs</span><span class="p">,</span> <span class="n">var_rvs</span> <span class="o">=</span> <span class="n">calculate_stats</span><span class="p">(</span><span class="n">rvs_numpy</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="s2">"&gt; NumPy"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="sa">f</span><span class="s2">"期待値(乱数 vs 真値): </span><span class="si">{</span><span class="n">exp_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">exp_true</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="sa">f</span><span class="s2">"分散(乱数 vs 真値): </span><span class="si">{</span><span class="n">var_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">var_true</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&gt; SciPy
期待値(乱数 vs 真値): 0.0996316625791147 vs 0.1
分散(乱数 vs 真値): 0.010063644678430227 vs 0.010000000000000002
&gt; NumPy
期待値(乱数 vs 真値): 0.09909389880213224 vs 0.1
分散(乱数 vs 真値): 0.009691114632813575 vs 0.010000000000000002
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 確率変数 x を渡すことで, それぞれに対応する確率密度関数の値を取得できる.</span>
<span class="n">rvs_max</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#max" title="max"><span class="nb">max</span></a><span class="p">(</span><span class="n">rvs</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">rvs_numpy</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="n">rvs_min</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#min" title="min"><span class="nb">min</span></a><span class="p">(</span><span class="n">rvs</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">rvs_numpy</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">rvs_min</span><span class="p">,</span> <span class="n">rvs_max</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">expon</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>

<span class="c1"># 擬似乱数によるヒストグラムと確率密度関数の値を図示.</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span>
    <span class="p">[</span><span class="n">rvs</span><span class="p">,</span> <span class="n">rvs_numpy</span><span class="p">],</span>
    <span class="n">bins</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
    <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="s2">"blue"</span><span class="p">,</span> <span class="s2">"green"</span><span class="p">],</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="p">[</span><span class="s2">"SciPy"</span><span class="p">,</span> <span class="s2">"NumPy"</span><span class="p">],</span>
<span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"PDF"</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">"red"</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Exponential Distribution"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, 'Exponential Distribution')
</pre></div>
</div>
<img alt="../../_images/dist_94_1.png" src="../../_images/dist_94_1.png"/>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># lambda を動かした時の波形の違い.</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

<span class="n">lams</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">20</span><span class="p">]</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>
<span class="k">for</span> <span class="n">lam</span> <span class="ow">in</span> <span class="n">lams</span><span class="p">:</span>
    <span class="n">scale</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">lam</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">expon</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>
    <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"lambda = </span><span class="si">{</span><span class="n">lam</span><span class="si">}</span><span class="s2">"</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x12bb19390&gt;
</pre></div>
</div>
<img alt="../../_images/dist_95_1.png" src="../../_images/dist_95_1.png"/>
</div>
</div>
</section>
<section id="id50">
<h4>ユースケース<a class="headerlink" href="#id50" title="Permalink to this headline">#</a></h4>
<ul class="simple">
<li><p>工事中</p></li>
</ul>
</section>
</section>
<section id="id51">
<h3>例 3.5 (ガンマ分布)<a class="headerlink" href="#id51" title="Permalink to this headline">#</a></h3>
<section id="id52">
<h4>確率密度関数<a class="headerlink" href="#id52" title="Permalink to this headline">#</a></h4>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p><strong>ガンマ分布</strong> (Gamma distribution) は <span class="math notranslate nohighlight">\(\lambda &gt; 0, \alpha &gt; 0\)</span> として以下の確率密度関数で表現できる.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        f(x) = \begin{cases}
            \dfrac{\lambda^\alpha}{\varGamma(\alpha)} x^{\alpha - 1}e^{-\lambda x}  &amp; (x \geq 0) \\
            0 &amp; (x &lt; 0)
        \end{cases}
    \end{align}
\end{split}\]</div>
<p>ここで <span class="math notranslate nohighlight">\(\varGamma(\alpha)\)</span> は以下で定義され<strong>ガンマ関数</strong> という.</p>
<div class="math notranslate nohighlight">
\[
    \begin{align}
        \varGamma(\alpha) = \int_{0}^{\infty}{x^{\alpha - 1}e^{-x}dx}
    \end{align}
\]</div>
</div>
<p><span class="math notranslate nohighlight">\(\alpha = 1\)</span> ならば指数分布になることが分かる.<br/>
　ここで<a class="reference internal" href="rvs.html#continuous-distribution"><span class="std std-ref">連続型の確率分布の性質</span></a>を確認する. 確率密度関数の定義から <span class="math notranslate nohighlight">\(f(x) \geq 0\)</span> であることは自明. また合計和が 1 になることは以下についてまず示す.</p>
<div class="math notranslate nohighlight">
\[
    \begin{align}
        \int_{0}^{\infty}{x^{\alpha-1}e^{-\lambda x}dx} = \frac{\varGamma(\alpha)}{\lambda^(\alpha)}
    \end{align}
\]</div>
<p><span class="math notranslate nohighlight">\(\lambda x = y\)</span> とすれば <span class="math notranslate nohighlight">\(\lambda dx = dy\)</span> より</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        \int_{0}^{\infty}{x^{\alpha-1}e^{-\lambda x}dx} &amp;= \int_{0}^{\infty}{ \biggl( \frac{y}{\lambda} \biggr) ^{\alpha - 1} e^{-y} \frac{1}{\lambda} dy } \\
                                                        &amp;= \frac{1}{\lambda^\alpha} \int_{0}^{\infty}{y^{\alpha-1}e^{-y}dy} \\
                                                        &amp;= \frac{\varGamma(\alpha)}{\lambda^(\alpha)}
    \end{align}
\end{split}\]</div>
<p>ゆえに以下のように計算できる.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        \int_{0}^{\infty}{ \frac{ \lambda^\alpha }{ \varGamma(\alpha) } x^{\alpha - 1} e^{-\lambda x} dx } 
            &amp;= \frac{\lambda^{\alpha}}{\varGamma(\alpha)} \int_{0}^{\infty}{x^{\alpha-1}e^{-\lambda x}dx} \\
            &amp;= \frac{\lambda^{\alpha}}{\varGamma(\alpha)} \cdot \frac{\varGamma(\alpha)}{\lambda^(\alpha)} \\
            &amp;= 1.
    \end{align}
\end{split}\]</div>
</section>
<section id="id53">
<h4>期待値と分散<a class="headerlink" href="#id53" title="Permalink to this headline">#</a></h4>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        &amp; {\rm E}(X) = \frac{\alpha}{\lambda} \\
        &amp; {\rm Var}(X) = \frac{\alpha}{\lambda^2}
    \end{align}
\end{split}\]</div>
</div>
<p><u>証明</u><br/>
　<a class="reference internal" href="rvs.html#expectation"><span class="std std-ref">期待値の定義</span></a>と<a class="reference internal" href="#gamma-function"><span class="std std-ref">ガンマ関数の性質</span></a>から <span class="math notranslate nohighlight">\(\varGamma(\alpha + 1) = \alpha \varGamma(\alpha)\)</span> となることに注意して</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm E}(X) &amp;= \int_{0}^{\infty}{ x \frac{\lambda^\alpha}{\varGamma(\alpha)} x^{\alpha - 1}e^{-\lambda x} dx } \\
                   &amp;= \int_{0}^{\infty}{ \frac{\alpha \lambda^\alpha}{\varGamma(\alpha + 1)} x^{\alpha}e^{-\lambda x} dx } \\
                   &amp;= \frac{\alpha}{\lambda} \int_{0}^{\infty}{ \frac{\lambda^{\alpha + 1}}{\varGamma(\alpha + 1)} x^{(\alpha+1)-1}e^{-\lambda x} dx } \\
                   &amp;= \frac{\alpha}{\lambda}
    \end{align}
\end{split}\]</div>
<p>と求められる. た分散について<a class="reference internal" href="rvs.html#expect-variance"><span class="std std-ref">分散と期待値の関係式</span></a>から <span class="math notranslate nohighlight">\({\rm E}(X^2)\)</span> を求めればよい. <a class="reference internal" href="#gamma-function"><span class="std std-ref">ガンマ関数の性質</span></a>から <span class="math notranslate nohighlight">\(\varGamma(\alpha + 2) = (\alpha + 1)\varGamma(\alpha + 1) = (\alpha + 1)\alpha \varGamma(\alpha)\)</span> であることより</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm E}(X^2) &amp;= \int_{0}^{\infty}{ x^2 \frac{\lambda^\alpha}{\varGamma(\alpha)} x^{\alpha - 1}e^{-\lambda x} dx } \\
                     &amp;= \int_{0}^{\infty}{ \frac{\alpha (\alpha + 1) \lambda^\alpha}{\varGamma(\alpha + 2)} x^{\alpha + 1}e^{-\lambda x} dx } \\
                     &amp;= \frac{\alpha(\alpha + 1)}{\lambda^2} \int_{0}^{\infty}{ \frac{\lambda^{\alpha + 2}}{\varGamma(\alpha + 2)} x^{(\alpha+2)-1}e^{-\lambda x} dx } \\
                     &amp;= \frac{\alpha(\alpha + 1)}{\lambda^2}
    \end{align}
\end{split}\]</div>
<p>よって</p>
<div class="math notranslate nohighlight">
\[
    \begin{align}
        {\rm Var}(X) = \frac{\alpha(\alpha + 1)}{\lambda^2} - \frac{\alpha^2}{\lambda^2} = \frac{\alpha}{\lambda^2}.
    \end{align}
\]</div>
</section>
<section id="id54">
<h4>命題 3.5.1 (ガンマ関数の性質)<a class="headerlink" href="#id54" title="Permalink to this headline">#</a></h4>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<div class="math notranslate nohighlight" id="gamma-function">
\[\begin{split}
    \begin{align}
        &amp; \varGamma(\alpha) = (\alpha - 1)\varGamma(\alpha) \\
        &amp; \varGamma(n + 1) = n! \quad (n \text{は正整数とする}) \\
        &amp; \varGamma \biggl( \frac{1}{2} \biggr) = \sqrt{\pi}
    \end{align}
\end{split}\]</div>
</div>
<p><u>証明</u>
　一つ目について部分積分より</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        \varGamma(\alpha) &amp;= \int_{0}^{\infty}{x^{\alpha-1}e^{-x}dx} \\
                          &amp;= \biggl[ -x^{\alpha-1}e^{-x} \biggr]_{0}^{\infty} + (\alpha - 1) \int_{0}^{\infty}{x^{\alpha-2}x^{-2}dx} \\
                          &amp;= (\alpha - 1) \varGamma(\alpha - 1)
    \end{align}
\end{split}\]</div>
<p>と求められる. また <span class="math notranslate nohighlight">\(\varGamma(1)\)</span> について</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        \varGamma(1) &amp;= \int_{0}^{\infty}{e^{-x}dx} \\
                     &amp;= \biggl[ -e^{-x} \biggr]_{0}^{\infty} \\
                     &amp;= 1
    \end{align}
\end{split}\]</div>
<p>なので, <span class="math notranslate nohighlight">\(n \in \mathbb{N}\)</span> として</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        \varGamma(n + 1) &amp;= n \varGamma(n) \\
                         &amp;= n(n-1) \varGamma(n-1) \\
                         &amp;\cdots \\
                         &amp;= n(n-1) \cdots 1 \varGamma(1) \\
                         &amp;= n!
    \end{align}
\end{split}\]</div>
<p>と分かる. 最後に<a class="reference internal" href="#gaussian-integral"><span class="std std-ref">ガウス積分</span></a>を用いて以下のように計算できる.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        \varGamma\biggl(\frac{1}{2}\biggr) &amp;= \int_{0}^{\infty}{x^{-\frac{1}{2}}e^{-x}dx} \\
                                           &amp;= \int_{0}^{\infty}{ \frac{e^{-x}}{\sqrt{x}}dx} \\
                                           &amp;= \int_{0}^{\infty}{ \frac{e^{-t^2}}{t}2tdt} \quad (t = \sqrt{x}) \\
                                           &amp;= 2 \int_{0}^{\infty}{e^{-t^2}dt} \\
                                           &amp;= \sqrt{\pi}
    \end{align}
\end{split}\]</div>
</section>
<section id="python-example-gamma">
<span id="id55"></span><h4>Python での確認<a class="headerlink" href="#python-example-gamma" title="Permalink to this headline">#</a></h4>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.gamma.html#scipy.stats.gamma">SciPy ( <code class="docutils literal notranslate"><span class="pre">scipy.stats.gamma</span></code> )</a></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">a</span></code>: <span class="math notranslate nohighlight">\(\alpha\)</span> に対応.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">scale</span></code>: <span class="math notranslate nohighlight">\(\dfrac{1}{\lambda}\)</span> に対応.</p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.Generator.gamma.html">NumPy ( <code class="docutils literal notranslate"><span class="pre">numpy.random.Generator.gamma</span></code> )</a></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">shape</span></code>: <span class="math notranslate nohighlight">\(\alpha\)</span> に対応.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">scale</span></code>: <span class="math notranslate nohighlight">\(\dfrac{1}{\lambda}\)</span> に対応.</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># alpha = 2, lambda = 1 に関するガンマ分布に従った疑似乱数を size = 10000 だけ生成.</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">lam</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">shape</span> <span class="o">=</span> <span class="n">alpha</span>
<span class="n">scale</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">lam</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">10000</span>

<span class="c1"># SciPy</span>
<span class="n">rvs</span> <span class="o">=</span> <span class="n">gamma</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="s2">"&gt; SciPy"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="n">rvs</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">20</span><span class="p">])</span>

<span class="c1"># NumPy</span>
<span class="n">rvs_numpy</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="s2">"&gt; NumPy"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="n">rvs_numpy</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">20</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&gt; SciPy
[0.92828797 1.33281776 3.33730654 3.98122777 2.6241644  2.0732137
 0.83333749 3.7493054  1.64009382 0.79077252 6.24107865 1.13496569
 1.59398486 1.44778318 2.65526843 4.00951562 1.20457044 4.32710202
 1.12823204 2.2051235 ]
&gt; NumPy
[2.68180294 3.26063198 2.56192008 2.75926315 7.84215002 5.13489557
 2.89571872 0.60705151 3.12034053 1.96071611 4.11547094 1.29484485
 6.05961913 1.30316692 2.1228874  1.63571947 4.11095732 0.42882606
 0.07473451 2.25343515]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 期待値・分散の理論値</span>
<span class="n">exp_true</span> <span class="o">=</span> <span class="n">gamma</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>
<span class="n">var_true</span> <span class="o">=</span> <span class="n">gamma</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>

<span class="c1"># 擬似乱数から期待値・分散の計算</span>
<span class="n">exp_rvs</span><span class="p">,</span> <span class="n">var_rvs</span> <span class="o">=</span> <span class="n">calculate_stats</span><span class="p">(</span><span class="n">rvs</span><span class="p">)</span>

<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="s2">"&gt; SciPy"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="sa">f</span><span class="s2">"期待値(乱数 vs 真値): </span><span class="si">{</span><span class="n">exp_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">exp_true</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="sa">f</span><span class="s2">"分散(乱数 vs 真値): </span><span class="si">{</span><span class="n">var_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">var_true</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

<span class="n">exp_rvs</span><span class="p">,</span> <span class="n">var_rvs</span> <span class="o">=</span> <span class="n">calculate_stats</span><span class="p">(</span><span class="n">rvs_numpy</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="s2">"&gt; NumPy"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="sa">f</span><span class="s2">"期待値(乱数 vs 真値): </span><span class="si">{</span><span class="n">exp_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">exp_true</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="sa">f</span><span class="s2">"分散(乱数 vs 真値): </span><span class="si">{</span><span class="n">var_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">var_true</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&gt; SciPy
期待値(乱数 vs 真値): 1.9894865061747704 vs 2.0
分散(乱数 vs 真値): 2.0132514882548382 vs 2.0
&gt; NumPy
期待値(乱数 vs 真値): 2.0041866732564224 vs 2.0
分散(乱数 vs 真値): 1.9930370537357176 vs 2.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 確率変数 x を渡すことで, それぞれに対応する確率密度関数の値を取得できる.</span>
<span class="n">rvs_max</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#max" title="max"><span class="nb">max</span></a><span class="p">(</span><span class="n">rvs</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">rvs_numpy</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="n">rvs_min</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#min" title="min"><span class="nb">min</span></a><span class="p">(</span><span class="n">rvs</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">rvs_numpy</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">rvs_min</span><span class="p">,</span> <span class="n">rvs_max</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">gamma</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>

<span class="c1"># 擬似乱数によるヒストグラムと確率密度関数の値を図示.</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span>
    <span class="p">[</span><span class="n">rvs</span><span class="p">,</span> <span class="n">rvs_numpy</span><span class="p">],</span>
    <span class="n">bins</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
    <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="s2">"blue"</span><span class="p">,</span> <span class="s2">"green"</span><span class="p">],</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="p">[</span><span class="s2">"SciPy"</span><span class="p">,</span> <span class="s2">"NumPy"</span><span class="p">],</span>
<span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"PDF"</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">"red"</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Gamma Distribution"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, 'Gamma Distribution')
</pre></div>
</div>
<img alt="../../_images/dist_104_1.png" src="../../_images/dist_104_1.png"/>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># alpha を動かした時の波形の違い.</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

<span class="n">alphas</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">]</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">gamma</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#max" title="max"><span class="nb">max</span></a><span class="p">(</span><span class="n">alphas</span><span class="p">),</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="k">for</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="n">alphas</span><span class="p">:</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">alpha</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">gamma</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>
    <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"alpha = </span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s2">"</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x12b8908b0&gt;
</pre></div>
</div>
<img alt="../../_images/dist_105_1.png" src="../../_images/dist_105_1.png"/>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># scale を動かした時の波形の違い.</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax3</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

<span class="n">a</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">scales</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">200</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="k">for</span> <span class="n">scale</span> <span class="ow">in</span> <span class="n">scales</span><span class="p">:</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">alpha</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">gamma</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>
    <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"scale = </span><span class="si">{</span><span class="n">scale</span><span class="si">}</span><span class="s2">"</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>

<span class="n">ax3</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x12b893b80&gt;
</pre></div>
</div>
<img alt="../../_images/dist_106_1.png" src="../../_images/dist_106_1.png"/>
</div>
</div>
</section>
<section id="id56">
<h4>ユースケース<a class="headerlink" href="#id56" title="Permalink to this headline">#</a></h4>
<ul class="simple">
<li><p>工事中</p></li>
</ul>
</section>
</section>
<section id="id57">
<h3>例 3.6 (ベータ分布)<a class="headerlink" href="#id57" title="Permalink to this headline">#</a></h3>
<section id="id58">
<h4>確率密度関数<a class="headerlink" href="#id58" title="Permalink to this headline">#</a></h4>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p><strong>ベータ分布</strong> (Beta distribution) は <span class="math notranslate nohighlight">\((0, 1)\)</span> 上の確率分布で <span class="math notranslate nohighlight">\(\alpha &gt; 0, \beta &gt; 0\)</span> としたときに以下の確率分布で表現できる.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        f(x) = \begin{cases}
            \dfrac{x^{\alpha -1} (1-x)^{\beta - 1}}{ B(\alpha, \beta)}  &amp; (0 &lt; x &lt; 1) \\
            0 &amp; (\text{Otherwise})
        \end{cases}
    \end{align}
\end{split}\]</div>
<p>ここで <span class="math notranslate nohighlight">\(B(\alpha, \beta)\)</span> は以下で定義され<strong>ベータ関数</strong>と呼ぶ.</p>
<div class="math notranslate nohighlight">
\[
    \begin{align}
        B(\alpha, \beta) = \int_{0}^{1}{x^{\alpha-1}(1-x)^{\beta-1}dx}
    \end{align}
\]</div>
</div>
<p>ここで<a class="reference internal" href="rvs.html#continuous-distribution"><span class="std std-ref">連続型の確率分布の性質</span></a>を確認する. 確率密度関数の定義から <span class="math notranslate nohighlight">\(f(x) \geq 0\)</span> であることは自明. また合計和が 1 になることについては</p>
<div class="math notranslate nohighlight">
\[
    \int_{0}^{1}{ \frac{ x^{\alpha - 1}(1-x)^{\beta - 1} }{B(\alpha, \beta)} dx} = \frac{1}{B(\alpha, \beta)} \int_{0}^{1}{ x^{\alpha - 1}(1-x)^{\beta - 1} dx} = \frac{1}{B(\alpha, \beta)} \times B(\alpha, \beta) = 1
\]</div>
<p>から分かる.</p>
</section>
<section id="id59">
<h4>期待値と分散<a class="headerlink" href="#id59" title="Permalink to this headline">#</a></h4>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        &amp; {\rm E}(X) = \frac{\alpha}{\alpha + \beta} \\
        &amp; {\rm Var}(X) = \frac{\alpha \beta}{(\alpha + \beta)^2(\alpha + \beta + 1)}
    \end{align}
\end{split}\]</div>
</div>
<p><u>証明</u><br/>
　<a class="reference internal" href="rvs.html#expectation"><span class="std std-ref">期待値の定義</span></a>と<a class="reference internal" href="#beta-function"><span class="std std-ref">ベータ関数の性質(4)</span></a> から</p>
<div class="math notranslate nohighlight">
\[
    B(\alpha, \beta) = \frac{\alpha + \beta}{\alpha}B(\alpha + 1, \beta)
\]</div>
<p>を利用して,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm E}(X) &amp;= \int_{0}^{1}{ x \frac{x^{\alpha -1} (1-x)^{\beta - 1}}{ B(\alpha, \beta)} dx } \\
                   &amp;= \int_{0}^{1}{ \frac{\alpha}{\alpha + \beta} \frac{x^{\alpha} (1-x)^{\beta - 1}}{ B(\alpha + 1, \beta)} dx } \\
                   &amp;= \frac{\alpha}{\alpha + \beta}
    \end{align}
\end{split}\]</div>
<p>と求められる. また分散について<a class="reference internal" href="rvs.html#expect-variance"><span class="std std-ref">分散と期待値の関係式</span></a>から <span class="math notranslate nohighlight">\(E(X^2)\)</span> を求めればよく, 期待値を求めるときと同じようにする. ただし<a class="reference internal" href="#beta-function"><span class="std std-ref">ベータ関数の性質(4)</span></a> から</p>
<div class="math notranslate nohighlight">
\[
    B(\alpha, \beta) = \frac{\alpha + \beta}{\alpha}B(\alpha + 1, \beta) = \frac{(\alpha + \beta)(\alpha + \beta + 1)}{(\alpha)(\alpha + 1)}B(\alpha + 2, \beta) 
\]</div>
<p>であることを注意して</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm E}(X^2) &amp;= \int_{0}^{1}{ x^2 \frac{x^{\alpha -1} (1-x)^{\beta - 1}}{ B(\alpha, \beta)} dx } \\
                     &amp;= \int_{0}^{1}{ \frac{\alpha(\alpha + 1)}{(\alpha + \beta)(\alpha + \beta + 1)} \frac{x^{\alpha + 1} (1-x)^{\beta - 1}}{ B(\alpha + 2, \beta)} dx } \\
                     &amp;= \frac{\alpha(\alpha + 1)}{(\alpha + \beta)(\alpha + \beta + 1)}
    \end{align}
\end{split}\]</div>
<p>なので</p>
<div class="math notranslate nohighlight">
\[
    \begin{align}
        {\rm Var}(X) = \frac{\alpha(\alpha + 1)}{(\alpha + \beta)(\alpha + \beta + 1)} - \frac{\alpha^2}{(\alpha + \beta)^2} = \frac{\alpha \beta}{(\alpha + \beta)^2(\alpha + \beta + 1)}.
    \end{align}
\]</div>
</section>
<section id="id60">
<h4>命題 3.6.1 (ベータ関数の性質)<a class="headerlink" href="#id60" title="Permalink to this headline">#</a></h4>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p id="beta-function"><u>ベータ関数の性質</u></p>
<p><span class="math notranslate nohighlight">\(\alpha &gt; 0, \beta &gt; 0\)</span> とする. 以下の 8 性質を満たす.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        &amp;\text{性質(1)} \quad \quad B(\alpha, \beta) = B(\beta, \alpha) \\
        &amp;\text{性質(2)} \quad \quad \alpha B(\alpha, \beta + 1) = \beta B(\alpha + 1, \beta)  \\
        &amp;\text{性質(3)} \quad \quad B(\alpha, \beta) = B(\alpha + 1, \beta) + B(\alpha, \beta + 1) \\
        &amp;\text{性質(4)} \quad \quad (\alpha + \beta)B(\alpha + 1, \beta) = \alpha B(\alpha, \beta) \\
        &amp;\text{性質(5)} \quad \quad (\alpha + \beta)B(\alpha, \beta + 1) = \beta B(\alpha, \beta) \\
        &amp;\text{性質(6)} \quad \quad B(\alpha, \beta) = 2 \int_{0}^{\pi / 2}{\sin^{2\alpha -1}{\theta} \cos^{2\beta -1}{\theta} d\theta} \\
        &amp;\text{性質(7)} \quad \quad B(\alpha, \beta) = \frac{1}{2^{x + y -1}} \int_{-1}^{1}{(1+t)^{\alpha -1} (1-t)^{\beta -1} dt} \\
        &amp;\text{性質(8)} \quad \quad B(1, x) = (x, 1) = \frac{1}{x}
    \end{align}
\end{split}\]</div>
</div>
<p><u>証明</u><br/>
　性質(1) はベータ関数の定義において <span class="math notranslate nohighlight">\(y = 1 - x\)</span> と置換積分すると</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        B(\alpha, \beta) &amp;= \int_{0}^{1}{x^{\alpha-1}(1-x)^{\beta-1}dx} \\
                         &amp;= \int_{1}^{0}{(1-y)^{\alpha-1}y^{\beta-1}(-dy)} \\
                         &amp;= \int_{0}^{1}{(1-y)^{\alpha-1}y^{\beta-1}(dy)} \\
                         &amp;= B(\beta, \alpha).
    \end{align}
\end{split}\]</div>
<p>性質(2)については部分積分を用いて</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        \alpha B(\alpha, \beta + 1) &amp;= \alpha \int_{0}^{1}{x^{\alpha-1}(1-x)^{\beta}dx} \\
                                    &amp;= \biggl[ x^{alpha}(1-x)^{\beta} \biggr]_{0}^{1} + \beta \int_{0}^{1}{x^{\alpha}(1-x)^{\beta-1}dx} \\
                                    &amp;= \beta B(\alpha + 1, \beta).
    \end{align}
\end{split}\]</div>
<p>性質(3)については</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        B(\alpha, \beta + 1) &amp;= \int_{0}^{1}{x^{\alpha-1}(1-x)^{\beta}dx} \\
                             &amp;= \int_{0}^{1}{x^{\alpha-1}(1-x)^{\beta-1}(1-x)dx} \\
                             &amp;= \int_{0}^{1}{x^{\alpha-1}(1-x)^{\beta-1}dx} - \int_{0}^{1}{x^{\alpha}(1-x)^{\beta-1}dx} \\
                             &amp;= B(\alpha, \beta) - B(\alpha + 1, \beta).
    \end{align}
\end{split}\]</div>
<p>よって</p>
<div class="math notranslate nohighlight">
\[
    \begin{align}
        B(\alpha, \beta) = B(\alpha + 1, \beta) + B(\alpha, \beta + 1).
    \end{align}
\]</div>
<p>性質(4)は性質(3)に対して性質(2)の <span class="math notranslate nohighlight">\(\alpha B(\alpha, \beta + 1) = \beta B(\alpha + 1, \beta)\)</span> を適用して</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        B(\alpha, \beta) &amp;= B(\alpha + 1, \beta) + B(\alpha, \beta + 1) \\
                         &amp;= B(\alpha + 1, \beta) + \frac{\beta}{\alpha} B(\alpha + 1, \beta).
    \end{align}
\end{split}\]</div>
<p>両辺を <span class="math notranslate nohighlight">\(\alpha\)</span> でかけて, <span class="math notranslate nohighlight">\((\alpha + \beta)B(\alpha + 1, \beta) = \alpha B(\alpha, \beta)\)</span> となる. 性質(5)についても同様にすれば求められる.
　性質(6)について積分変数 <span class="math notranslate nohighlight">\(x\)</span> について区間 <span class="math notranslate nohighlight">\((0, 1)\)</span> より <span class="math notranslate nohighlight">\(x = \sin^{2}{\theta}\)</span> とおくことができ, この時, <span class="math notranslate nohighlight">\(x: 0 \rightarrow 1 \Rightarrow \theta: 0 \rightarrow \pi / 2\)</span> となる. また <span class="math notranslate nohighlight">\(dx = 2\sin{\theta} \cos{\theta} d\theta\)</span> から</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        B(\alpha, \beta) &amp;= \int_{0}^{1}{x^{\alpha-1}(1-x)^{\beta-1}dx} \\
                         &amp;= \int_{0}^{\pi / 2}{\sin^{2\alpha-2}{\theta} \cos^{2\beta-2}{\theta}(2\sin{\theta} \cos{\theta} d\theta)} \\
                         &amp;= 2 \int_{0}^{\pi / 2}{\sin^{2\alpha -1}{\theta} \cos^{2\beta -1}{\theta} d\theta}
    \end{align}
\end{split}\]</div>
<p>となる.<br/>
　性質(7)は <span class="math notranslate nohighlight">\(t = 2x - 1\)</span> と置換積分すると</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        B(\alpha, \beta) &amp;= \int_{0}^{1}{x^{\alpha-1}(1-x)^{\beta-1}dx} \\
                         &amp;= \int_{-1}^{1}{ \biggl( \frac{1+t}{2} \biggr)^{\alpha - 1} \biggl( \frac{1-t}{2} \biggr)^{\beta - 1} \frac{dt}{2} } \\
                         &amp;= \frac{1}{2^{x + y -1}} \int_{-1}^{1}{(1+t)^{\alpha -1} (1-t)^{\beta -1} dt}.
    \end{align}
\end{split}\]</div>
<p>最後の性質(8)について, 性質(1)から <span class="math notranslate nohighlight">\(B(1,x) = B(x, 1)\)</span> で</p>
<div class="math notranslate nohighlight">
\[
    B(x, 1) = \int_{0}^{1}{t^{x - 1}dt} = \biggl[ \frac{t^x}{x} \biggr]_{0}^{1} = \frac{1}{x}
\]</div>
<p>となり, すべての性質の証明が完了した.</p>
</section>
<section id="python-example-beta">
<span id="id61"></span><h4>Python での確認<a class="headerlink" href="#python-example-beta" title="Permalink to this headline">#</a></h4>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.beta.html#scipy.stats.beta">SciPy ( <code class="docutils literal notranslate"><span class="pre">scipy.stats.beta</span></code> )</a></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">a</span></code>: <span class="math notranslate nohighlight">\(\alpha\)</span> に対応.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">b</span></code>: <span class="math notranslate nohighlight">\(\beta\)</span> に対応.</p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.Generator.beta.html">NumPy ( <code class="docutils literal notranslate"><span class="pre">numpy.random.Generator.beta</span></code> )</a></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">a</span></code>: <span class="math notranslate nohighlight">\(\alpha\)</span> に対応.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">b</span></code>: <span class="math notranslate nohighlight">\(\beta\)</span> に対応.</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># a = b = 2 に関するベータ分布に従った疑似乱数を size = 10000 だけ生成.</span>
<span class="n">a</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">b</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">10000</span>

<span class="c1"># SciPy</span>
<span class="n">rvs</span> <span class="o">=</span> <span class="n">beta</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">b</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="s2">"&gt; SciPy"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="n">rvs</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">20</span><span class="p">])</span>

<span class="c1"># NumPy</span>
<span class="n">rvs_numpy</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">beta</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">b</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="s2">"&gt; NumPy"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="n">rvs_numpy</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">20</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&gt; SciPy
[0.65898526 0.17535193 0.63510432 0.20184464 0.55761487 0.10772261
 0.13597561 0.04865741 0.68178079 0.42339811 0.84496096 0.74399891
 0.40207685 0.45913811 0.64860137 0.16443494 0.39919261 0.85037443
 0.49662867 0.09003993]
&gt; NumPy
[0.93087954 0.74899741 0.30751639 0.71153283 0.62772403 0.61065053
 0.75457861 0.89006778 0.80690722 0.69183883 0.36384558 0.29730531
 0.70650045 0.50217585 0.91344663 0.25126299 0.77553117 0.1258913
 0.55598938 0.63912477]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 期待値・分散の理論値</span>
<span class="n">exp_true</span> <span class="o">=</span> <span class="n">beta</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">b</span><span class="p">)</span>
<span class="n">var_true</span> <span class="o">=</span> <span class="n">beta</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">b</span><span class="p">)</span>

<span class="c1"># 擬似乱数から期待値・分散の計算</span>
<span class="n">exp_rvs</span><span class="p">,</span> <span class="n">var_rvs</span> <span class="o">=</span> <span class="n">calculate_stats</span><span class="p">(</span><span class="n">rvs</span><span class="p">)</span>

<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="s2">"&gt; SciPy"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="sa">f</span><span class="s2">"期待値(乱数 vs 真値): </span><span class="si">{</span><span class="n">exp_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">exp_true</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="sa">f</span><span class="s2">"分散(乱数 vs 真値): </span><span class="si">{</span><span class="n">var_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">var_true</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

<span class="n">exp_rvs</span><span class="p">,</span> <span class="n">var_rvs</span> <span class="o">=</span> <span class="n">calculate_stats</span><span class="p">(</span><span class="n">rvs_numpy</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="s2">"&gt; NumPy"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="sa">f</span><span class="s2">"期待値(乱数 vs 真値): </span><span class="si">{</span><span class="n">exp_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">exp_true</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#print" title="print"><span class="nb">print</span></a><span class="p">(</span><span class="sa">f</span><span class="s2">"分散(乱数 vs 真値): </span><span class="si">{</span><span class="n">var_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">var_true</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&gt; SciPy
期待値(乱数 vs 真値): 0.4989513562261097 vs 0.5
分散(乱数 vs 真値): 0.05090058535753038 vs 0.05
&gt; NumPy
期待値(乱数 vs 真値): 0.5029001390905479 vs 0.5
分散(乱数 vs 真値): 0.049777506332921204 vs 0.05
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 確率変数 x を渡すことで, それぞれに対応する確率密度関数の値を取得できる.</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">beta</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">b</span><span class="p">)</span>

<span class="c1"># 擬似乱数によるヒストグラムと確率密度関数の値を図示.</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span>
    <span class="p">[</span><span class="n">rvs</span><span class="p">,</span> <span class="n">rvs_numpy</span><span class="p">],</span>
    <span class="n">bins</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
    <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="s2">"blue"</span><span class="p">,</span> <span class="s2">"green"</span><span class="p">],</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="p">[</span><span class="s2">"SciPy"</span><span class="p">,</span> <span class="s2">"NumPy"</span><span class="p">],</span>
<span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"PDF"</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">"red"</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Beta Distribution"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, 'Beta Distribution')
</pre></div>
</div>
<img alt="../../_images/dist_115_1.png" src="../../_images/dist_115_1.png"/>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># a, b を動かした時の波形の違い.</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

<span class="n">params</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">)]</span>
<span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">params</span><span class="p">:</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">beta</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">b</span><span class="p">)</span>
    <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"alpha = </span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s2">, beta = </span><span class="si">{</span><span class="n">b</span><span class="si">}</span><span class="s2">"</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x12b57d570&gt;
</pre></div>
</div>
<img alt="../../_images/dist_116_1.png" src="../../_images/dist_116_1.png"/>
</div>
</div>
</section>
<section id="id62">
<h4>ユースケース<a class="headerlink" href="#id62" title="Permalink to this headline">#</a></h4>
<ul class="simple">
<li><p>工事中</p></li>
</ul>
</section>
</section>
</section>
</section>
<script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./analytics/distribution"
        },
        predefinedOutput: true
    }
    </script>
<script>kernelName = 'python3'</script>
</div>
</main>
<footer class="footer-article noprint">
<!-- Previous / next buttons -->
<div class="prev-next-area">
<a class="left-prev" href="rvs.html" id="prev-link" title="previous page">
<i class="fas fa-angle-left"></i>
<div class="prev-next-info">
<p class="prev-next-subtitle">previous</p>
<p class="prev-next-title">確率変数</p>
</div>
</a>
<a class="right-next" href="mdist.html" id="next-link" title="next page">
<div class="prev-next-info">
<p class="prev-next-subtitle">next</p>
<p class="prev-next-title">多変量確率分布</p>
</div>
<i class="fas fa-angle-right"></i>
</a>
</div>
</footer>
</div>
</div>
<div class="footer-content row">
<footer class="col footer"><p>
  
    By Yuta<br/>
  
      © Copyright 2022.<br/>
</p>
</footer>
</div>
</div>
</div>
</div>
<!-- Scripts loaded after <body> so the DOM is not blocked -->
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
</body>
</html>