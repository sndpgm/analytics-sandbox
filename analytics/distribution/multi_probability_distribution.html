
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>多変量確率分布 &#8212; Analytics Study Blog</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="時系列データ" href="../tsa/time_series.html" />
    <link rel="prev" title="確率分布" href="probability_distribution.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Analytics Study Blog</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Welcome to my Analytics Sandbox
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  確率変数と確率分布
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="random_variables.html">
   確率変数
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="probability_distribution.html">
   確率分布
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   多変量確率分布
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  時系列モデリング
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../tsa/time_series.html">
   時系列データ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tsa/arma.html">
   ARMAモデル系
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tsa/arima.html">
   ARIMAモデル
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tsa/state_space_model.html">
   状態空間モデル
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  補足
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../math/calculus.html">
   微分積分学
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../math/linear_algebra.html">
   線形代数学
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/sndpgm/analytics-sandbox/main?urlpath=tree/docs/analytics/distribution/multi_probability_distribution.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/sndpgm/analytics-sandbox"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/sndpgm/analytics-sandbox/issues/new?title=Issue%20on%20page%20%2Fanalytics/distribution/multi_probability_distribution.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../_sources/analytics/distribution/multi_probability_distribution.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id2">
   1. 多変量確率ベクトルと同時分布関数
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     定義 1.1 (離散型の同時分布)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#multi-discrete-distribution-example1">
     例 1.2 (2つのサイコロの出る目)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id5">
     定義 1.3 (連続型の同時分布)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#multi-continuous-distribution-example1">
     例 1.4 (線形和によって表現される同時密度関数)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id7">
   2. 期待値と分散
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#multi-expectation">
     定義 2.1 (期待値)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#multi-expectation-property">
     命題 2.2 (期待値の性質)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#multi-variance">
     定義 2.3 (分散共分散)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#multi-variance-property">
     命題 2.4 (共分散行列の性質)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id12">
     命題 2.5 (分散共分散行列の定値性)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id13">
     命題 2.6 (分散共分散行列のコレスキー分解)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id14">
     例 2.7 (コレスキー分解を用いた多変数正規分布乱数の生成)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id15">
   3. 周辺分布と条件付分布
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#marginal-distribution">
     定義 3.1 (周辺分布関数)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id17">
     例 3.2 (2つのサイコロの出る目の周辺分布)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id18">
     例 3.3 (線形和によって表現される同時密度関数の周辺分布)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#conditional-distribution">
     定義 3.4 (条件付分布)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id20">
     定義 3.5 (ベイズの定理)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#multi-conditional-expectation">
     定義 3.6 (条件付期待値)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#conditional-expectation-property">
     命題 3.7 (条件付期待値の性質)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#multi-conditional-variance-covariance">
     定義 3.8 (条件付分散共分散)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#conditional-variance-property">
     命題 3.9 (条件付分散の性質)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id25">
   4. 多変量確率分布
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id26">
     例 4.1 (多項分布)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id27">
     例 4.2 (多変量正規分布)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id28">
     例 4.3 (ディリクレ分布)
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>多変量確率分布</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id2">
   1. 多変量確率ベクトルと同時分布関数
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     定義 1.1 (離散型の同時分布)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#multi-discrete-distribution-example1">
     例 1.2 (2つのサイコロの出る目)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id5">
     定義 1.3 (連続型の同時分布)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#multi-continuous-distribution-example1">
     例 1.4 (線形和によって表現される同時密度関数)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id7">
   2. 期待値と分散
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#multi-expectation">
     定義 2.1 (期待値)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#multi-expectation-property">
     命題 2.2 (期待値の性質)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#multi-variance">
     定義 2.3 (分散共分散)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#multi-variance-property">
     命題 2.4 (共分散行列の性質)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id12">
     命題 2.5 (分散共分散行列の定値性)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id13">
     命題 2.6 (分散共分散行列のコレスキー分解)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id14">
     例 2.7 (コレスキー分解を用いた多変数正規分布乱数の生成)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id15">
   3. 周辺分布と条件付分布
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#marginal-distribution">
     定義 3.1 (周辺分布関数)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id17">
     例 3.2 (2つのサイコロの出る目の周辺分布)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id18">
     例 3.3 (線形和によって表現される同時密度関数の周辺分布)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#conditional-distribution">
     定義 3.4 (条件付分布)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id20">
     定義 3.5 (ベイズの定理)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#multi-conditional-expectation">
     定義 3.6 (条件付期待値)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#conditional-expectation-property">
     命題 3.7 (条件付期待値の性質)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#multi-conditional-variance-covariance">
     定義 3.8 (条件付分散共分散)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#conditional-variance-property">
     命題 3.9 (条件付分散の性質)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id25">
   4. 多変量確率分布
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id26">
     例 4.1 (多項分布)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id27">
     例 4.2 (多変量正規分布)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id28">
     例 4.3 (ディリクレ分布)
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="id1">
<h1>多変量確率分布<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h1>
<section id="id2">
<h2>1. 多変量確率ベクトルと同時分布関数<a class="headerlink" href="#id2" title="Permalink to this headline">#</a></h2>
<section id="id3">
<h3>定義 1.1 (離散型の同時分布)<a class="headerlink" href="#id3" title="Permalink to this headline">#</a></h3>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p><span class="math notranslate nohighlight">\(n\)</span> 個の離散型の確率変数 <span class="math notranslate nohighlight">\(X = [X_1 \cdots X_n]'\)</span> について, <span class="math notranslate nohighlight">\(x = [x_1 \dots x_n]'\)</span> とし</p>
<div class="math notranslate nohighlight">
\[
    {\rm P}(X = x) = f_X(x) =f_X(x_1, \dots, x_n)
\]</div>
<p>を <strong>同時確率関数</strong> (joint probability mass function) という. このとき関数 <span class="math notranslate nohighlight">\(f_X\)</span> は</p>
<div class="math notranslate nohighlight" id="multi-discrete-distribution">
\[\begin{split}
    \begin{align}
        &amp; f_X(x) = f_X(x_1, \dots, x_n) \geq 0 \\
        &amp; \sum_{ x }{ f_X(x) } = \sum_{ i }{ \sum_{ j }{ \cdots \sum_{ k }{ f_X(x_{1i}, x_{2j}, \dots, x_{nk}) } } } = 1
    \end{align}
\end{split}\]</div>
<p>を満たす.</p>
</div></section>
<section id="multi-discrete-distribution-example1">
<span id="id4"></span><h3>例 1.2 (2つのサイコロの出る目)<a class="headerlink" href="#multi-discrete-distribution-example1" title="Permalink to this headline">#</a></h3>
<p>2 つのサイコロの目 <span class="math notranslate nohighlight">\(P, Q\)</span> の大きい方, 小さい方をそれぞれ <span class="math notranslate nohighlight">\(X_1 = \max{(P, Q)}\)</span>, <span class="math notranslate nohighlight">\(X_2 = \min{(P, Q)}\)</span> とする. ただし <span class="math notranslate nohighlight">\(x \geq y\)</span> のとき <span class="math notranslate nohighlight">\(\max{(x, y)} = x\)</span>, <span class="math notranslate nohighlight">\(\min{(x, y)} = y\)</span> である. このとき <span class="math notranslate nohighlight">\(X_1 = x_1\)</span> かつ <span class="math notranslate nohighlight">\(X_2 = x_2\)</span> となる確率 <span class="math notranslate nohighlight">\(f_{X_1, X_2}(x_1, x_2)\)</span> とする. このとき以下の確率表となる.</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:center head"><p></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(X_1\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(1\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(2\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(3\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(4\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(5\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(6\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:center"><p><span class="math notranslate nohighlight">\(X_2\)</span></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p><span class="math notranslate nohighlight">\(1\)</span></p></td>
<td><p></p></td>
<td><p><span class="math notranslate nohighlight">\(1/36\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(2/36\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(2/36\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(2/36\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(2/36\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(2/36\)</span></p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p><span class="math notranslate nohighlight">\(2\)</span></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p><span class="math notranslate nohighlight">\(1/36\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(2/36\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(2/36\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(2/36\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(2/36\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p><span class="math notranslate nohighlight">\(3\)</span></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p><span class="math notranslate nohighlight">\(1/36\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(2/36\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(2/36\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(2/36\)</span></p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p><span class="math notranslate nohighlight">\(4\)</span></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p><span class="math notranslate nohighlight">\(1/36\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(2/36\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(2/36\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p><span class="math notranslate nohighlight">\(5\)</span></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p><span class="math notranslate nohighlight">\(1/36\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(2/36\)</span></p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p><span class="math notranslate nohighlight">\(6\)</span></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p><span class="math notranslate nohighlight">\(1/36\)</span></p></td>
</tr>
</tbody>
</table>
<p>よって <span class="math notranslate nohighlight">\(f(x_1, x_2) \geq 0\)</span> であり,</p>
<div class="math notranslate nohighlight">
\[
    \sum_{x_1=1}^{6}{ \sum_{x_2=1}^{6}{f_{X_1, X_2}(x_1, x_2)} } = 1.
\]</div>
</section>
<section id="id5">
<h3>定義 1.3 (連続型の同時分布)<a class="headerlink" href="#id5" title="Permalink to this headline">#</a></h3>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p><span class="math notranslate nohighlight">\(n\)</span> 個の連続型の確率変数 <span class="math notranslate nohighlight">\(X=[X_1 \cdots X_n]'\)</span> について <span class="math notranslate nohighlight">\(X \in \mathbb{X}\)</span> となる確率が以下で定義されるとする.</p>
<div class="math notranslate nohighlight">
\[
    {\rm P}(X \in \mathbb{X}) = \int_{x \in \mathbb{X}}{f_X(x)dx} = \int_{x \in \mathbb{X}}{f_X(x_1, \dots, x_n)dx_1 \dots dx_n}
\]</div>
<p>このとき <span class="math notranslate nohighlight">\(f\)</span> は <strong>同時密度関数</strong> (joint probability density function) といい</p>
<div class="math notranslate nohighlight" id="multi-continuous-distribution">
\[\begin{split}
    \begin{align}
        &amp; f(x) = f_X(x_1, \dots, x_n) \geq 0 \\
        &amp; \int_{x}{f_X(x)dx} = \int_{x_1}{ \cdots \int_{x_n}{ f_X(x_1, \dots, x_n)dx_n \dots dx_1 } } = 1 
    \end{align}
\end{split}\]</div>
<p>である.</p>
</div></section>
<section id="multi-continuous-distribution-example1">
<span id="id6"></span><h3>例 1.4 (線形和によって表現される同時密度関数)<a class="headerlink" href="#multi-continuous-distribution-example1" title="Permalink to this headline">#</a></h3>
<p>以下の同時密度関数が与えられたとする.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        f_{X, Y}(x, y) = \begin{cases}
            x + y &amp;(0 \leq x, y \leq 1) \\
            0     &amp;(\text{otherwise})
        \end{cases}
    \end{align}
\end{split}\]</div>
<p><span class="math notranslate nohighlight">\(0 \leq x \leq \dfrac{1}{2}\)</span>, <span class="math notranslate nohighlight">\(0 \leq y \leq \dfrac{1}{4}\)</span> となる確率は</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        P \biggl(0 \leq x \leq \frac{1}{2}, 0 \leq y \leq \frac{1}{4} \biggr)
            &amp;= \int_{0}^{1/4}{ \int_{0}^{1/2}{(x + y)dx}dy } \\
            &amp;= \int_{0}^{1/4}{ \biggl[ \frac{1}{2}x^2 + xy \biggr]_{0}^{1/2} dy } \\
            &amp;= \int_{0}^{1/4}{ \biggl( \frac{1}{8} + \frac{1}{2}y \biggr) dy } \\
            &amp;= \biggl[ \frac{1}{8}y + \frac{1}{4}y^2 \biggr]_{0}^{1/4} \\
            &amp;= \frac{3}{64}
    \end{align}
\end{split}\]</div>
<p>となる.<br />
　もちろん <span class="math notranslate nohighlight">\(f(x, y) \geq 0\)</span> で</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        \int_{0}^{1}{ \int_{0}^{1}{(x + y)dx}dy }
            &amp;= \int_{0}^{1}{ \biggl[ \frac{1}{2}x^2 + xy \biggr]_{0}^{1} dy } \\
            &amp;= \int_{0}^{1}{ \biggl( \frac{1}{2} + y \biggr) dy } \\
            &amp;= \biggl[ \frac{1}{2}y + \frac{1}{2}y^2 \biggr]_{0}^{1} \\
            &amp;= 1.
    \end{align}
\end{split}\]</div>
</section>
</section>
<section id="id7">
<h2>2. 期待値と分散<a class="headerlink" href="#id7" title="Permalink to this headline">#</a></h2>
<p>以下では明示的に行列やベクトル作用の場合の期待値, 分散, 共分散を示すときはそれぞれ <span class="math notranslate nohighlight">\(\mathbb{E}, \mathbb{Var}, \mathbb{Cov}\)</span>, スカラーに作用する場合には <span class="math notranslate nohighlight">\({\rm E}, {\rm Var}, {\rm Cov}\)</span> とする.</p>
<section id="multi-expectation">
<span id="id8"></span><h3>定義 2.1 (期待値)<a class="headerlink" href="#multi-expectation" title="Permalink to this headline">#</a></h3>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p><span class="math notranslate nohighlight">\(n\)</span> 個の確率変数 <span class="math notranslate nohighlight">\(X=[X_1 \cdots X_n]'\)</span> について以下で期待値が定義できる.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \mathbb{E}(X) = \begin{bmatrix}
            {\rm E}(X_1) \\
            \vdots       \\
            {\rm E}(X_n) 
    \end{bmatrix}
\end{split}\]</div>
<p><strong>平均ベクトル</strong> (mean vector) といい, 各成分の期待値スカラー <span class="math notranslate nohighlight">\({\rm E}(X_i)\)</span> は<a class="reference internal" href="random_variables.html#expectation"><span class="std std-ref">1変量の期待値の定義</span></a>の通り.<br />
　また一般に <span class="math notranslate nohighlight">\(p \times q\)</span> 行列値関数 <span class="math notranslate nohighlight">\(\phi\)</span> を用いて <span class="math notranslate nohighlight">\(\phi(X)\)</span> についても同様に期待値は定義できる.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \mathbb{E}(\phi(X)) = \begin{bmatrix}
            \mathbb{E}(\phi_{11}(X)) &amp; \cdots &amp; \mathbb{E}(\phi_{1q}(X)) \\
            \vdots                &amp; \ddots &amp; \vdots                \\
            \mathbb{E}(\phi_{p1}(X)) &amp; \cdots &amp; \mathbb{E}(\phi_{pq}(X))
    \end{bmatrix}
\end{split}\]</div>
<p>上記から分かる通り <span class="math notranslate nohighlight">\(np \times q\)</span> 行列となる.</p>
</section>
<section id="multi-expectation-property">
<span id="id9"></span><h3>命題 2.2 (期待値の性質)<a class="headerlink" href="#multi-expectation-property" title="Permalink to this headline">#</a></h3>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p><span class="math notranslate nohighlight">\(X, X_1, X_2\)</span> をそれぞれ <span class="math notranslate nohighlight">\(n\)</span> 次元確率ベクトル, <span class="math notranslate nohighlight">\(A\)</span> は <span class="math notranslate nohighlight">\(p \times n\)</span> 行列, <span class="math notranslate nohighlight">\(a\)</span> は <span class="math notranslate nohighlight">\(n\)</span> 次元定数ベクトルとすると以下が成立する.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        &amp;\text{性質(1)} \quad \mathbb{E}(X + a) = \mathbb{E}(X) + a \\
        &amp;\text{性質(2)} \quad \mathbb{E}(AX) = A\mathbb{E}(X)  \\
        &amp;\text{性質(3)} \quad \mathbb{E}(X_1 + X_2) = \mathbb{E}(X_1) + \mathbb{E}(X_2)
    \end{align}
\end{split}\]</div>
</div></section>
<section id="multi-variance">
<span id="id10"></span><h3>定義 2.3 (分散共分散)<a class="headerlink" href="#multi-variance" title="Permalink to this headline">#</a></h3>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p><span class="math notranslate nohighlight">\(n\)</span> 次元確率ベクトル <span class="math notranslate nohighlight">\(X=[X_1 \cdots X_n]'\)</span> と <span class="math notranslate nohighlight">\(m\)</span> 次元確率ベクトル <span class="math notranslate nohighlight">\(Y=[Y_1 \cdots Y_m]'\)</span> の 2 つの確率ベクトルに対して, <span class="math notranslate nohighlight">\(X\)</span> と <span class="math notranslate nohighlight">\(Y\)</span> の <strong>共分散行列</strong> (covariance matrix) を以下のように定義する.</p>
<div class="math notranslate nohighlight">
\[
    \mathbb{Cov}(X, Y) = \mathbb{E}[ (X - \mathbb{E}[X])(Y - \mathbb{E}[Y])' ]
\]</div>
<p>特に, <span class="math notranslate nohighlight">\(\mathbb{Var}(X) = \mathbb{Cov}(X, X)\)</span> を <span class="math notranslate nohighlight">\(X\)</span> の <strong>分散共分散行列</strong> (variance-covariance matrix) と呼ぶ. つまり,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \mathbb{Var}(X) = \mathbb{E}[ (X - \mathbb{E}[X])(X - \mathbb{E}[X])' ] = \begin{bmatrix}
            {\rm Cov}(X_1, X_1) &amp; {\rm Cov}{X_1, X_2} &amp; \cdots &amp; {\rm Cov}(X_1, X_n) \\
            {\rm Cov}(X_2, X_1) &amp; {\rm Cov}{X_2, X_2} &amp; \cdots &amp; {\rm Cov}(X_2, X_n) \\
            \vdots              &amp; \vdots              &amp; \ddots &amp; \vdots              \\
            {\rm Cov}(X_n, X_1) &amp; {\rm Cov}{X_n, X_2} &amp; \cdots &amp; {\rm Cov}(X_n, X_n)
    \end{bmatrix} = \Sigma
\end{split}\]</div>
</section>
<section id="multi-variance-property">
<span id="id11"></span><h3>命題 2.4 (共分散行列の性質)<a class="headerlink" href="#multi-variance-property" title="Permalink to this headline">#</a></h3>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p><span class="math notranslate nohighlight">\(X, X_1, X_2\)</span> をそれぞれ <span class="math notranslate nohighlight">\(n\)</span> 次元確率ベクトル, <span class="math notranslate nohighlight">\(Y, Y_1, Y_2\)</span> をそれぞれ <span class="math notranslate nohighlight">\(m\)</span> 次元確率ベクトル, <span class="math notranslate nohighlight">\(A\)</span> は <span class="math notranslate nohighlight">\(p \times n\)</span> 行列, <span class="math notranslate nohighlight">\(B\)</span> は <span class="math notranslate nohighlight">\(q \times m\)</span> 行列, <span class="math notranslate nohighlight">\(a\)</span> を <span class="math notranslate nohighlight">\(n\)</span> 次元定数ベクトル, <span class="math notranslate nohighlight">\(b\)</span> を <span class="math notranslate nohighlight">\(m\)</span> 次元定数ベクトルとすると以下が成立する.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        &amp;\text{性質(1)} \quad \mathbb{Cov}(X + a, Y + b) = \mathbb{Cov}(X, Y)                          \\
        &amp;\text{性質(2)} \quad \mathbb{Cov}(AX, BY)       = A \mathbb{Cov}(X, Y) B'                     \\
        &amp;\text{性質(3)} \quad \mathbb{Cov}(X_1 + X_2, Y) = \mathbb{Cov}(X_1, Y) + \mathbb{Cov}(X_2, Y) \\
        &amp;\text{性質(4)} \quad \mathbb{Cov}(X, Y_1 + Y_2) = \mathbb{Cov}(X, Y_1) + \mathbb{Cov}(X, Y_2) \\
        &amp;\text{性質(5)} \quad \mathbb{Var}(X + a)        = \mathbb{Var}(X)                             \\
        &amp;\text{性質(6)} \quad \mathbb{Var}(AX)           = A \mathbb{Var}(X) A'
    \end{align}
\end{split}\]</div>
</div>
<p><u>証明</u><br />
　性質(1)</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        \mathbb{Cov}(X + a, Y + b) &amp;= \mathbb{E} [ (X + a - \mathbb{E}[X + a])(Y + b - \mathbb{E}[Y + b])' ] \\
                                   &amp;= \mathbb{E} [ (X + a - \mathbb{E}[X] - a)(Y + b - \mathbb{E}[Y] - b)' ] &amp;\quad (\text{期待値の性質(1)}) \\
                                   &amp;= \mathbb{E} [ (X - \mathbb{E}[X])(Y - \mathbb{E}[Y])' ] \\
                                   &amp;= \mathbb{Cov}(X, Y).
    \end{align}
\end{split}\]</div>
<p>性質(2)</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        \mathbb{Cov}(AX, BYb) &amp;= \mathbb{E} [ (AX - \mathbb{E}[AX])(BY - \mathbb{E}[BY])' ] \\
                              &amp;= \mathbb{E} [ AX - A\mathbb{E}[X])(BY - B\mathbb{E}[Y])' ] \quad (\text{期待値の性質(3)}) \\
                              &amp;= \mathbb{E} [ A(X - \mathbb{E}[X]) (Y - \mathbb{E}[Y])' B' ] \quad (\text{転置行列について} (PQ)' = Q'P') \\
                              &amp;= A \mathbb{E} [ (X - \mathbb{E}[X]) (Y - \mathbb{E}[Y])' ] B' \quad (\text{期待値の性質(3)}) \\
                              &amp;= A \mathbb{Cov}(X, Y) B'.
    \end{align}
\end{split}\]</div>
<p>性質(3)</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        \mathbb{Cov}(X_1 + X_2, Y) &amp;= \mathbb{E} [ (X_1 + X_2 - \mathbb{E}[X_1 + X_2])(Y - \mathbb{E}[Y])' ] \\
                                   &amp;= \mathbb{E} [ \{(X_1 - \mathbb{E} (X_1) \} + \{ X_2 - \mathbb{E}[X_2] \} )(Y - \mathbb{E}[Y])' ] \\
                                   &amp;= \mathbb{E} [ (X_1 - \mathbb{E} (X_1)) (Y - \mathbb{E}[Y])' + ( X_2 - \mathbb{E}[X_2] )(Y - \mathbb{E}[Y])' ] \\
                                   &amp;= \mathbb{E} [ (X_1 - \mathbb{E} (X_1)) (Y - \mathbb{E}[Y])' ] + \mathbb{E} [ ( X_2 - \mathbb{E}[X_2] )(Y - \mathbb{E}[Y])' ] \quad (\text{期待値の性質(4)}) \\
                                   &amp;= \mathbb{Cov}(X_1, Y) + \mathbb{Cov}(X_2, Y).
    \end{align}
\end{split}\]</div>
<p>性質(4)</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        \mathbb{Cov}(X, Y_1 + Y_2) &amp;= \mathbb{E} [ (X - \mathbb{E}[X])(Y_1 + Y_2 - \mathbb{E}[Y_1 + Y_2])' ] \\
                                   &amp;= \mathbb{E} [ (X - \mathbb{E}[X])\{(Y_1 - \mathbb{E} (Y_1) \} + \{ Y_2 - \mathbb{E}[Y_2] \} )' ] \\
                                   &amp;= \mathbb{E} [ (X - \mathbb{E}[X]) (Y_1 - \mathbb{E}[Y_1])' + ( X - \mathbb{E}[X] )(Y_2 - \mathbb{E}[Y_2])' ] \\
                                   &amp;= \mathbb{E} [ (X - \mathbb{E}[X]) (Y_1 - \mathbb{E}[Y_1])' ] + \mathbb{E} [ ( X - \mathbb{E}[X] )(Y_2 - \mathbb{E}[Y_2])' ] \quad (\text{期待値の性質(4)}) \\
                                   &amp;= \mathbb{Cov}(X, Y_1) + \mathbb{Cov}(X, Y_2).
    \end{align}
\end{split}\]</div>
<p>性質(5) は 性質(1) を用いて</p>
<div class="math notranslate nohighlight">
\[
    \begin{align}
        \mathbb{Var}(X + a) = \mathbb{Cov}[X + a, X + a] = \mathbb{Cov}[X, X] = \mathbb{Var}(X).
    \end{align}
\]</div>
<p>性質(6) は 性質(2) を用いて</p>
<div class="math notranslate nohighlight">
\[
    \begin{align}
        \mathbb{Var}(AX) = \mathbb{Cov}[AX, AX] = A \mathbb{Cov}[X, X] A' = A\mathbb{Var}(X)A'.
    \end{align}
\]</div>
</section>
<section id="id12">
<h3>命題 2.5 (分散共分散行列の定値性)<a class="headerlink" href="#id12" title="Permalink to this headline">#</a></h3>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p>分散行分散行列は半正定値行列である. すなわち, <span class="math notranslate nohighlight">\(n\)</span> 次元確率ベクトル <span class="math notranslate nohighlight">\(X\)</span>, <span class="math notranslate nohighlight">\(n\)</span> 次元定数実ベクトル <span class="math notranslate nohighlight">\(u\)</span> を用いて</p>
<div class="math notranslate nohighlight">
\[
    \langle u \mathbb{Var} (X), u \rangle = u' \mathbb{Var} (X) u \geq 0.
\]</div>
</div>
<p><u>証明</u></p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        u' \mathbb{Var} (X) u &amp;= u' \mathbb{E}[ (X - \mathbb{E}[X])(X - \mathbb{E}[X])' ] u \\
                              &amp;= \mathbb{E}[ u' (X - \mathbb{E}[X])(X - \mathbb{E}[X])' u ] \\
                              &amp;= \mathbb{E}[ \langle u, X - \mathbb{E}[X] \rangle \langle X - \mathbb{E}[X], u \rangle ] \\
                              &amp;= \mathbb{E}[ (\langle u, X - \mathbb{E}[X] \rangle)^2 ] \geq 0.
    \end{align}
\end{split}\]</div>
<p>等号成立は <span class="math notranslate nohighlight">\(\langle u, X - \mathbb{E}[X] \rangle = 0 \Leftrightarrow u'X = u' \mathbb{E}[X]\)</span> の時.</p>
</section>
<section id="id13">
<h3>命題 2.6 (分散共分散行列のコレスキー分解)<a class="headerlink" href="#id13" title="Permalink to this headline">#</a></h3>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p><span class="math notranslate nohighlight">\(\mathbb{Var}\)</span> が正則行列である時, <strong>コレスキー分解</strong> (Cholesky decomposition) により</p>
<div class="math notranslate nohighlight">
\[
    \mathbb{Var}(X) = LL'
\]</div>
<p>を満たす正則な下三角行列 <span class="math notranslate nohighlight">\(L\)</span> が一意に存在する.</p>
</div>
</section>
<section id="id14">
<h3>例 2.7 (コレスキー分解を用いた多変数正規分布乱数の生成)<a class="headerlink" href="#id14" title="Permalink to this headline">#</a></h3>
<p>分散共分散行列に対してコレスキー分解を行って算出された行列を用いて多変数正規分布に従った乱数を生成できる. 例えば, <span class="math notranslate nohighlight">\(X = (X_1 \cdots X_n)'\)</span> は互いに独立した標準正規分布 <span class="math notranslate nohighlight">\(N(0, 1)\)</span> に従っているものとする. すなわち, <span class="math notranslate nohighlight">\(i = 1, \cdots, n\)</span> で <span class="math notranslate nohighlight">\(X_i \sim N(0,1)\)</span> である. この時, <span class="math notranslate nohighlight">\(n\)</span> 次元の平均ベクトル <span class="math notranslate nohighlight">\(\mu\)</span>, <span class="math notranslate nohighlight">\(n \times n\)</span> 分散共分散行列 <span class="math notranslate nohighlight">\(V\)</span> の多変数正規分布の乱数 <span class="math notranslate nohighlight">\(Z = (Z_1 \cdots Z_n)'\)</span> を生成する. <span class="math notranslate nohighlight">\(V = LL'\)</span> とコレスキー分解した時,</p>
<div class="math notranslate nohighlight">
\[
    Z = \mu + LX
\]</div>
<p>と表せる.
　ここでは</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \mu = \begin{bmatrix}
        3.0 \\
        4.0 \\
        2.0
    \end{bmatrix} \quad
    V = \begin{bmatrix}
        3.0 &amp; 1.2 &amp; 1.5\\
        1.2 &amp; 2.0 &amp; 1.7 \\
        1.5 &amp; 1.7 &amp; 2.2
    \end{bmatrix}
\end{split}\]</div>
<p>の多変数正規分布の擬似乱数を生成してみる.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># n 変数正規分布の乱数を size だけ生成.</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">100000</span>

<span class="c1"># 平均ベクトル, 分散共分散行列を設定.</span>
<span class="n">mu</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">([[</span><span class="mf">3.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">4.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">2.0</span><span class="p">]])</span>
<span class="n">cov</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">([[</span><span class="mf">3.0</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">1.7</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.7</span><span class="p">,</span> <span class="mf">2.2</span><span class="p">]])</span>

<span class="c1"># N(0, 1) の擬似乱数を生成.</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">12345</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">size</span><span class="p">))</span>

<span class="c1"># 設定した分散共分散行列をコレスキー分解.</span>
<span class="n">l</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">cholesky</span><span class="p">(</span><span class="n">cov</span><span class="p">)</span>

<span class="c1"># 多変量正規分布の擬似乱数 z を生成.</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">mu</span> <span class="o">+</span> <span class="n">l</span> <span class="o">*</span> <span class="n">x</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 生成した擬似乱数の平均, 分散共分散行列が設定したものになっているかの確認.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">z</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cov</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[3.00992411]
 [4.00137683]
 [2.00654081]]
[[2.994005   1.20354477 1.49936322]
 [1.20354477 1.99552296 1.69781946]
 [1.49936322 1.69781946 2.19759746]]
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="id15">
<h2>3. 周辺分布と条件付分布<a class="headerlink" href="#id15" title="Permalink to this headline">#</a></h2>
<section id="marginal-distribution">
<span id="id16"></span><h3>定義 3.1 (周辺分布関数)<a class="headerlink" href="#marginal-distribution" title="Permalink to this headline">#</a></h3>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p>2 つの確率ベクトル <span class="math notranslate nohighlight">\(X, Y\)</span> の同時分布を <span class="math notranslate nohighlight">\(f_{X, Y}(x, y)\)</span> とすれば, <span class="math notranslate nohighlight">\(X\)</span> 単独の確率分布を <span class="math notranslate nohighlight">\(X\)</span> の<strong>周辺分布</strong> (marginal distribution) と呼び, <span class="math notranslate nohighlight">\(X, Y\)</span> が離散型の場合, その質量関数を <span class="math notranslate nohighlight">\(f_X(x)\)</span> で表し <span class="math notranslate nohighlight">\(X\)</span> の<strong>周辺質量関数</strong> (mariginal probability mass function) と呼ぶ.</p>
<div class="math notranslate nohighlight">
\[
    f_X(x) = \sum_{y}{f_{X, Y}(x, y)}
\]</div>
<p>また <span class="math notranslate nohighlight">\(X, Y\)</span> が連続型の場合, <strong>周辺密度関数</strong> (mariginal probability density function) と呼び以下のように書ける.</p>
<div class="math notranslate nohighlight">
\[
    f_X(x) = \int {f_{X, Y}(x, y)dy}
\]</div>
</div></section>
<section id="id17">
<h3>例 3.2 (2つのサイコロの出る目の周辺分布)<a class="headerlink" href="#id17" title="Permalink to this headline">#</a></h3>
<p><a class="reference internal" href="#multi-discrete-distribution-example1"><span class="std std-ref">例 1.2 (2つのサイコロの出る目)</span></a> について再考する. 元の確率表に周辺分布を加えたものが以下になる.</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:center head"><p></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(X_1\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(1\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(2\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(3\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(4\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(5\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(6\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(f_{X_2}(x_2)\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:center"><p><span class="math notranslate nohighlight">\(X_2\)</span></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p><span class="math notranslate nohighlight">\(1\)</span></p></td>
<td><p></p></td>
<td><p><span class="math notranslate nohighlight">\(1/36\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(2/36\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(2/36\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(2/36\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(2/36\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(2/36\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(11/36\)</span></p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p><span class="math notranslate nohighlight">\(2\)</span></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p><span class="math notranslate nohighlight">\(1/36\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(2/36\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(2/36\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(2/36\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(2/36\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(9/36\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p><span class="math notranslate nohighlight">\(3\)</span></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p><span class="math notranslate nohighlight">\(1/36\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(2/36\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(2/36\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(2/36\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(7/36\)</span></p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p><span class="math notranslate nohighlight">\(4\)</span></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p><span class="math notranslate nohighlight">\(1/36\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(2/36\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(2/36\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(5/36\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p><span class="math notranslate nohighlight">\(5\)</span></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p><span class="math notranslate nohighlight">\(1/36\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(2/36\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(3/36\)</span></p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p><span class="math notranslate nohighlight">\(6\)</span></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p><span class="math notranslate nohighlight">\(1/36\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(1/36\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p><span class="math notranslate nohighlight">\(f_{X_1}(x_1)\)</span></p></td>
<td><p></p></td>
<td><p><span class="math notranslate nohighlight">\(1/36\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(3/36\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(5/36\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(7/36\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(9/36\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(11/36\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(1\)</span></p></td>
</tr>
</tbody>
</table>
<p>この表から分かるように, それぞれの周辺分布において確率分布の性質を満たすことが分かる. つまり, <span class="math notranslate nohighlight">\(f_{X_1}(x_1) = \dfrac{2x_1 - 1}{36}\)</span> より <span class="math notranslate nohighlight">\(f_{X_1}(x_1) \geq 0\)</span>. また,</p>
<div class="math notranslate nohighlight">
\[
    \sum_{x_1 = 1}^{6}{f_{X_1}(x_1)} = \frac{1}{36}\sum_{x_1 = 1}^{6}{(2x_1 - 1)} = \frac{1 + 3 + 5 + 7 + 9 + 11}{36} = 1.
\]</div>
</section>
<section id="id18">
<h3>例 3.3 (線形和によって表現される同時密度関数の周辺分布)<a class="headerlink" href="#id18" title="Permalink to this headline">#</a></h3>
<p><a class="reference internal" href="#multi-continuous-distribution-example1"><span class="std std-ref">例 1.4 (線形和によって表現される同時密度関数)</span></a> について再考する. 同時密度関数</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        f_{X, Y}(x, y) = \begin{cases}
            x + y &amp;(0 \leq x, y \leq 1) \\
            0     &amp;(\text{otherwise})
        \end{cases}
    \end{align}
\end{split}\]</div>
<p>において <span class="math notranslate nohighlight">\(X\)</span> の周辺密度関数は</p>
<div class="math notranslate nohighlight">
\[
    \begin{align}
        f_{X}(x) = \int_{0}^{1}{(x + y)dy} = x + \frac{1}{2}
    \end{align}
\]</div>
<p>となる. よって, <span class="math notranslate nohighlight">\(f_X(x) \geq 0\)</span>. また</p>
<div class="math notranslate nohighlight">
\[
    \begin{align}
        \int_{0}^{1}{f_{X}(x)} = \int_{0}^{1}{\biggl(x + \frac{1}{2}\biggr)dy} = 1.
    \end{align}
\]</div>
</section>
<section id="conditional-distribution">
<span id="id19"></span><h3>定義 3.4 (条件付分布)<a class="headerlink" href="#conditional-distribution" title="Permalink to this headline">#</a></h3>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p><span class="math notranslate nohighlight">\(Y = y\)</span> が与えられた下での <span class="math notranslate nohighlight">\(X = x\)</span> となる<strong>条件付分布</strong> (conditional distribution) を</p>
<div class="math notranslate nohighlight">
\[
    f_{X|Y}(x|y) = \frac{f_{X, Y}(x, y)}{f_Y(y)}
\]</div>
<p>と書ける.</p>
</div></section>
<section id="id20">
<h3>定義 3.5 (ベイズの定理)<a class="headerlink" href="#id20" title="Permalink to this headline">#</a></h3>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p>以下の条件付分布の関係式を<strong>ベイズの定理</strong> (Bayes’ theorem) という.</p>
<div class="math notranslate nohighlight">
\[
    f_{Y|X}(y|x) = \frac{ f_{X|Y}(x|y) f_Y(y) }{ f_X(x) } = \dfrac{ f_{X|Y}(x|y) f_Y(y) }{\displaystyle \int {f_{X|Y}(x, y)f_Y(y) dy} }
\]</div>
<p>連続型についてはさらに下記のように表現できる.</p>
<div class="math notranslate nohighlight">
\[
    f_{Y|X}(y|x) = \dfrac{ f_{X|Y}(x|y) f_Y(y) }{\displaystyle \int {f_{X|Y}(x, y)f_Y(y) dy} }
\]</div>
</div>
<p><u>ベイズの定理の意味</u></p>
<p>数式の意味について検討すると,</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(f_Y(y)\)</span> は事象 <span class="math notranslate nohighlight">\(X\)</span> が起きる前の事象 <span class="math notranslate nohighlight">\(Y\)</span> の確率分布で<strong>事前確率分布</strong> (prior probability distribution) という.</p></li>
<li><p><span class="math notranslate nohighlight">\(f_{X|Y}(x|y)\)</span> は事象 <span class="math notranslate nohighlight">\(X\)</span> が確定する場合に, 前提条件として事象 <span class="math notranslate nohighlight">\(Y\)</span> が成立する尤もらしさを表し, <span class="math notranslate nohighlight">\(X\)</span> に対する <span class="math notranslate nohighlight">\(Y\)</span> の<strong>尤度</strong> (likelihood) と解釈できる.</p></li>
<li><p><span class="math notranslate nohighlight">\(f_{Y|X}(y|x)\)</span> は事象 <span class="math notranslate nohighlight">\(X\)</span> が真の場合に事象 <span class="math notranslate nohighlight">\(Y\)</span> の確率分布で<strong>事後確率分布</strong> (posterior probability distribution) という.</p></li>
</ul>
<p><u>証明</u></p>
<p><a class="reference internal" href="#conditional-distribution"><span class="std std-ref">条件付分布の定義</span></a>から</p>
<div class="math notranslate nohighlight">
\[
    f_{Y|X}(y|x) = \frac{f_{X, Y}(x, y)}{f_X(x)} \Rightarrow f_{X, Y}(x, y) = f_{Y|X}(y|x) f_X(x)
\]</div>
<p>同様にして</p>
<div class="math notranslate nohighlight">
\[
    f_{X, Y}(x, y) = f_{X|Y}(x|y) f_Y(y)
\]</div>
<p>ゆえに <span class="math notranslate nohighlight">\(f_{X, Y}(x, y)\)</span> をもとに</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        f_{Y|X}(y|x) f_X(x) = f_{X|Y}(x|y) f_Y(y) \\
        \Leftrightarrow f_{Y|X}(y|x) = \frac{ f_{X|Y}(x|y) f_Y(y) }{ f_X(x) }
    \end{align}
\end{split}\]</div>
<p>また連続型については<a class="reference internal" href="#marginal-distribution"><span class="std std-ref">同時分布と周辺分布との関係</span></a> と <a class="reference internal" href="#conditional-distribution"><span class="std std-ref">条件付分布の関係式</span></a> から</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        f_X(x) &amp;= \int {f_{X, Y}(x, y)dy} \\
               &amp;= \int {f_{X|Y}(x|y) f_Y(y)dy}
    \end{align}
\end{split}\]</div>
<p>よって</p>
<div class="math notranslate nohighlight">
\[
    f_{Y|X}(y|x) = \dfrac{ f_{X|Y}(x|y) f_Y(y) }{\displaystyle \int {f_{X|Y}(x, y)f_Y(y) dy} }.
\]</div>
</section>
<section id="multi-conditional-expectation">
<span id="id21"></span><h3>定義 3.6 (条件付期待値)<a class="headerlink" href="#multi-conditional-expectation" title="Permalink to this headline">#</a></h3>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p><span class="math notranslate nohighlight">\(X, Y\)</span> はそれぞれ離散型の確率変数とする. このとき, <span class="math notranslate nohighlight">\(Y = y\)</span> が与えられた下での <span class="math notranslate nohighlight">\(\phi(X)\)</span> の<strong>条件付期待値</strong> (conditional expectation) は以下のように定義する.</p>
<div class="math notranslate nohighlight">
\[
    \mathbb{E}(\phi(X)|Y) = \sum_{x}{ \phi(x) f_{X|Y}(x|y)}
\]</div>
<p>また, <span class="math notranslate nohighlight">\(X, Y\)</span> が連続型の確率変数の場合は以下のように定義する.</p>
<div class="math notranslate nohighlight">
\[
    \mathbb{E}(\phi(X)|Y) = \int { \phi(x) f_{X|Y}(x|y) dx }
\]</div>
</div>
<p>特に, <span class="math notranslate nohighlight">\(Y=y\)</span> が与えられた下での <span class="math notranslate nohighlight">\(X\)</span> の条件付期待値 <span class="math notranslate nohighlight">\(\mathbb{E}(X|Y)\)</span> を <strong>条件付平均</strong> (conditional mean) という.</p>
</section>
<section id="conditional-expectation-property">
<span id="id22"></span><h3>命題 3.7 (条件付期待値の性質)<a class="headerlink" href="#conditional-expectation-property" title="Permalink to this headline">#</a></h3>
<p>条件付期待値でも<a class="reference internal" href="#multi-expectation-property"><span class="std std-ref">期待値の性質</span></a>を満たす.</p>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p><span class="math notranslate nohighlight">\(X, Y, X_1, X_2\)</span> をそれぞれ <span class="math notranslate nohighlight">\(n\)</span> 次元確率ベクトル, <span class="math notranslate nohighlight">\(A\)</span> は <span class="math notranslate nohighlight">\(p \times n\)</span> 行列, <span class="math notranslate nohighlight">\(a\)</span> は <span class="math notranslate nohighlight">\(n\)</span> 次元定数ベクトルとすると以下が成立する.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        &amp;\text{性質(1)} \quad \mathbb{E}(X + a | Y) = \mathbb{E}(X | Y) + a \\
        &amp;\text{性質(2)} \quad \mathbb{E}(AX | Y) = A\mathbb{E}(X | Y)  \\
        &amp;\text{性質(3)} \quad \mathbb{E}(X_1 + X_2 | Y) = \mathbb{E}(X_1 | Y) + \mathbb{E}(X_2 | Y)
    \end{align}
\end{split}\]</div>
</div></section>
<section id="multi-conditional-variance-covariance">
<span id="id23"></span><h3>定義 3.8 (条件付分散共分散)<a class="headerlink" href="#multi-conditional-variance-covariance" title="Permalink to this headline">#</a></h3>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p>確率ベクトル <span class="math notranslate nohighlight">\(X, Y\)</span> について以下を<strong>条件付分散</strong> (conditional variance) という.</p>
<div class="math notranslate nohighlight">
\[
    \mathbb{Var}(X|Y) = \mathbb{E}[ (X - \mathbb{E}[X])(X - \mathbb{E}[X])' | Y]
\]</div>
<p>また <span class="math notranslate nohighlight">\(Y = y\)</span> が与えられた下での二つの確率ベクトル <span class="math notranslate nohighlight">\(X_1, X_2\)</span> の条件付共分散 (conditional covariance) は以下で定義される.</p>
<div class="math notranslate nohighlight">
\[
    \mathbb{Cov}(X_1, X_2|Y) = \mathbb{E}[ (X_1 - \mathbb{E}[X_1])(X_2 - \mathbb{E}[X_2])' | Y ]
\]</div>
</div></section>
<section id="conditional-variance-property">
<span id="id24"></span><h3>命題 3.9 (条件付分散の性質)<a class="headerlink" href="#conditional-variance-property" title="Permalink to this headline">#</a></h3>
<p>条件付分散でも<a class="reference internal" href="#multi-variance-property"><span class="std std-ref">共分散行列の性質</span></a>を満たす.</p>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p><span class="math notranslate nohighlight">\(X, X_1, X_2\)</span> をそれぞれ <span class="math notranslate nohighlight">\(n\)</span> 次元確率ベクトル, <span class="math notranslate nohighlight">\(Y, Y_1, Y_2\)</span> をそれぞれ <span class="math notranslate nohighlight">\(m\)</span> 次元確率ベクトル, <span class="math notranslate nohighlight">\(Z\)</span> を <span class="math notranslate nohighlight">\(l\)</span> 次元確率ベクトル, <span class="math notranslate nohighlight">\(A\)</span> は <span class="math notranslate nohighlight">\(p \times n\)</span> 行列, <span class="math notranslate nohighlight">\(B\)</span> は <span class="math notranslate nohighlight">\(q \times m\)</span> 行列, <span class="math notranslate nohighlight">\(a\)</span> を <span class="math notranslate nohighlight">\(n\)</span> 次元定数ベクトル, <span class="math notranslate nohighlight">\(b\)</span> を <span class="math notranslate nohighlight">\(m\)</span> 次元定数ベクトルとすると以下が成立する.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        &amp;\text{性質(1)} \quad \mathbb{Cov}(X + a, Y + b | Z) = \mathbb{Cov}(X, Y | Z)                              \\
        &amp;\text{性質(2)} \quad \mathbb{Cov}(AX, BY | Z)       = A \mathbb{Cov}(X, Y | Z) B'                         \\
        &amp;\text{性質(3)} \quad \mathbb{Cov}(X_1 + X_2, Y | Z) = \mathbb{Cov}(X_1, Y | Z) + \mathbb{Cov}(X_2, Y | Z) \\
        &amp;\text{性質(4)} \quad \mathbb{Cov}(X, Y_1 + Y_2 | Z) = \mathbb{Cov}(X, Y_1 | Z) + \mathbb{Cov}(X, Y_2 | Z) \\
        &amp;\text{性質(5)} \quad \mathbb{Var}(X + a | Z)        = \mathbb{Var}(X | Z)                                 \\
        &amp;\text{性質(6)} \quad \mathbb{Var}(AX | Z)           = A \mathbb{Var}(X | Z) A'
    \end{align}
\end{split}\]</div>
</div></section>
</section>
<section id="id25">
<h2>4. 多変量確率分布<a class="headerlink" href="#id25" title="Permalink to this headline">#</a></h2>
<section id="id26">
<h3>例 4.1 (多項分布)<a class="headerlink" href="#id26" title="Permalink to this headline">#</a></h3>
</section>
<section id="id27">
<h3>例 4.2 (多変量正規分布)<a class="headerlink" href="#id27" title="Permalink to this headline">#</a></h3>
</section>
<section id="id28">
<h3>例 4.3 (ディリクレ分布)<a class="headerlink" href="#id28" title="Permalink to this headline">#</a></h3>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./analytics/distribution"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="probability_distribution.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">確率分布</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../tsa/time_series.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">時系列データ</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By sndpgm<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>