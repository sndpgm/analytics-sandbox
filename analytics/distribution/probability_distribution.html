
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>確率分布 &#8212; Analytics Study Blog</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=62ba249389abaaa9ffc34bf36a076bdc1d65ee18" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=f31d14ad54b65d19161ba51d4ffff3a77ae00456"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="多次元確率分布" href="multi_probability_distribution.html" />
    <link rel="prev" title="確率変数" href="random_variables.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Analytics Study Blog</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Welcome to my Analytics Sandbox
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  確率変数と確率分布
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="random_variables.html">
   確率変数
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   確率分布
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="multi_probability_distribution.html">
   多次元確率分布
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  時系列モデリング
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../tsa/time_series.html">
   時系列データ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tsa/autoregressive.html">
   自己回帰モデル
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tsa/move_average.html">
   移動平均モデル
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tsa/arima.html">
   ARMA・ARIMA・SARIMAX
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tsa/state_space_model.html">
   状態空間モデル
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/sndpgm/analytics-sandbox/main?urlpath=tree/docs/analytics/distribution/probability_distribution.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/sndpgm/analytics-sandbox"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/sndpgm/analytics-sandbox/issues/new?title=Issue%20on%20page%20%2Fanalytics/distribution/probability_distribution.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../_sources/analytics/distribution/probability_distribution.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id2">
   1. 離散型の確率分布
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     例 1.1 (ベルヌーイ分布)
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id4">
       確率質量関数
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id5">
       期待値と分散
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#python">
       関連Pythonモジュール
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id6">
       ユースケース
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id7">
     例 1.2 (二項分布)
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id8">
       確率質量関数
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id9">
       期待値と分散
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id10">
       関連Pythonモジュール
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id11">
       ユースケース
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id12">
     例 1.3 (ポアソン分布)
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id13">
       確率質量関数
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id14">
       期待値と分散
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id15">
       関連Pythonモジュール
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id16">
       ユースケース
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id17">
     例 1.4 (幾何分布)
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id18">
       確率質量関数
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id19">
       期待値と分散
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id20">
       関連Pythonモジュール
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id21">
       ユースケース
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id22">
     例 1.5 (負の二項分布)
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id23">
       確率質量関数
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id24">
       期待値と分散
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id25">
       関連Pythonモジュール
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id26">
       ユースケース
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id27">
   2. 連続型の確率分布
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id28">
     例 2.1 (一様分布)
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id29">
       確率密度関数
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id30">
       期待値と分散
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id31">
       関連Pythonモジュール
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id32">
       ユースケース
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#normal-distribution">
     例 2.2 (正規分布)
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id34">
       確率密度関数
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id35">
       命題 2.2.1 (ガウス積分)
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id36">
       期待値と分散
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id37">
       関連Pythonモジュール
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id38">
       ユースケース
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id39">
       定理 2.2.2 (中心極限定理)
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id40">
     例 2.3 (対数正規分布)
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id41">
       確率密度関数
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id42">
       期待値と分散
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id43">
       関連Pythonモジュール
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id44">
       ユースケース
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id45">
     例 2.4 (指数分布)
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id46">
       確率密度関数
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id47">
       期待値と分散
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id48">
       関連Pythonモジュール
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id49">
       ユースケース
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id50">
     例 2.5 (ガンマ分布)
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id51">
       確率密度関数
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id52">
       期待値と分散
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id53">
       命題 2.5.1 (ガンマ関数の性質)
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id54">
       関連Pythonモジュール
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id55">
       ユースケース
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id56">
     例 2.6 (ベータ分布)
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id57">
       確率密度関数
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id58">
       期待値と分散
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id59">
       命題 2.6.1 (ベータ関数の性質)
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id60">
       関連Pythonモジュール
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id61">
       ユースケース
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>確率分布</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id2">
   1. 離散型の確率分布
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     例 1.1 (ベルヌーイ分布)
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id4">
       確率質量関数
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id5">
       期待値と分散
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#python">
       関連Pythonモジュール
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id6">
       ユースケース
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id7">
     例 1.2 (二項分布)
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id8">
       確率質量関数
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id9">
       期待値と分散
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id10">
       関連Pythonモジュール
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id11">
       ユースケース
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id12">
     例 1.3 (ポアソン分布)
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id13">
       確率質量関数
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id14">
       期待値と分散
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id15">
       関連Pythonモジュール
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id16">
       ユースケース
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id17">
     例 1.4 (幾何分布)
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id18">
       確率質量関数
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id19">
       期待値と分散
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id20">
       関連Pythonモジュール
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id21">
       ユースケース
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id22">
     例 1.5 (負の二項分布)
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id23">
       確率質量関数
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id24">
       期待値と分散
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id25">
       関連Pythonモジュール
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id26">
       ユースケース
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id27">
   2. 連続型の確率分布
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id28">
     例 2.1 (一様分布)
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id29">
       確率密度関数
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id30">
       期待値と分散
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id31">
       関連Pythonモジュール
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id32">
       ユースケース
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#normal-distribution">
     例 2.2 (正規分布)
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id34">
       確率密度関数
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id35">
       命題 2.2.1 (ガウス積分)
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id36">
       期待値と分散
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id37">
       関連Pythonモジュール
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id38">
       ユースケース
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id39">
       定理 2.2.2 (中心極限定理)
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id40">
     例 2.3 (対数正規分布)
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id41">
       確率密度関数
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id42">
       期待値と分散
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id43">
       関連Pythonモジュール
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id44">
       ユースケース
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id45">
     例 2.4 (指数分布)
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id46">
       確率密度関数
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id47">
       期待値と分散
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id48">
       関連Pythonモジュール
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id49">
       ユースケース
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id50">
     例 2.5 (ガンマ分布)
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id51">
       確率密度関数
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id52">
       期待値と分散
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id53">
       命題 2.5.1 (ガンマ関数の性質)
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id54">
       関連Pythonモジュール
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id55">
       ユースケース
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id56">
     例 2.6 (ベータ分布)
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id57">
       確率密度関数
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id58">
       期待値と分散
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id59">
       命題 2.6.1 (ベータ関数の性質)
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id60">
       関連Pythonモジュール
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id61">
       ユースケース
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="id1">
<h1>確率分布<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h1>
<section id="id2">
<h2>1. 離散型の確率分布<a class="headerlink" href="#id2" title="Permalink to this headline">#</a></h2>
<section id="id3">
<h3>例 1.1 (ベルヌーイ分布)<a class="headerlink" href="#id3" title="Permalink to this headline">#</a></h3>
<p><strong>ベルヌーイ分布</strong> (Bernoulli distribution) コインの裏表のように2種類の可能な結果 (成功を S, 失敗を F) を生じる試行 (<strong>ベルヌーイ試行</strong> (Bernoulli trials) と言う) に対する確率分布.</p>
<section id="id4">
<h4>確率質量関数<a class="headerlink" href="#id4" title="Permalink to this headline">#</a></h4>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p>成功 S が起きる確率を <span class="math notranslate nohighlight">\(p\)</span> とした場合, 確率変数 <span class="math notranslate nohighlight">\(X\)</span> について成功 S の時に <span class="math notranslate nohighlight">\(X=1\)</span>, 失敗 F の時に <span class="math notranslate nohighlight">\(X = 0\)</span> とする. この時の確率質量関数は以下の通り.</p>
<div class="math notranslate nohighlight">
\[
    f(x) = p^x(1-p)^{1-x}
\]</div>
</div></section>
<section id="id5">
<h4>期待値と分散<a class="headerlink" href="#id5" title="Permalink to this headline">#</a></h4>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        &amp; {\rm E}(X) = p \\
        &amp; {\rm Var}(X) = p(1-p)
    \end{align}
\end{split}\]</div>
</div></section>
<section id="python">
<h4>関連Pythonモジュール<a class="headerlink" href="#python" title="Permalink to this headline">#</a></h4>
<p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.bernoulli.html#scipy.stats.bernoulli"><code class="docutils literal notranslate"><span class="pre">scipy.stats.bernoulli</span></code></a> を用いて生成する.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">bernoulli</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>

<span class="c1"># 成功確率 p = 0.3 のベルヌーイ分布に従った疑似乱数を size = 100000 だけ生成する.</span>
<span class="n">p</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">100000</span>
<span class="n">rvs</span> <span class="o">=</span> <span class="n">bernoulli</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=========================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ベルヌーイ分布・擬似乱数&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=========================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rvs</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">100</span><span class="p">])</span>

<span class="c1"># 擬似乱数から期待値・分散の計算</span>
<span class="n">exp_rvs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rvs</span><span class="p">)</span>
<span class="n">var_rvs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">rvs</span><span class="p">)</span>

<span class="c1"># 期待値・分散の理論値</span>
<span class="n">exp_true</span> <span class="o">=</span> <span class="n">bernoulli</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>
<span class="n">var_true</span> <span class="o">=</span> <span class="n">bernoulli</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=========================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ベルヌーイ分布・期待値/分散&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=========================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;期待値(乱数 vs 真値): </span><span class="si">{</span><span class="n">exp_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">exp_true</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;分散(乱数 vs 真値): </span><span class="si">{</span><span class="n">var_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">var_true</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># 可視化</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;======================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ベルヌーイ分布&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;======================================&quot;</span><span class="p">)</span>

<span class="c1"># 理想PMF</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">bernoulli</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">rvs</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">stat</span><span class="o">=</span><span class="s2">&quot;probability&quot;</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;random variables&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;probability mass function&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Mass function&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyboardInterrupt</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="nn">Input In [1],</span> in <span class="ni">&lt;cell line: 6&gt;</span><span class="nt">()</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="ne">----&gt; </span><span class="mi">6</span> <span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span> <span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span> <span class="c1"># 成功確率 p = 0.3 のベルヌーイ分布に従った疑似乱数を size = 100000 だけ生成する.</span>

<span class="n">File</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.9</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">seaborn</span><span class="o">/</span><span class="fm">__init__</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">9</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span> <span class="kn">from</span> <span class="nn">.categorical</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># noqa: F401,F403</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span> <span class="kn">from</span> <span class="nn">.distributions</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># noqa: F401,F403</span>
<span class="ne">----&gt; </span><span class="mi">9</span> <span class="kn">from</span> <span class="nn">.matrix</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># noqa: F401,F403</span>
<span class="g g-Whitespace">     </span><span class="mi">10</span> <span class="kn">from</span> <span class="nn">.miscplot</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># noqa: F401,F403</span>
<span class="g g-Whitespace">     </span><span class="mi">11</span> <span class="kn">from</span> <span class="nn">.axisgrid</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># noqa: F401,F403</span>

<span class="n">File</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.9</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">seaborn</span><span class="o">/</span><span class="n">matrix</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span> <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="ne">---&gt; </span><span class="mi">10</span> <span class="kn">from</span> <span class="nn">scipy.cluster</span> <span class="kn">import</span> <span class="n">hierarchy</span>
<span class="g g-Whitespace">     </span><span class="mi">12</span> <span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">cm</span>
<span class="g g-Whitespace">     </span><span class="mi">13</span> <span class="kn">from</span> <span class="nn">.axisgrid</span> <span class="kn">import</span> <span class="n">Grid</span>

<span class="n">File</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.9</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">scipy</span><span class="o">/</span><span class="n">cluster</span><span class="o">/</span><span class="fm">__init__</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">25</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="sd">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span><span class="sd"> =========================================</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span><span class="sd"> Clustering package (:mod:`scipy.cluster`)</span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">     </span><span class="mi">21</span><span class="sd"> </span>
<span class="g g-Whitespace">     </span><span class="mi">22</span><span class="sd"> &quot;&quot;&quot;</span>
<span class="g g-Whitespace">     </span><span class="mi">23</span> <span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;vq&#39;</span><span class="p">,</span> <span class="s1">&#39;hierarchy&#39;</span><span class="p">]</span>
<span class="ne">---&gt; </span><span class="mi">25</span> <span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">vq</span><span class="p">,</span> <span class="n">hierarchy</span>
<span class="g g-Whitespace">     </span><span class="mi">27</span> <span class="kn">from</span> <span class="nn">scipy._lib._testutils</span> <span class="kn">import</span> <span class="n">PytestTester</span>
<span class="g g-Whitespace">     </span><span class="mi">28</span> <span class="n">test</span> <span class="o">=</span> <span class="n">PytestTester</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="n">File</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.9</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">scipy</span><span class="o">/</span><span class="n">cluster</span><span class="o">/</span><span class="n">vq</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">74</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">     </span><span class="mi">70</span> <span class="kn">from</span> <span class="nn">scipy._lib._util</span> <span class="kn">import</span> <span class="n">_asarray_validated</span><span class="p">,</span> <span class="n">check_random_state</span><span class="p">,</span>\
<span class="g g-Whitespace">     </span><span class="mi">71</span>     <span class="n">rng_integers</span>
<span class="g g-Whitespace">     </span><span class="mi">72</span> <span class="kn">from</span> <span class="nn">scipy.spatial.distance</span> <span class="kn">import</span> <span class="n">cdist</span>
<span class="ne">---&gt; </span><span class="mi">74</span> <span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">_vq</span>
<span class="g g-Whitespace">     </span><span class="mi">76</span> <span class="n">__docformat__</span> <span class="o">=</span> <span class="s1">&#39;restructuredtext&#39;</span>
<span class="g g-Whitespace">     </span><span class="mi">78</span> <span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;whiten&#39;</span><span class="p">,</span> <span class="s1">&#39;vq&#39;</span><span class="p">,</span> <span class="s1">&#39;kmeans&#39;</span><span class="p">,</span> <span class="s1">&#39;kmeans2&#39;</span><span class="p">]</span>

<span class="nn">File &lt;frozen importlib._bootstrap&gt;:398,</span> in <span class="ni">parent</span><span class="nt">(self)</span>

<span class="ne">KeyboardInterrupt</span>: 
</pre></div>
</div>
</div>
</div>
</section>
<section id="id6">
<h4>ユースケース<a class="headerlink" href="#id6" title="Permalink to this headline">#</a></h4>
<p>単独で使用することはあまりないが, 統計モデルの一部にベルヌーイ分布を仮定することが多い. 現象が2パターンしか取り得ないような「会員登録の実施有無」, 「レビュー記事に対して高評価をするかしないか」, 「購買行動を行うか否か」にベルヌーイ分布を仮定する.</p>
<ul class="simple">
<li><p>商品レビューが有用かどうか (<a class="reference external" href="https://www.jstage.jst.go.jp/article/jsaikbs/118/0/118_05/_pdf">柴田と伊東, 2019</a>. この論文内ではベルヌーイ分布による評価の代替評価を提案している.)</p></li>
<li><p>ECサイト利用者に対して施策を売った際にどういったセグメントグループに効果的に機能したかを推定するモデル内において, セグメントグループの購買有無に対してベルヌーイ分布を仮定 (<a class="reference external" href="https://ipsj.ixsq.nii.ac.jp/ej/?action=repository_action_common_download&amp;item_id=185104&amp;item_no=1&amp;attribute_id=1&amp;file_no=1">松嵜ら, 2017</a>)</p></li>
</ul>
</section>
</section>
<section id="id7">
<h3>例 1.2 (二項分布)<a class="headerlink" href="#id7" title="Permalink to this headline">#</a></h3>
<p><strong>二項分布</strong> (binomial distribution) は結果が 2 つの試行 (成功を S, 失敗を F) を何度も繰り返すことによって起こる確率分布.</p>
<section id="id8">
<h4>確率質量関数<a class="headerlink" href="#id8" title="Permalink to this headline">#</a></h4>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p>S が 確率 <span class="math notranslate nohighlight">\(p (0 \leq p \leq 1)\)</span> で <span class="math notranslate nohighlight">\(x\)</span> 回, F が確率 <span class="math notranslate nohighlight">\(1-p\)</span> で <span class="math notranslate nohighlight">\(n-x\)</span> 回生じるとすると, <span class="math notranslate nohighlight">\(x=0,1, \cdots, n\)</span> であって, その確率質量関数は以下の通り.</p>
<div class="math notranslate nohighlight">
\[
    f(x) = {}_n{\rm C}_{x} p^x (1-p)^{n-x}
\]</div>
</div>
<p>確率変数 <span class="math notranslate nohighlight">\(X\)</span> が 二項分布に従っていることを <span class="math notranslate nohighlight">\(X \sim Bi(n, p)\)</span> と記載する.</p>
</section>
<section id="id9">
<h4>期待値と分散<a class="headerlink" href="#id9" title="Permalink to this headline">#</a></h4>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        &amp; {\rm E}(X) = np \\
        &amp; {\rm Var}(X) = np(1-p)
    \end{align}
\end{split}\]</div>
</div></section>
<section id="id10">
<h4>関連Pythonモジュール<a class="headerlink" href="#id10" title="Permalink to this headline">#</a></h4>
<p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.binom.html#scipy.stats.binom"><code class="docutils literal notranslate"><span class="pre">scipy.stats.binom</span></code></a> を用いて生成する.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">binom</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>

<span class="c1"># 試行回数 n = 10, 成功確率 p = 0.3 の二項分布に従った疑似乱数を size = 100000 だけ生成する.</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">p</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">100000</span>
<span class="n">rvs</span> <span class="o">=</span> <span class="n">binom</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=========================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;二項分布・擬似乱数&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=========================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rvs</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">100</span><span class="p">])</span>

<span class="c1"># 擬似乱数から期待値・分散の計算</span>
<span class="n">exp_rvs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rvs</span><span class="p">)</span>
<span class="n">var_rvs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">rvs</span><span class="p">)</span>

<span class="c1"># 期待値・分散の理論値</span>
<span class="n">exp_true</span> <span class="o">=</span> <span class="n">binom</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>
<span class="n">var_true</span> <span class="o">=</span> <span class="n">binom</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=========================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;二項分布・期待値/分散&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=========================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;期待値(乱数 vs 真値): </span><span class="si">{</span><span class="n">exp_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">exp_true</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;分散(乱数 vs 真値): </span><span class="si">{</span><span class="n">var_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">var_true</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># 可視化</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;======================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;二項分布&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;======================================&quot;</span><span class="p">)</span>

<span class="c1"># 理想PMF</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">binom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">rvs</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">stat</span><span class="o">=</span><span class="s2">&quot;probability&quot;</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;random variables&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;probability mass function&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Mass function&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=========================================
二項分布・擬似乱数
=========================================
[1 2 0 2 1 1 5 3 4 1 2 4 4 1 0 3 3 4 2 2 3 4 1 4 5 4 4 1 4 4 1 2 5 3 3 2 2
 4 3 4 0 3 5 2 4 6 2 3 2 3 3 2 4 2 2 8 1 3 1 4 1 2 1 4 2 2 3 4 2 2 3 4 1 4
 6 0 5 1 4 3 3 1 4 8 4 5 4 1 5 5 3 2 3 1 5 3 4 3 5 4]

=========================================
二項分布・期待値/分散
=========================================
期待値(乱数 vs 真値): 2.99594 vs 3.0
分散(乱数 vs 真値): 2.0879035164 vs 2.0999999999999996

======================================
二項分布
======================================
</pre></div>
</div>
<img alt="../../_images/probability_distribution_12_1.png" src="../../_images/probability_distribution_12_1.png" />
</div>
</div>
</section>
<section id="id11">
<h4>ユースケース<a class="headerlink" href="#id11" title="Permalink to this headline">#</a></h4>
<ul class="simple">
<li><p>バナー広告のインプレッション数 <span class="math notranslate nohighlight">\(n\)</span> 回のうち, クリック率 <span class="math notranslate nohighlight">\(p\)</span> で広告がクリックされる回数 (<a class="reference external" href="http://www.orsj.or.jp/archive2/or57-10/or57_10_574.pdf">本橋ら, 2012</a>)</p></li>
<li><p>特定のサービスにおいて <span class="math notranslate nohighlight">\(n\)</span> 人の利用ユーザーのうち, 確率 <span class="math notranslate nohighlight">\(p\)</span> で解約する人数</p></li>
<li><p>特定の病気において <span class="math notranslate nohighlight">\(n\)</span> 人の被験者のうち, 病気の発症率 <span class="math notranslate nohighlight">\(p\)</span> がどのように変わるか</p></li>
</ul>
</section>
</section>
<section id="id12">
<h3>例 1.3 (ポアソン分布)<a class="headerlink" href="#id12" title="Permalink to this headline">#</a></h3>
<p><strong>ポアソン分布</strong> (Poisson distribution) とは, 二項分布において <span class="math notranslate nohighlight">\(n\)</span> が大 (すなわち大量の観測) である一方, <span class="math notranslate nohighlight">\(p\)</span> が小 (すなわち希少現象) である分布.</p>
<section id="id13">
<h4>確率質量関数<a class="headerlink" href="#id13" title="Permalink to this headline">#</a></h4>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p><span class="math notranslate nohighlight">\(\lambda &gt; 0, x \geq 0\)</span> として確率質量関数は以下の通り.</p>
<div class="math notranslate nohighlight">
\[
    f(x) = \frac{e^{-\lambda} \lambda^{x}}{x!}
\]</div>
</div>
<p>ここで<a class="reference internal" href="random_variables.html#discrete-distribution"><span class="std std-ref">離散型の確率分布の性質</span></a>を確認する.<br />
　確率質量関数の定義から <span class="math notranslate nohighlight">\(f(x) \geq 0\)</span> であることは自明. また, <span class="math notranslate nohighlight">\(e^x\)</span> について<a class="reference external" href="https://ja.wikipedia.org/wiki/%E3%83%86%E3%82%A4%E3%83%A9%E3%83%BC%E5%B1%95%E9%96%8B">マクローリン展開</a>から</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        e^x &amp;= 1 + \frac{x}{1!} + \frac{x^2}{2!} + \cdots + \frac{x^k}{k!} + \cdots \\
            &amp;= \sum_{k=0}^{\infty}{\frac{x^k}{k!}}
    \end{align}
\end{split}\]</div>
<p>と書けるので,</p>
<div class="math notranslate nohighlight">
\[
\sum_{x=0}^{\infty}{f(x)} = \sum_{x=0}^{\infty}{\frac{e^{-\lambda} \lambda^{x}}{x!}} = e^{-\lambda} \sum_{x=0}^{\infty}{\frac{ \lambda^{x}}{x!}} = e^{-\lambda} \cdot e^{\lambda} = 1
\]</div>
<p>と分かる.</p>
<p>確率変数 <span class="math notranslate nohighlight">\(X\)</span> がポアソン分布に従う時, <span class="math notranslate nohighlight">\(X \sim Po(\lambda)\)</span> または <span class="math notranslate nohighlight">\(X \sim Poisson(\lambda)\)</span> と記載する.</p>
</section>
<section id="id14">
<h4>期待値と分散<a class="headerlink" href="#id14" title="Permalink to this headline">#</a></h4>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        &amp; {\rm E}(X) = \lambda \\
        &amp; {\rm Var}(X) = \lambda
    \end{align}
\end{split}\]</div>
</div>
<p><u>証明</u><br />
　<a class="reference internal" href="random_variables.html#expectation"><span class="std std-ref">期待値の定義</span></a>より</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm E}(X) &amp;= \sum_{x=0}^{\infty}{x\frac{e^{-\lambda}\lambda^{x}}{x!}} \\
                   &amp;= \lambda e^{-\lambda}\sum_{x=1}^{\infty}{\frac{\lambda^{x-1}}{(x-1)!}} \\
                   &amp;= \lambda e^{-\lambda} \cdot e^{\lambda} \\
                   &amp;= \lambda
    \end{align}
\end{split}\]</div>
<p>と計算できる. また分散について<a class="reference internal" href="random_variables.html#expect-variance"><span class="std std-ref">分散と期待値の関係式</span></a>から <span class="math notranslate nohighlight">\({\rm E}(X^2)\)</span> を求めることで分散も求められる.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm E}(X^2) &amp;= \sum_{x=0}^{\infty}{x^2\frac{e^{-\lambda}\lambda^{x}}{x!}} \\
                     &amp;= \sum_{x=0}^{\infty}{\{x(x-1) + x\} \frac{e^{-\lambda}\lambda^{x}}{x!}} \\
                     &amp;= \lambda^2 e^{-\lambda}\sum_{x=2}^{\infty}{\frac{\lambda^{x-2}}{(x-2)!}} + \lambda e^{-\lambda}\sum_{x=1}^{\infty}{\frac{\lambda^{x-1}}{(x-1)!}} \\
                     &amp;= \lambda^2 + \lambda \\
    \end{align}
\end{split}\]</div>
<p>よって</p>
<div class="math notranslate nohighlight">
\[
    {\rm Var}(X) = {\rm}E(X^2) - ({\rm E}(X))^2 = \lambda^2 + \lambda - \lambda^2 = \lambda
\]</div>
</section>
<section id="id15">
<h4>関連Pythonモジュール<a class="headerlink" href="#id15" title="Permalink to this headline">#</a></h4>
<p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.poisson.html#scipy.stats.poisson"><code class="docutils literal notranslate"><span class="pre">scipy.stats.poisson</span></code></a> を用いて生成する.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">poisson</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>

<span class="c1"># mu (上式のlambdaに相当) = 1 のポアソン分布に従った疑似乱数を size = 100000 だけ生成する.</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">100000</span>
<span class="n">rvs</span> <span class="o">=</span> <span class="n">poisson</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="n">mu</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=========================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ポアソン分布・擬似乱数&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=========================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rvs</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">100</span><span class="p">])</span>

<span class="c1"># 擬似乱数から期待値・分散の計算</span>
<span class="n">exp_rvs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rvs</span><span class="p">)</span>
<span class="n">var_rvs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">rvs</span><span class="p">)</span>

<span class="c1"># 期待値・分散の理論値</span>
<span class="n">exp_true</span> <span class="o">=</span> <span class="n">poisson</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="n">mu</span><span class="p">)</span>
<span class="n">var_true</span> <span class="o">=</span> <span class="n">poisson</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="n">mu</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=========================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ポアソン分布・期待値/分散&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=========================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;期待値(乱数 vs 真値): </span><span class="si">{</span><span class="n">exp_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">exp_true</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;分散(乱数 vs 真値): </span><span class="si">{</span><span class="n">var_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">var_true</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># 可視化</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;======================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ポアソン分布&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;======================================&quot;</span><span class="p">)</span>

<span class="c1"># x軸</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># 図の定義</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

<span class="k">for</span> <span class="n">mu</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">):</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">poisson</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="n">mu</span><span class="p">)</span>
    <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;mu = </span><span class="si">{</span><span class="n">mu</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
    
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Poisson distribution for various mu&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=========================================
ポアソン分布・擬似乱数
=========================================
[2 2 1 0 2 0 2 5 1 2 3 1 1 1 0 0 0 2 0 0 1 0 0 0 0 2 0 1 0 0 1 0 2 1 0 0 2
 2 0 2 0 0 0 1 0 1 2 1 2 1 3 1 1 1 1 0 1 1 1 0 0 0 2 1 2 1 1 1 0 0 1 2 2 2
 0 1 0 0 0 0 2 0 0 2 1 2 3 3 2 2 0 0 0 1 2 1 0 2 1 0]

=========================================
ポアソン分布・期待値/分散
=========================================
期待値(乱数 vs 真値): 1.00269 vs 1.0
分散(乱数 vs 真値): 1.0003427639 vs 1.0

======================================
ポアソン分布
======================================
</pre></div>
</div>
<img alt="../../_images/probability_distribution_18_1.png" src="../../_images/probability_distribution_18_1.png" />
</div>
</div>
<p>二項分布において <span class="math notranslate nohighlight">\(n \rightarrow \infty, p \rightarrow 0\)</span> とすることでポアソン分布に近づく. ここで <span class="math notranslate nohighlight">\(\lambda = np\)</span> とすれば確率質量関数 <span class="math notranslate nohighlight">\(f(x)\)</span> は</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        f(x) &amp;= {}_n{\rm C}_{x} \Bigl( \frac{\lambda}{n} \Bigr)^x \Bigl( 1 - \frac{\lambda}{n} \Bigr)^{n-x} \\
             &amp;= \frac{n(n-1) \cdots (n-x+1)}{x!} \frac{\lambda^x}{n^x} \Bigl( 1 - \frac{\lambda}{n} \Bigr)^n \Bigl( 1 - \frac{\lambda}{n} \Bigr)^{-x} \\
             &amp;= \frac{\lambda^x}{x!} \Bigl( 1 - \frac{\lambda}{n} \Bigr)^n \Bigl( 1 - \frac{1}{n} \Bigr) \Bigl( 1 - \frac{2}{n} \Bigr) \cdots \Bigl( 1 - \frac{k-1}{n} \Bigr) \Bigl( 1 - \frac{\lambda}{n} \Bigr)^{-x}
    \end{align}
\end{split}\]</div>
<p>ここで, <span class="math notranslate nohighlight">\(n \rightarrow \infty\)</span> とした時, <span class="math notranslate nohighlight">\(m = 1, 2, \cdots, k-1\)</span> とすれば</p>
<div class="math notranslate nohighlight">
\[
\lim_{n \rightarrow \infty}{\Bigl( 1 - \frac{m}{n} \Bigr)} = 0, \quad \lim_{n \rightarrow \infty}{\Bigl( 1 - \frac{\lambda}{n} \Bigr)^{-x}} = 0 \quad \lim_{n \rightarrow \infty}{\Bigl( 1 - \frac{\lambda}{n} \Bigr)^n} = e^{-\lambda}
\]</div>
<p>なので,</p>
<div class="math notranslate nohighlight">
\[
    \lim_{n \rightarrow \infty}{f(x)} = \frac{e^{-\lambda} \lambda^{x}}{x!}
\]</div>
<p>とポアソン分布になる. 実際に python で二項分布とポアソン分布を比較する.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">binom</span><span class="p">,</span> <span class="n">poisson</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>

<span class="c1"># x軸</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># 図の定義</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

<span class="c1"># ポアソン分布</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">poisson</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
<span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Poisson (mu = 2.0)&quot;</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>

<span class="c1"># 二項分布</span>
<span class="n">scales</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">,</span> <span class="mi">100000</span><span class="p">])</span>
<span class="n">base_n</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">base_p</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="k">for</span> <span class="n">scale</span> <span class="ow">in</span> <span class="n">scales</span><span class="p">:</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">base_n</span> <span class="o">*</span> <span class="n">scale</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">base_p</span> <span class="o">/</span> <span class="n">scale</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">binom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>
    <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Binomial (n = </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">, p = </span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s2">)&quot;</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
    
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Binomial vs Poisson&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/probability_distribution_20_0.png" src="../../_images/probability_distribution_20_0.png" />
</div>
</div>
</section>
<section id="id16">
<h4>ユースケース<a class="headerlink" href="#id16" title="Permalink to this headline">#</a></h4>
<ul class="simple">
<li><p>交通事故件数</p></li>
<li><p>大量生産の不良品数 (<a class="reference external" href="https://notebook.community/STREAM3/pyisc/docs/pyISC_simple_anomaly_example">pyISC Example: Simple Anomaly Detection with Frequency Data</a>)</p></li>
<li><p>破産件数</p></li>
<li><p>火災件数</p></li>
<li><p>砲弾命中数</p></li>
<li><p>遺伝子の突然変異数</p></li>
<li><p>電話の呼び数</p></li>
<li><p>渋滞していない高速道路の料金ゲートへの車の到着台数</p></li>
<li><p>医学研究において顕微鏡視野に入る区画当たりのバクテリア数</p></li>
<li><p>物理現象として単位時間当たりのガイガー計数管の読み数</p></li>
</ul>
</section>
</section>
<section id="id17">
<h3>例 1.4 (幾何分布)<a class="headerlink" href="#id17" title="Permalink to this headline">#</a></h3>
<p>成功 S (発生確率 <span class="math notranslate nohighlight">\(p\)</span>) と失敗 F (発生確率 <span class="math notranslate nohighlight">\(q = 1- p\)</span>) の 2 通りしかない試行を次々と続ける試行を考える. 最初の成功 S が出現するまでの試行回数を <span class="math notranslate nohighlight">\(x\)</span> とするならば <span class="math notranslate nohighlight">\(x = 1, 2, 3, \cdots\)</span> であり以下の確率質量関数で表現される確率分布を<strong>幾何分布</strong> (geometric distribution) という.</p>
<section id="id18">
<h4>確率質量関数<a class="headerlink" href="#id18" title="Permalink to this headline">#</a></h4>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p><span class="math notranslate nohighlight">\(0 \lt p \lt 1, q = 1 - p\)</span> とする.</p>
<div class="math notranslate nohighlight">
\[
    f(x) = pq^{x-1} \quad (x = 1, 2, 3, \cdots)
\]</div>
</div>
<p>これは <span class="math notranslate nohighlight">\(x\)</span> に応じて幾何級数 (等比数列) 的に減じていくため幾何分布という.<br />
　ここで<a class="reference internal" href="random_variables.html#discrete-distribution"><span class="std std-ref">離散型の確率分布の性質</span></a>を確認する.<br />
　確率質量関数の定義から <span class="math notranslate nohighlight">\(f(x) \geq 0\)</span> であることは自明. また, <span class="math notranslate nohighlight">\(0 \lt p \lt 1 \Rightarrow 0 \lt q \lt 1\)</span> なので無限等比級数の和から</p>
<div class="math notranslate nohighlight">
\[
\sum_{x=1}^{\infty}{f(x)} = p\sum_{x=1}^{\infty}{q} = p \cdot \frac{1}{1-q} = p \cdot \frac{1}{p} = 1
\]</div>
<p>と分かる.</p>
</section>
<section id="id19">
<h4>期待値と分散<a class="headerlink" href="#id19" title="Permalink to this headline">#</a></h4>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        &amp; {\rm E}(X) = \frac{1}{p} \\
        &amp; {\rm Var}(X) = \frac{q}{p^2}
    \end{align}
\end{split}\]</div>
</div>
<p><u>証明</u><br />
　<a class="reference internal" href="random_variables.html#expectation"><span class="std std-ref">期待値の定義</span></a>より</p>
<div class="math notranslate nohighlight">
\[
    \begin{align}
        {\rm E}(X) = \sum_{x=1}^{\infty}{x pq^{x-1}} = p \sum_{x=1}^{\infty}{ xq^{x-1} }
    \end{align}
\]</div>
<p><span class="math notranslate nohighlight">\(0 \lt q \lt 1\)</span> において</p>
<div class="math notranslate nohighlight">
\[
    g(q) = \sum_{x = 0}^{\infty}{q^x} = \frac{1}{1-q}
\]</div>
<p>を考える. 第 3 項については無限等比級数の和から分かる. <span class="math notranslate nohighlight">\(q\)</span> について微分すると</p>
<div class="math notranslate nohighlight">
\[
    g'(q) = \sum_{x = 1}^{\infty}{xq^{x-1}} = \frac{1}{(1-q)^2}
\]</div>
<p>となり <span class="math notranslate nohighlight">\(p = 1 - q\)</span> であることに注意して,</p>
<div class="math notranslate nohighlight">
\[
    {\rm E}(X) = p \sum_{x=1}^{\infty}{ xq^{x-1} } = p \cdot \frac{1}{(1-q)^2} = \frac{1}{p}
\]</div>
<p>と求められる. また分散について<a class="reference internal" href="random_variables.html#expect-variance"><span class="std std-ref">分散と期待値の関係式</span></a>から</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm Var}(X) &amp;= {\rm}E(X^2) - ({\rm E}(X))^2 \\
                     &amp;= {\rm}E(X(X-1)+X) - ({\rm E}(X))^2 \\
                     &amp;= {\rm}E(X(X-1)) + {\rm}E(X) - ({\rm E}(X))^2
    \end{align}
\end{split}\]</div>
<p>第 2 式から弟 3 式への変換は<a class="reference internal" href="random_variables.html#expectation-property"><span class="std std-ref">期待値の4番目の性質</span></a>を用いている.
　<span class="math notranslate nohighlight">\({\rm}E(X(X-1))\)</span> を求めれば分散が求められる. 上で用いた <span class="math notranslate nohighlight">\(g(q)\)</span> を 2 階微分すると</p>
<div class="math notranslate nohighlight">
\[
    g''(q) = \sum_{x = 2}^{\infty}{x(x-1)q^{x-2}} = \frac{2}{(1-q)^3}
\]</div>
<p>なので</p>
<div class="math notranslate nohighlight">
\[
    {\rm E}(X(X-1)) = pq \sum_{x=2}^{\infty}{ x(x-1)q^{x-2} } = pq \frac{2}{(1-q)^3} = \frac{2(1-q)}{p^2}
\]</div>
<p>となり分散は</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm Var}(X) &amp;= {\rm}E(X(X-1)) + {\rm}E(X) - ({\rm E}(X))^2 \\
                     &amp;= \frac{2(1-q)}{p^2} + \frac{1}{p} - \frac{1}{p^2} \\
                     &amp;= \frac{1-p}{p^2} \\
                     &amp;= \frac{q}{p^2}
    \end{align}
\end{split}\]</div>
<p>と分かる.</p>
</section>
<section id="id20">
<h4>関連Pythonモジュール<a class="headerlink" href="#id20" title="Permalink to this headline">#</a></h4>
<p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.geom.html#scipy.stats.geom"><code class="docutils literal notranslate"><span class="pre">scipy.stats.geom</span></code></a> を用いて生成する.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">geom</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>

<span class="c1"># 成功確率 p = 0.04 の幾何分布に従った疑似乱数を size = 100000 だけ生成する.</span>
<span class="n">p</span> <span class="o">=</span> <span class="mf">0.04</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">100000</span>
<span class="n">rvs</span> <span class="o">=</span> <span class="n">geom</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=========================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;幾何分布・擬似乱数&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=========================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rvs</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">100</span><span class="p">])</span>

<span class="c1"># 擬似乱数から期待値・分散の計算</span>
<span class="n">exp_rvs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rvs</span><span class="p">)</span>
<span class="n">var_rvs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">rvs</span><span class="p">)</span>
<span class="n">max_rvs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">rvs</span><span class="p">)</span>
<span class="n">min_rvs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">rvs</span><span class="p">)</span>

<span class="c1"># 期待値・分散の理論値</span>
<span class="n">exp_true</span> <span class="o">=</span> <span class="n">geom</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>
<span class="n">var_true</span> <span class="o">=</span> <span class="n">geom</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=========================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;幾何分布・期待値/分散&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=========================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;期待値(乱数 vs 真値): </span><span class="si">{</span><span class="n">exp_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">exp_true</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;分散(乱数 vs 真値): </span><span class="si">{</span><span class="n">var_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">var_true</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;最大値 (乱数): </span><span class="si">{</span><span class="n">max_rvs</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;最小値 (乱数): </span><span class="si">{</span><span class="n">min_rvs</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># 可視化</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;======================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;幾何分布&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;======================================&quot;</span><span class="p">)</span>

<span class="c1"># x軸</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_rvs</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># 図の定義</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

<span class="c1"># 乱数によるヒストグラム</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">rvs</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">stat</span><span class="o">=</span><span class="s2">&quot;probability&quot;</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;random variables&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>

<span class="c1"># 確率質量関数による真値</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">geom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;probability mass function&quot;</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Mass function&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=========================================
幾何分布・擬似乱数
=========================================
[ 12  10  25   2  53  68  22   5  32  35  47   3   3  68   7  11  24 101
   5 114  26  16  10  44   5  60  13   2   1 137  11  13   4  11  44  15
  21  34  10  33  27  96  43  42  29   2   2  14   3  49  29  37  10   4
  24  84  18  39  44  10   8   7   4  20  30  10  29   2  45 100  10  18
  27  63   4  21   9  25   7  17  26  30  26  40  50  41  15  19  12   4
  56  12   2  23  10   2   2  51  88   7]

=========================================
幾何分布・期待値/分散
=========================================
期待値(乱数 vs 真値): 24.88497 vs 25.0
分散(乱数 vs 真値): 599.9549780991 vs 600.0
最大値 (乱数): 325
最小値 (乱数): 1

======================================
幾何分布
======================================
</pre></div>
</div>
<img alt="../../_images/probability_distribution_26_1.png" src="../../_images/probability_distribution_26_1.png" />
</div>
</div>
</section>
<section id="id21">
<h4>ユースケース<a class="headerlink" href="#id21" title="Permalink to this headline">#</a></h4>
<ul class="simple">
<li><p>1年について確率 <span class="math notranslate nohighlight">\(p\)</span> で起こる災害が <span class="math notranslate nohighlight">\(x\)</span> 年以内に発生する分布として捕捉.</p></li>
</ul>
</section>
</section>
<section id="id22">
<h3>例 1.5 (負の二項分布)<a class="headerlink" href="#id22" title="Permalink to this headline">#</a></h3>
<p><strong>負の二項分布</strong> (negative binomial distribution) は幾何分布を一般化されたものであり, <span class="math notranslate nohighlight">\(n\)</span> 回目の成功を得るまでの失敗の回数を <span class="math notranslate nohighlight">\(x\)</span> とした時の確率分布である.</p>
<section id="id23">
<h4>確率質量関数<a class="headerlink" href="#id23" title="Permalink to this headline">#</a></h4>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p><span class="math notranslate nohighlight">\(x = 0, 1, \cdots\)</span> とする.</p>
<div class="math notranslate nohighlight">
\[
    f(x) = {}_{n+x-1}{\rm C}_{x} p^n q^x
\]</div>
</div>
<p><span class="math notranslate nohighlight">\(n=1\)</span> の時に幾何分布となる. ちなみに, 二項分布で二項係数に負も認めれば負の二項分布が求められるため, この名称となっている.<br />
　ここで<a class="reference internal" href="random_variables.html#discrete-distribution"><span class="std std-ref">離散型の確率分布の性質</span></a>を確認する.</p>
<p>確率質量関数の定義から <span class="math notranslate nohighlight">\(f(x) \geq 0\)</span> であることは自明. また確率質量関数の和が 1 となることについては, 負の二項展開式について考えるとすぐに導出できる. <span class="math notranslate nohighlight">\(n \in \mathbb{N}\)</span>, <span class="math notranslate nohighlight">\(r\)</span> <span class="math notranslate nohighlight">\((0 \leq r \leq n, r \in \mathbb{N})\)</span> として</p>
<div class="math notranslate nohighlight">
\[
    (1 + t)^{-n} = \sum_{x=0}^{n}{{}_{-n}{\rm C}_{x}t^x}
\]</div>
<p>とかけ,</p>
<div class="math notranslate nohighlight">
\[
    {}_{-n}{\rm C}_{x} = (-1)^x {}_{n+x-1}{\rm C}_{x}
\]</div>
<p>と表せる.
　<span class="math notranslate nohighlight">\(t = -(1-p)\)</span> として</p>
<div class="math notranslate nohighlight">
\[
    \frac{1}{p^n} = {1 -(1-p)}^{-n} = \sum_{x=0}^{\infty}{{}_{-n}{\rm C}_{x}(-(1-p))^x} = \sum_{x=0}^{\infty}{{}_{n+x-1}{\rm C}_{x}(1-p)^x}
\]</div>
<p>となるので, <span class="math notranslate nohighlight">\(q = 1 - p\)</span> であり上式に <span class="math notranslate nohighlight">\(p^n\)</span> をかけて</p>
<div class="math notranslate nohighlight">
\[
    \sum_{x=0}^{\infty}{{}_{n+x-1}{\rm C}_{x}p^n q^x} = 1
\]</div>
<p>となる.</p>
</section>
<section id="id24">
<h4>期待値と分散<a class="headerlink" href="#id24" title="Permalink to this headline">#</a></h4>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        &amp; {\rm E}(X) = \frac{nq}{p} \\
        &amp; {\rm Var}(X) = \frac{nq}{p^2}
    \end{align}
\end{split}\]</div>
</div>
<p><u>証明</u><br />
　<a class="reference internal" href="random_variables.html#expectation"><span class="std std-ref">期待値の定義</span></a>より</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm E}(X) &amp;= \sum_{x=0}^{\infty}{x {}_{ n+x-1 }{\rm C}_{ x } p^n q^x } \\
                   &amp;= \sum_{x=1}^{\infty}{x \frac{ (n+x-1)! }{ (n-1)! x! } p^n q^x } \\
                   &amp;= \sum_{x=1}^{\infty}{ \frac{ (n+x-1)! }{ (n-1)! (x-1)! } p^n q^x }
    \end{align}
\end{split}\]</div>
<p>ここで <span class="math notranslate nohighlight">\(y = x - 1\)</span>, <span class="math notranslate nohighlight">\(N = n + 1\)</span> と置換すると</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm E}(X) &amp;= \sum_{y=0}^{\infty}{ \frac{ (y + N -1)! }{ ( N-2 )! y! } p^{ N-1 } q^{ y+1 } } \\
                   &amp;= \frac{ q }{ p }(N-1) \sum_{y=0}^{\infty}{ \frac{ (y + N -1 )! }{ ( N-1 )! y! } p^{ N } q^{ y } } \\
                   &amp;= \frac{ q }{ p }(N-1) \\
                   &amp;= \frac{nq}{p}
    \end{align}
\end{split}\]</div>
<p>と求められる. また分散について<a class="reference internal" href="random_variables.html#expect-variance"><span class="std std-ref">分散と期待値の関係式</span></a>から</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm Var}(X) &amp;= {\rm}E(X^2) - ({\rm E}(X))^2 \\
                     &amp;= {\rm}E(X(X-1)+X) - ({\rm E}(X))^2 \\
                     &amp;= {\rm}E(X(X-1)) + {\rm}E(X) - ({\rm E}(X))^2
    \end{align}
\end{split}\]</div>
<p>第 2 式から弟 3 式への変換は<a class="reference internal" href="random_variables.html#expectation-property"><span class="std std-ref">期待値の4番目の性質</span></a>を用いている.<br />
　<span class="math notranslate nohighlight">\({\rm}E(X(X-1))\)</span> を求めれば分散が求められるので,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm E}(X(X-1)) &amp;= \sum_{x=0}^{\infty}{ x(x-1) {}_{ n+x-1 }{\rm C}_{ x } p^n q^x } \\
                        &amp;= \sum_{x=1}^{\infty}{ x(x-1) \frac{ (n+x-1)! }{ (n-1)! x! } p^n q^x } \\
                        &amp;= \sum_{x=2}^{\infty}{ \frac{ (n+x-1)! }{ (n-1)! (x-2)! } p^n q^x }
    \end{align}
\end{split}\]</div>
<p>となる. ここで <span class="math notranslate nohighlight">\(y = x - 2\)</span>, <span class="math notranslate nohighlight">\(N = n + 2\)</span> と置換すると</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm E}(X(X-1)) &amp;= \sum_{y=0}^{\infty}{ \frac{ (N + y - 1)! }{ (N - 3)! y! } p^{N - 2} q^{y + 2} } \\
                        &amp;= \frac{q^2}{p^2}(N-1)(N-2) \sum_{y=0}^{\infty}{ \frac{ (N+y-1)! }{ (N-1)! y! } p^{N} q^{y} } \\
                        &amp;= \frac{q^2}{p^2}(N-1)(N-2) \\
                        &amp;= \frac{q^2}{p^2}n(n + 1)
    \end{align}
\end{split}\]</div>
<p>となり分散は</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm Var}(X) &amp;= {\rm}E(X(X-1)) + {\rm}E(X) - ({\rm E}(X))^2 \\
                     &amp;= \frac{q^2}{p^2}n(n + 1) + \frac{nq}{p} - \frac{n^2 q^2}{p^2} \\
                     &amp;= \frac{nq}{p^2}
    \end{align}
\end{split}\]</div>
<p>と分かる.</p>
</section>
<section id="id25">
<h4>関連Pythonモジュール<a class="headerlink" href="#id25" title="Permalink to this headline">#</a></h4>
<p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.nbinom.html#scipy.stats.nbinom"><code class="docutils literal notranslate"><span class="pre">scipy.stats.nbinom</span></code></a> を用いて生成する.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">nbinom</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>

<span class="c1"># 成功確率 p = 0.20 の事象において n = 4 回成功するまでの失敗回数に関する負の二項分布に従った疑似乱数を size = 100000 だけ生成する.</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">p</span> <span class="o">=</span> <span class="mf">0.20</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">100000</span>
<span class="n">rvs</span> <span class="o">=</span> <span class="n">nbinom</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=========================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;負の二項分布・擬似乱数&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=========================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rvs</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">100</span><span class="p">])</span>

<span class="c1"># 擬似乱数から期待値・分散の計算</span>
<span class="n">exp_rvs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rvs</span><span class="p">)</span>
<span class="n">var_rvs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">rvs</span><span class="p">)</span>
<span class="n">max_rvs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">rvs</span><span class="p">)</span>
<span class="n">min_rvs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">rvs</span><span class="p">)</span>

<span class="c1"># 期待値・分散の理論値</span>
<span class="n">exp_true</span> <span class="o">=</span> <span class="n">nbinom</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>
<span class="n">var_true</span> <span class="o">=</span> <span class="n">nbinom</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=========================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;負の二項分布・期待値/分散&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=========================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;期待値(乱数 vs 真値): </span><span class="si">{</span><span class="n">exp_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">exp_true</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;分散(乱数 vs 真値): </span><span class="si">{</span><span class="n">var_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">var_true</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;最大値 (乱数): </span><span class="si">{</span><span class="n">max_rvs</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;最小値 (乱数): </span><span class="si">{</span><span class="n">min_rvs</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># 可視化</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;======================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;負の二項分布&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;======================================&quot;</span><span class="p">)</span>

<span class="c1"># x軸</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_rvs</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># 図の定義</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

<span class="c1"># 乱数によるヒストグラム</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">rvs</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">stat</span><span class="o">=</span><span class="s2">&quot;probability&quot;</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;random variables&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>

<span class="c1"># 確率質量関数による真値</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">nbinom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;probability mass function&quot;</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Mass function&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=========================================
負の二項分布・擬似乱数
=========================================
[28 24 21 14  7 10 10 28  9 13  2 20  4 10 12 19 20 16 11  4 23 12 10 12
 17  5 10  9 15  7 21 17 13 21  5 11 19 17 22  4 34 25 41  3  9 13 10 15
 13  8 13 12 21  9  8  7 30 18 50 10 46 19 14 16 34 24 15  8 17 25 18 14
 28 22 18 16 14 18 14 28 14 30 22 56 11 15 32 10 17 19 23 12 21 17 26 13
 18 17 11  5]

=========================================
負の二項分布・期待値/分散
=========================================
期待値(乱数 vs 真値): 15.98008 vs 16.0
分散(乱数 vs 真値): 79.9489231936 vs 79.99999999999999
最大値 (乱数): 80
最小値 (乱数): 0

======================================
負の二項分布
======================================
</pre></div>
</div>
<img alt="../../_images/probability_distribution_32_1.png" src="../../_images/probability_distribution_32_1.png" />
</div>
</div>
</section>
<section id="id26">
<h4>ユースケース<a class="headerlink" href="#id26" title="Permalink to this headline">#</a></h4>
<ul class="simple">
<li><p>購入頻度が負の二項分布に従う (<a class="reference external" href="https://qiita.com/nijigen_plot/items/9570487b73ad01fff36b">購買回数の分布と負の二項分布の関係</a>).</p></li>
</ul>
</section>
</section>
</section>
<section id="id27">
<h2>2. 連続型の確率分布<a class="headerlink" href="#id27" title="Permalink to this headline">#</a></h2>
<section id="id28">
<h3>例 2.1 (一様分布)<a class="headerlink" href="#id28" title="Permalink to this headline">#</a></h3>
<section id="id29">
<h4>確率密度関数<a class="headerlink" href="#id29" title="Permalink to this headline">#</a></h4>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p><strong>一様分布</strong> (uniform distribution) は <span class="math notranslate nohighlight">\(a &lt; b\)</span> とした時に以下の確率密度関数で表現される確率分布のことを指す.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        f(x) = \begin{cases}
            \dfrac{1}{b-a} &amp; (a \leq x \leq b) \\
            0             &amp; (x &lt; a, b &lt; x)
        \end{cases}
    \end{align}
\end{split}\]</div>
</div>
<p>ここで<a class="reference internal" href="random_variables.html#continuous-distribution"><span class="std std-ref">連続型の確率分布の性質</span></a>を確認する.<br />
　確率密度関数の定義から <span class="math notranslate nohighlight">\(f(x) \geq 0\)</span> であることは自明. また, 以下の計算から</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        \int_{- \infty}^{\infty}{f(x)dx} &amp;= \int_{- \infty}^{a}{0 \cdot dx} + \int_{- \infty}^{\infty}{\frac{dx}{b-a}} + \int_{b}^{\infty}{0 \cdot dx} \\
                                         &amp;= \biggl[ \frac{x}{b-a} \biggr]_{a}^{b} \\
                                         &amp;= \frac{b}{b-a} - \frac{a}{b-a} = 1.
    \end{align}
\end{split}\]</div>
</section>
<section id="id30">
<h4>期待値と分散<a class="headerlink" href="#id30" title="Permalink to this headline">#</a></h4>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        &amp; {\rm E}(X) = \frac{a + b}{2} \\
        &amp; {\rm Var}(X) = \frac{(b-a)^2}{12}
    \end{align}
\end{split}\]</div>
</div>
<p><u>証明</u><br />
　<a class="reference internal" href="random_variables.html#expectation"><span class="std std-ref">期待値の定義</span></a>より</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm E}(X) &amp;= \int_{ a }^{ b }{ \frac{x}{b-a}dx } \\
                   &amp;= \biggl[ \frac{x^2}{2(b-a)} \biggr]_{a}^{b} \\
                   &amp;= \frac{1}{2(b-a)}(b^2 - a^2) \\
                   &amp;= \frac{(b+a)(b-a)}{2(b-a)} = \frac{a + b}{2}
    \end{align}
\end{split}\]</div>
<p>と求められる. また分散について<a class="reference internal" href="random_variables.html#expect-variance"><span class="std std-ref">分散と期待値の関係式</span></a>から <span class="math notranslate nohighlight">\({\rm E}(X^2)\)</span> を求めればよい.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm E}(X^2) &amp;= \int_{ a }^{ b }{ \frac{x^2}{b-a}dx } \\
                   &amp;= \biggl[ \frac{x^x}{3(b-a)} \biggr]_{a}^{b} \\
                   &amp;= \frac{1}{x(b-a)}(b^3 - a^3) \\
                   &amp;= \frac{(b^2 + ab + a^2)(b-a)()}{3(b-a)} = \frac{a^2 + ab + b^2}{3}
    \end{align}
\end{split}\]</div>
<p>よって</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm Var}(X) &amp;= {\rm}E(X^2) - ({\rm E}(X))^2 \\
                     &amp;= \frac{a^2 + ab + b^2}{3} - \frac{(a + b)^2}{4} \\
                     &amp;= \frac{(b-a)^2}{12}
    \end{align}
\end{split}\]</div>
</section>
<section id="id31">
<h4>関連Pythonモジュール<a class="headerlink" href="#id31" title="Permalink to this headline">#</a></h4>
<p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.uniform.html#scipy.stats.uniform"><code class="docutils literal notranslate"><span class="pre">scipy.stats.uniform</span></code></a> を用いて生成する. <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.uniform.html#scipy.stats.uniform"><code class="docutils literal notranslate"><span class="pre">scipy.stats.uniform</span></code></a> では <code class="docutils literal notranslate"><span class="pre">loc</span></code>, <code class="docutils literal notranslate"><span class="pre">scale</span></code> のパラメータによって区間 <code class="docutils literal notranslate"><span class="pre">[loc,</span> <span class="pre">loc</span> <span class="pre">+</span> <span class="pre">scale]</span></code> の一様分布を生成する. この時, <code class="docutils literal notranslate"><span class="pre">loc</span></code> <span class="math notranslate nohighlight">\( = a\)</span>, <code class="docutils literal notranslate"><span class="pre">scale</span></code> <span class="math notranslate nohighlight">\( = b -a\)</span> である.<br />
　また, <a class="reference external" href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.Generator.uniform.html"><code class="docutils literal notranslate"><span class="pre">numpy.random.Generator.uniform</span></code></a> を用いても生成できる. ただし擬似乱数生成器の機能しかない.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">uniform</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>

<span class="c1"># loc = 3, scale = 8 に関する一様分布に従った疑似乱数を size = 100000 だけ生成する (a = 3, b = 11).</span>
<span class="n">loc</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">scale</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">100000</span>
<span class="n">rvs</span> <span class="o">=</span> <span class="n">uniform</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>

<span class="c1"># numpy を使用した擬似乱数生成</span>
<span class="n">low</span> <span class="o">=</span> <span class="n">loc</span>
<span class="n">high</span> <span class="o">=</span> <span class="n">loc</span> <span class="o">+</span> <span class="n">scale</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">()</span>
<span class="n">rvs_numpy</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="n">low</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="n">high</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=========================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;一様分布・擬似乱数&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=========================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rvs</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">100</span><span class="p">])</span>

<span class="c1"># 擬似乱数から期待値・分散の計算</span>
<span class="n">exp_rvs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rvs</span><span class="p">)</span>
<span class="n">var_rvs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">rvs</span><span class="p">)</span>
<span class="n">max_rvs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">rvs</span><span class="p">)</span>
<span class="n">min_rvs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">rvs</span><span class="p">)</span>

<span class="c1"># 期待値・分散の理論値</span>
<span class="n">exp_true</span> <span class="o">=</span> <span class="n">uniform</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>
<span class="n">var_true</span> <span class="o">=</span> <span class="n">uniform</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=========================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;一様分布・期待値/分散&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=========================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;期待値(乱数 vs 真値): </span><span class="si">{</span><span class="n">exp_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">exp_true</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;分散(乱数 vs 真値): </span><span class="si">{</span><span class="n">var_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">var_true</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;最大値 (乱数): </span><span class="si">{</span><span class="n">max_rvs</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;最小値 (乱数): </span><span class="si">{</span><span class="n">min_rvs</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># 可視化</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;======================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;一様分布&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;======================================&quot;</span><span class="p">)</span>

<span class="c1"># x軸</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_rvs</span> <span class="o">+</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># 図の定義</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

<span class="c1"># 乱数によるヒストグラム</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">hist</span><span class="p">([</span><span class="n">rvs</span><span class="p">,</span> <span class="n">rvs_numpy</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="s2">&quot;skyblue&quot;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;[SciPy] random variables&quot;</span><span class="p">,</span> <span class="s2">&quot;[NumPy] random variables&quot;</span><span class="p">])</span>

<span class="c1"># 確率質量関数による真値</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">uniform</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;probability density function&quot;</span><span class="p">)</span>

<span class="c1"># ax1.set_title(&quot;Mass function&quot;)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=========================================
一様分布・擬似乱数
=========================================
[ 9.95065512  6.49813316  7.68515292  6.44018504  4.89156344  4.46324227
  6.32769051 10.04815304  4.85728661  7.75358878  4.89624001  4.46252287
  5.01374982 10.89559954  7.2098469   6.61909724  8.23607335  7.83938134
  5.23790672  7.76578471  7.51763625 10.03306316 10.69633023  5.63304553
  6.85612567  3.34050016  7.09844287  7.84154807  6.68040171  5.37666393
  8.06861187  5.37056701  7.73186379  4.72960485  9.90314483  6.28297915
  9.95946764  3.58221712  6.53383242  3.37646909  5.05601151  3.47242238
  6.81961715  4.73973759  8.46290581  5.4986219   4.82042336  4.70064754
  9.83655385  4.92753148  3.13477314  3.1993617   4.11165284 10.61340077
 10.81796988  5.26187975  3.40482608  7.48412709  6.75338749  3.03543786
  5.78534164  6.02825652  5.93540719  8.37468458 10.64147265  3.6829674
  9.66665689  3.10204102  8.22110997  4.66456886  8.42479926  7.69269491
  8.16260313  8.53234849  3.59284219  8.41011392  3.36416211  8.8423773
 10.68205912  3.14284725  6.08907305  3.25714644  8.79141958 10.96514209
  3.85622802  8.91389051 10.87117559  3.96466692  3.55756781  5.22799807
  5.71533204  6.63163321  7.84868259  6.40701899  9.72294278  6.32203265
  6.69899345  3.59193916  5.81241377  3.98780659]

=========================================
一様分布・期待値/分散
=========================================
期待値(乱数 vs 真値): 6.99414300335008 vs 7.0
分散(乱数 vs 真値): 5.343248378675635 vs 5.333333333333333
最大値 (乱数): 10.999995522198578
最小値 (乱数): 3.0001857230117492

======================================
一様分布
======================================
</pre></div>
</div>
<img alt="../../_images/probability_distribution_39_1.png" src="../../_images/probability_distribution_39_1.png" />
</div>
</div>
</section>
<section id="id32">
<h4>ユースケース<a class="headerlink" href="#id32" title="Permalink to this headline">#</a></h4>
<ul class="simple">
<li><p>一様分布の擬似乱数をもとに他の分布の擬似乱数を生成</p></li>
<li><p>モンテカルロシミュレーションの初期値として一様分布疑似乱数を使用</p></li>
</ul>
</section>
</section>
<section id="normal-distribution">
<span id="id33"></span><h3>例 2.2 (正規分布)<a class="headerlink" href="#normal-distribution" title="Permalink to this headline">#</a></h3>
<section id="id34">
<h4>確率密度関数<a class="headerlink" href="#id34" title="Permalink to this headline">#</a></h4>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p><strong>正規分布</strong> (normal distribution, ガウス分布 &lt;Gaussian distribution&gt;ともいう) はパラメータ <span class="math notranslate nohighlight">\(\mu \geq 0, \sigma \gt 0\)</span> を用いて以下の確率密度関数をもつ分布. 後ほど証明するが, <span class="math notranslate nohighlight">\(\mu\)</span> は期待値, <span class="math notranslate nohighlight">\(\sigma^2\)</span> は分散となる.</p>
<div class="math notranslate nohighlight">
\[
    f(x) = \frac{1}{\sqrt{2\pi} \sigma} \exp{ \biggl( - \frac{(x -\mu)^2}{2 \sigma^2} \biggr) }
\]</div>
</div>
<p>ここで<a class="reference internal" href="random_variables.html#continuous-distribution"><span class="std std-ref">連続型の確率分布の性質</span></a>を確認する.<br />
　確率密度関数の定義から <span class="math notranslate nohighlight">\(f(x) \geq 0\)</span> であることは自明. また, <span class="math notranslate nohighlight">\(y = x - \mu\)</span> とすると, <span class="math notranslate nohighlight">\(dy = dx\)</span> で以下の計算のようになる.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        \int_{- \infty}^{\infty}{f(x)dx} &amp;= \frac{1}{\sqrt{2\pi} \sigma} \int_{- \infty}^{ \infty }{ \exp{ \biggl( - \frac{(x -\mu)^2}{2 \sigma^2} \biggr) } dx} \\
                                         &amp;= \frac{1}{\sqrt{2\pi} \sigma} \underline{ \int_{- \infty}^{ \infty }{ \exp{ \biggl( - \frac{ y^2 }{2 \sigma^2} \biggr) } dy} } \\
                                         &amp;= \frac{1}{\sqrt{2\pi} \sigma} \cdot \sqrt{2\pi} \sigma \\
                                         &amp;= 1.
    \end{align}
\end{split}\]</div>
<p>上記の下線部分は以下の<a class="reference internal" href="#gaussian-integral"><span class="std std-ref">ガウス積分</span></a>の結果を利用している.</p>
</section>
<section id="id35">
<h4>命題 2.2.1 (ガウス積分)<a class="headerlink" href="#id35" title="Permalink to this headline">#</a></h4>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<div class="math notranslate nohighlight" id="gaussian-integral">
\[
    \begin{align}
        I = \int_{- \infty}^{\infty}{ e^{-ax^2}dx } &amp;= \sqrt{\frac{\pi}{a}} \quad (a &gt; 0)
    \end{align}
\]</div>
</div>
<p><u>証明</u></p>
<p>これは以下の計算から分かる.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        I^2 &amp;= \int_{- \infty}^{\infty}{ e^{-ax^2}dx } \int_{- \infty}^{\infty}{ e^{-ay^2}dy } \\
            &amp;= \int_{- \infty}^{\infty}{ \int_{- \infty}^{\infty}{ e^{ -a(x^2 + y^2) }dxdy } }
    \end{align}
\end{split}\]</div>
<p>ここで <span class="math notranslate nohighlight">\(x = r\cos {\theta}\)</span>, <span class="math notranslate nohighlight">\(y = r\sin {\theta}\)</span> と置換すると, ヤコビアンは <span class="math notranslate nohighlight">\(r\)</span> より <span class="math notranslate nohighlight">\(dxdy = rdrd\theta\)</span> で, <span class="math notranslate nohighlight">\(\theta: 0 \rightarrow 2\pi\)</span>, <span class="math notranslate nohighlight">\(r: 0 \rightarrow \infty\)</span> より</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        I^2 &amp;= \int_{ 0 }^{ \infty }{ \int_{ 0 }^{ 2\pi }{ e^{ -ar^2 }rdrd\theta } } \\
            &amp;= 2 \pi \int_{ 0 }^{ \infty }{ e^{ -ar^2 }rdr  } \\
            &amp;= 2 \pi \biggl[ \frac{e^{-ar^2}}{-2a} \biggr]_{0}^{\infty} = \frac{\pi}{a}
    \end{align}
\end{split}\]</div>
<p>よって,</p>
<div class="math notranslate nohighlight">
\[
    \begin{align}
        I = \sqrt{\frac{\pi}{a}} \quad
    \end{align}
\]</div>
</section>
<section id="id36">
<h4>期待値と分散<a class="headerlink" href="#id36" title="Permalink to this headline">#</a></h4>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        &amp; {\rm E}(X) = \mu \\
        &amp; {\rm Var}(X) = \sigma^2
    \end{align}
\end{split}\]</div>
</div>
<p><u>証明</u><br />
　<a class="reference internal" href="random_variables.html#expectation"><span class="std std-ref">期待値の定義</span></a>より</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm E}(X) &amp;= \int_{ -\infty }^{ \infty }{ x \frac{1}{\sqrt{2\pi} \sigma} \exp{ \biggl( - \frac{(x -\mu)^2}{2 \sigma^2} \biggr) }dx } \\
                   &amp;= \int_{ -\infty }^{ \infty }{ \frac{1}{\sqrt{2\pi} \sigma} (\sigma y + \mu) \exp{ \biggl( - \frac{ y^2 }{2} \biggr) } \sigma dy } \quad (x-\mu=\sigma y) \\
                   &amp;= \frac{\sigma}{\sqrt{2 \pi}} \int_{ -\infty }^{ \infty }{ y \exp{\biggl( -\frac{y^2}{2} \biggr)} dy } + \frac{\mu}{\sqrt{2 \pi}} \int_{ -\infty }^{ \infty }{ \exp{\biggl( -\frac{y^2}{2} \biggr)} dy } \\
                   &amp;= \frac{\mu}{\sqrt{2 \pi}} \cdot \sqrt{2 \pi} = \mu
    \end{align}
\end{split}\]</div>
<p>と求められる. 第 1 項は奇関数のため 0 となる. また分散について<a class="reference internal" href="random_variables.html#expect-variance"><span class="std std-ref">分散と期待値の関係式</span></a>から <span class="math notranslate nohighlight">\({\rm E}(X^2)\)</span> を求めればよい.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm E}(X^2) &amp;= \int_{ -\infty }^{ \infty }{ x^2 \frac{1}{\sqrt{2\pi} \sigma} \exp{ \biggl( - \frac{(x -\mu)^2}{2 \sigma^2} \biggr) }dx } \\
                     &amp;= \frac{\sigma}{\sqrt{2 \pi} \sigma} \int_{ -\infty }^{ \infty }{ (\sigma y + \mu)^2 \exp{ \biggl( - \frac{y^2}{2} \biggr) }\sigma dy } \quad (x-\mu=\sigma y) \\
                     &amp;= \frac{1}{\sqrt{2 \pi}} \int_{ -\infty }^{ \infty }{ (\sigma^2 y^2 + 2 \sigma \mu y +  \mu^2) \exp{ \biggl( - \frac{y^2}{2} \biggr) } dy } \\
                     &amp;= \frac{\sigma^2}{\sqrt{2 \pi}} \int_{ -\infty }^{ \infty }{ y^2 \exp{ \biggl( - \frac{y^2}{2} \biggr) } dy } + \frac{\mu^2}{\sqrt{2 \pi}} \int_{ -\infty }^{ \infty }{ \exp{ \biggl( - \frac{y^2}{2} \biggr) } dy } \quad (\text{奇関数については0}) \\
                     &amp;= \frac{\sigma^2}{\sqrt{2 \pi}} \biggl\{ \biggl[ -yr^{\frac{-y^2}{2}}\biggr]_{-\infty}^{\infty} + \int_{ -\infty }^{ \infty }{ \exp{ \biggl( - \frac{y^2}{2} \biggr) } dy } \biggr\} + \frac{\mu^2}{\sqrt{2 \pi}} \int_{ -\infty }^{ \infty }{ \exp{ \biggl( - \frac{y^2}{2} \biggr) } dy } \quad (\text{第1項は部分積分}) \\
                     &amp;= \frac{\sigma^2}{\sqrt{2 \pi}} (0 + \sqrt{2 \pi}) + \frac{\mu^2}{\sqrt{2 \pi}} \cdot \sqrt{2 \pi} = \sigma^2 + \mu^2
    \end{align}
\end{split}\]</div>
<p>よって</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm Var}(X) &amp;= {\rm}E(X^2) - ({\rm E}(X))^2 \\
                     &amp;= \sigma^2 + \mu^2 - \mu^2 \\
                     &amp;= \sigma^2
    \end{align}
\end{split}\]</div>
</section>
<section id="id37">
<h4>関連Pythonモジュール<a class="headerlink" href="#id37" title="Permalink to this headline">#</a></h4>
<p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.norm.html#scipy.stats.norm"><code class="docutils literal notranslate"><span class="pre">scipy.stats.norm</span></code></a> を用いて生成する.<br />
　また, <a class="reference external" href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.Generator.normal.html"><code class="docutils literal notranslate"><span class="pre">numpy.random.Generator.normal</span></code></a> を用いても生成できる. ただし擬似乱数生成器の機能しかない.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>

<span class="c1"># loc = 10, scale = 2 に関する正規分布に従った疑似乱数を size = 100000 だけ生成する.</span>
<span class="n">loc</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">scale</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">100000</span>
<span class="n">rvs</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>

<span class="c1"># numpy を使用した擬似乱数生成</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">()</span>
<span class="n">rvs_numpy</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=========================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;正規分布・擬似乱数&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=========================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rvs</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">100</span><span class="p">])</span>

<span class="c1"># 擬似乱数から期待値・分散の計算</span>
<span class="n">exp_rvs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rvs</span><span class="p">)</span>
<span class="n">var_rvs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">rvs</span><span class="p">)</span>
<span class="n">max_rvs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">rvs</span><span class="p">)</span>
<span class="n">min_rvs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">rvs</span><span class="p">)</span>

<span class="c1"># 期待値・分散の理論値</span>
<span class="n">exp_true</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>
<span class="n">var_true</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=========================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;正規分布・期待値/分散&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=========================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;期待値(乱数 vs 真値): </span><span class="si">{</span><span class="n">exp_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">exp_true</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;分散(乱数 vs 真値): </span><span class="si">{</span><span class="n">var_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">var_true</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;最大値 (乱数): </span><span class="si">{</span><span class="n">max_rvs</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;最小値 (乱数): </span><span class="si">{</span><span class="n">min_rvs</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># 可視化</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;======================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;正規分布&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;======================================&quot;</span><span class="p">)</span>

<span class="c1"># x軸</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_rvs</span> <span class="o">+</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># 図の定義</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

<span class="c1"># 乱数によるヒストグラム</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">hist</span><span class="p">([</span><span class="n">rvs</span><span class="p">,</span> <span class="n">rvs_numpy</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="s2">&quot;skyblue&quot;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;[SciPy] random variables&quot;</span><span class="p">,</span> <span class="s2">&quot;[NumPy] random variables&quot;</span><span class="p">])</span>

<span class="c1"># 確率質量関数による真値</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;probability density function&quot;</span><span class="p">)</span>

<span class="c1"># ax1.set_title(&quot;Mass function&quot;)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=========================================
正規分布・擬似乱数
=========================================
[ 8.52432291 11.18604672 10.93026812 10.48388263  8.50666357 11.69789225
 12.22680988 10.8029566   8.57399401  8.08640617 15.85768921 10.09683162
 11.15917967 13.33517135  9.92720679 11.20385501  9.77216305 11.47165924
 15.15221008  8.96859431  9.57802678  9.91454242 10.1840107  12.22317572
 10.3571056   6.67185227  9.65537319  7.56087489  6.75179813 11.5464493
  7.67711436 10.19913441 11.66578403 11.73806474 11.5578451  11.11489058
  8.21109545  5.53997255 11.42222609  8.21596144 11.63582202 11.2938368
  5.64247411 11.88785734 10.46772369  9.69514741 12.0394441  11.1483408
 11.09643666 11.76462401  8.81784898  7.38313185  9.3887632   5.4781994
 10.34234273  6.63793771  8.8504272   9.47458223 12.6327981  10.95263761
  7.32274152 10.68468876 10.16554401 12.70036991 11.2093694  10.074052
 11.66356431  9.15601016  9.85853301 10.40828189 10.12187743 10.49309865
  8.761231    8.66606476 11.89475823  9.47637695 10.30357235  9.79539862
  9.38233764 10.18309708  8.04538081  8.91961607  9.2691468   8.51418987
  9.11054661 11.77412534  9.97588353  9.64098193 11.45028499 12.30511758
 11.34507065  5.38769591  9.27063714 11.68652268 11.03349055  9.4549378
 11.98438313 15.5886565  12.77157173 10.12692325]

=========================================
正規分布・期待値/分散
=========================================
期待値(乱数 vs 真値): 10.012437311810839 vs 10.0
分散(乱数 vs 真値): 3.945113239964285 vs 4.0
最大値 (乱数): 18.34730195461606
最小値 (乱数): 1.8218283772568942

======================================
正規分布
======================================
</pre></div>
</div>
<img alt="../../_images/probability_distribution_46_1.png" src="../../_images/probability_distribution_46_1.png" />
</div>
</div>
</section>
<section id="id38">
<h4>ユースケース<a class="headerlink" href="#id38" title="Permalink to this headline">#</a></h4>
<ul class="simple">
<li><p>工事中</p></li>
</ul>
</section>
<section id="id39">
<h4>定理 2.2.2 (中心極限定理)<a class="headerlink" href="#id39" title="Permalink to this headline">#</a></h4>
<p><strong>中心極限定理</strong> (central limit theorem) とは, いかなる確率分布でもその母集団から取り出した標本の平均値の分布は, 平均を計算する回数が大きくなるにつれて正規分布に近づくという定理. これを数学的に表現すると以下のように書ける.</p>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p>平均 <span class="math notranslate nohighlight">\(\mu\)</span>, 分散 <span class="math notranslate nohighlight">\(\sigma^2\)</span> の独立同分布の確率変数 <span class="math notranslate nohighlight">\(X_1, X_2, \cdots\)</span> に対して, <span class="math notranslate nohighlight">\(\overline{X}(n) = \frac{1}{n} \sum_{i=1}^{n}{X_i}\)</span> とおくと以下が成立する.</p>
<div class="math notranslate nohighlight">
\[
    \lim_{n \rightarrow \infty} {P \biggl(a \leq \frac{\overline{X}(n) - \mu}{\sigma / \sqrt{n}} \leq b \biggr)} = \int_{a}^{b}{ \frac{1}{\sqrt{2 \pi}} e^{-\frac{x^2}{2}} dx }
\]</div>
</div>
<p><u>証明</u></p>
<p><span class="math notranslate nohighlight">\(Y(n)\)</span> を以下のように定義する.</p>
<div class="math notranslate nohighlight">
\[
    Y(n) = \frac{\overline{X}(n) - \mu}{\sigma / \sqrt{n}}
\]</div>
<p>この時, <span class="math notranslate nohighlight">\(Y(n)\)</span> の積率母関数が <span class="math notranslate nohighlight">\(N(0,1)\)</span> の積率母関数に収束することを示せばよい.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        Y(n) &amp;= \frac{n\overline{X}(n) - n\mu}{\sigma \sqrt{n}} \\
             &amp;= \frac{ \sum_{i=1}^{n}{X_i} - \sum_{i=1}^{n}{\mu} }{\sigma \sqrt{n}} \\
             &amp;= \frac{1}{\sqrt{n}} \sum_{i=1}^{n}{ \frac{ X_i - \mu }{\sigma} }
    \end{align}
\end{split}\]</div>
<p>となるので, ここで確率変数 <span class="math notranslate nohighlight">\(Z_i = \dfrac{X_i - \mu}{\sigma}\)</span> を導入すると, <span class="math notranslate nohighlight">\(Z_i\)</span> は次の性質を示す.</p>
<div class="math notranslate nohighlight">
\[
    Y(n) = \frac{1}{\sqrt{n}} \sum_{i=1}^{n}{ Z_i } \quad {\rm E}(Z_i) = 0, \quad {\rm Var}(Z_i) = 1
\]</div>
<p><span class="math notranslate nohighlight">\(Y(n)\)</span> の積率母関数 <span class="math notranslate nohighlight">\(M_{Y(n)}(t)\)</span> は,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        M_{Y(n)}(t) &amp;= {\rm E}( \exp{ [ tY(n) ] } ) \\
                    &amp;= {\rm E}\biggl( \exp{ \biggl[ \frac{t}{\sqrt{n}} \sum_{i=1}^{n}{ Z_i } \biggr] } \biggr) \\
                    &amp;= {\rm E}\bigl( e^{\frac{t}{n}\sqrt{Z_1}} \times e^{\frac{t}{n}\sqrt{Z_2}} \times \cdots \times e^{\frac{t}{n}\sqrt{Z_n}} \bigr)
    \end{align}
\end{split}\]</div>
<p><span class="math notranslate nohighlight">\(X_1, X_2, \cdots\)</span> は互いに独立であり, その確率変数から定義された <span class="math notranslate nohighlight">\(Z_1, Z_2, \cdots\)</span> も互いに独立である. ゆえに上式は</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        M_{Y(n)}(t) &amp;= {\rm E}\bigl( e^{\frac{t}{n}\sqrt{Z_1}} \times e^{\frac{t}{n}\sqrt{Z_2}} \times \cdots \times e^{\frac{t}{n}\sqrt{Z_n}} \bigr) \\
                    &amp;= {\rm E}\bigl( e^{\frac{t}{n}\sqrt{Z_1}} \bigr) \times {\rm E}\bigl( e^{\frac{t}{n}\sqrt{Z_2}} \bigr) \times \cdots \times {\rm E}\bigl( e^{\frac{t}{n}\sqrt{Z_n}} \bigr)
    \end{align}
\end{split}\]</div>
<p>となる. また, <span class="math notranslate nohighlight">\(X_1, X_2, \cdots\)</span> は同じ確率分布であり, その確率変数から定義された <span class="math notranslate nohighlight">\(Z_1, Z_2, \cdots\)</span> も同じ確率分布なので上式はさらに</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        M_{Y(n)}(t) &amp;= \Bigl( {\rm E}\bigl( e^{\frac{t}{n}\sqrt{Z_1}} \bigr) \Bigr)^n \\
                    &amp;= \biggl( M_{Z_1} \biggl( \frac{t}{\sqrt{n}} \biggr) \biggr)^n \label{☆}\tag{☆}
    \end{align}
\end{split}\]</div>
<p>となり, <span class="math notranslate nohighlight">\(Z\)</span> の積率母関数の冪乗で表現できる. <span class="math notranslate nohighlight">\(M_{Z_1}(t)\)</span> に対してマクローリン展開を適応する.</p>
<div class="math notranslate nohighlight">
\[
    M_{Z_1}(t) = M_{Z_1}(0) + \left.\frac{dM_{Z_1}(t)}{dt}\right|_{t=0} t + \left.\frac{1}{2}\frac{d^2M_{Z_1}(t)}{dt^2}\right|_{t=0} t^2 + O(t^3)
\]</div>
<p>ここで,</p>
<div class="math notranslate nohighlight">
\[
    M_{Z_1}(0) = 1, \quad
    \left.\frac{dM_{Z_1}(t)}{dt}\right|_{t=0} = \mu_1 = {\rm E}(Z_1) = 0, \quad
    \left.\frac{1}{2}\frac{d^2M_{Z_1}(t)}{dt^2}\right|_{t=0} = \mu_2 = {\rm E}(X^2) = 1
\]</div>
<p>より <span class="math notranslate nohighlight">\(M_{Z_1}(t) = 1 + \dfrac{t^2}{2} + O(t^3)\)</span> である. よって</p>
<div class="math notranslate nohighlight">
\[
    M_{Z_1} \biggl( \frac{t}{\sqrt{n}} \biggr) = 1 + \frac{t^2}{2n} + O \biggl( \biggl( \frac{t}{\sqrt{n}} \biggr)^3 \biggr)
\]</div>
<p>なので, 式 <span class="math notranslate nohighlight">\((\ref{☆})\)</span> に代入すれば</p>
<div class="math notranslate nohighlight">
\[
    M_{Y_(n)} (t) = \biggl( 1 + \frac{t^2}{2n} + O \biggl( \biggl( \frac{t}{\sqrt{n}} \biggr)^3 \biggr) \biggr)^n.
\]</div>
<p>よって</p>
<div class="math notranslate nohighlight">
\[
    \lim_{n \rightarrow \infty}{M_{Y_(n)} (t)} = \lim_{n \rightarrow \infty}{ \biggl( 1 + \frac{t^2}{2n}  \biggr)^n } = e^{\frac{1}{2}t^2}
\]</div>
<p>これは <span class="math notranslate nohighlight">\(N(0,1)\)</span> の積率母関数と一致する.</p>
<p>python で中心極限定理を確認してみる.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">uniform</span><span class="p">,</span> <span class="n">norm</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>

<span class="c1"># ----------------------------------------------------------------------------------</span>
<span class="c1"># 一様分布に従う標本平均のサイズ数を増やすことで, 標本平均が正規分布に従うことの確認</span>
<span class="c1"># </span>
<span class="c1"># ** 1回の試行においてサンプル数を size で定義</span>
<span class="c1"># ** 標本平均のサイズ数については trials_list で徐々に増加</span>
<span class="c1"># ----------------------------------------------------------------------------------</span>
<span class="c1"># 図の定義</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>

<span class="c1"># x軸の定義</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.35</span><span class="p">,</span> <span class="mf">0.65</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>

<span class="c1"># 擬似乱数生成</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">trials_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">]</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">()</span>
<span class="n">j</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">for</span> <span class="n">trials</span> <span class="ow">in</span> <span class="n">trials_list</span><span class="p">:</span>
    <span class="n">means</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">trials</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">trials</span><span class="p">):</span>
        <span class="n">rvs</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
        <span class="n">means</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">rvs</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    
    <span class="c1"># 一様分布から抽出したサンプル平均を trials 回だけドローしたもののヒストグラム.</span>
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">means</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">stat</span><span class="o">=</span><span class="s2">&quot;probability&quot;</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;random variables&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>
    <span class="n">title</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;trials = </span><span class="si">{</span><span class="n">trials</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    
    <span class="c1"># 正規性を確認するための Q-Q プロット.</span>
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">j</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">stats</span><span class="o">.</span><span class="n">probplot</span><span class="p">(</span><span class="n">means</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="n">plt</span><span class="p">)</span>
    
    <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/probability_distribution_50_0.png" src="../../_images/probability_distribution_50_0.png" />
</div>
</div>
</section>
</section>
<section id="id40">
<h3>例 2.3 (対数正規分布)<a class="headerlink" href="#id40" title="Permalink to this headline">#</a></h3>
<section id="id41">
<h4>確率密度関数<a class="headerlink" href="#id41" title="Permalink to this headline">#</a></h4>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p><span class="math notranslate nohighlight">\(\log{X} \sim N(\mu, \sigma^2)\)</span> の時に元の <span class="math notranslate nohighlight">\(X (&gt;0)\)</span> は<strong>対数正規分布</strong> (log-normal distribution) に従うといい, 確率密度関数は以下のように表現できる.</p>
<div class="math notranslate nohighlight">
\[
    \begin{align}
        f(x) = \frac{1}{\sqrt{2 \pi} \sigma x} \exp{ \biggl( - \frac{ (\log {x} -\mu)^2 }{ 2 \sigma^2 } \biggr) }
    \end{align}
\]</div>
</div>
<p>これは <a class="reference internal" href="random_variables.html#exmaple-normal-lognormal"><span class="std std-ref">例 4.2 (正規分布と対数正規分布)</span></a> でも説明したように, <span class="math notranslate nohighlight">\(y = \log(x)\)</span> として <span class="math notranslate nohighlight">\(y \sim N(\mu, \sigma^2)\)</span> の場合に上式の密度関数が得られる.<br />
　ここで<a class="reference internal" href="random_variables.html#continuous-distribution"><span class="std std-ref">連続型の確率分布の性質</span></a>を確認する. 確率密度関数の定義から <span class="math notranslate nohighlight">\(f(x) \geq 0\)</span> であることは自明. また, <span class="math notranslate nohighlight">\(y = \log{x} \Leftrightarrow x = e^y\)</span> として,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        \int_{ 0 }^{ \infty }{ \frac{1}{\sqrt{2\pi} \sigma x} \exp{ \biggl( - \frac{( \log{x} -\mu)^2}{2 \sigma^2} \biggr) } dx} 
            &amp;= \int_{ -\infty }^{ \infty }{ \frac{1}{\sqrt{2\pi} \sigma e^y} \exp{ \biggl( - \frac{( y -\mu)^2}{2 \sigma^2} \biggr) } e^y dy} \\
            &amp;= \int_{ -\infty }^{ \infty }{ \frac{1}{\sqrt{2\pi} \sigma} \exp{ \biggl( - \frac{( y -\mu)^2}{2 \sigma^2} \biggr) } dy}
    \end{align}
\end{split}\]</div>
<p>となり正規分布と同じ式なので 1 となる.</p>
</section>
<section id="id42">
<h4>期待値と分散<a class="headerlink" href="#id42" title="Permalink to this headline">#</a></h4>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        &amp; {\rm E}(X) = \exp{ \biggl( \mu + \frac{\sigma^2}{2} \biggr) } \\
        &amp; {\rm Var}(X) = \exp{ ( 2\mu + 2\sigma^2) } - \exp{ ( 2\mu + \sigma^2) }
    \end{align}
\end{split}\]</div>
</div>
<p><u>証明</u><br />
　<a class="reference internal" href="random_variables.html#expectation"><span class="std std-ref">期待値の定義</span></a>と <span class="math notranslate nohighlight">\(y = \log{x} \Leftrightarrow x = e^y\)</span> で <span class="math notranslate nohighlight">\(dx = e^y dy\)</span> より</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm E}(X) &amp;= \int_{0}^{\infty}{ x \frac{1}{\sqrt{2 \pi} \sigma x} \exp{ \biggl( - \frac{ (\log {x} -\mu)^2 }{ 2 \sigma^2 } \biggr) } dx } \\
                   &amp;= \int_{-\infty}^{\infty}{ e^y \frac{1}{\sqrt{2 \pi} \sigma e^y} \exp{ \biggl( - \frac{ (y -\mu)^2 }{ 2 \sigma^2 } \biggr) } e^y dy } \\
                   &amp;= \int_{-\infty}^{\infty}{ \frac{1}{\sqrt{2 \pi} \sigma } \exp{ \biggl( - \frac{ (y -\mu)^2 }{ 2 \sigma^2 } + y \biggr) } dy }
    \end{align}
\end{split}\]</div>
<p><span class="math notranslate nohighlight">\(\exp\)</span> の中身を平方完成すると以下のようになる.</p>
<div class="math notranslate nohighlight">
\[
    - \frac{ (y -\mu)^2 }{ 2 \sigma^2 } + y = - \frac{(y - \mu - \sigma^2)^2 }{2 \sigma^2} + \mu + \frac{\sigma^2}{2}
\]</div>
<p>ここで, <span class="math notranslate nohighlight">\(t = y - \mu - \sigma^2\)</span> と置換して</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm E}(X) &amp;= \int_{-\infty}^{\infty}{ \frac{1}{\sqrt{2 \pi} \sigma } \exp{ \biggl( - \frac{(y - \mu - \sigma^2)^2 }{2 \sigma^2} + \mu + \frac{\sigma^2}{2} \biggr) } dy } \\
                   &amp;= \int_{-\infty}^{\infty}{ \frac{1}{\sqrt{2 \pi} \sigma } \exp{ \biggl( - \frac{ t^2 }{2 \sigma^2} + \mu + \frac{\sigma^2}{2} \biggr) } dy } \\
                   &amp;= \exp{ \biggl( \mu + \frac{\sigma^2}{2} \biggr) } \underline{\int_{-\infty}^{\infty}{ \frac{1}{\sqrt{2 \pi} \sigma } \exp{ \biggl( - \frac{ t^2 }{2 \sigma^2} \biggr) } dt }} \\
                   &amp;= \exp{ \biggl( \mu + \frac{\sigma^2}{2} \biggr) }
    \end{align}
\end{split}\]</div>
<p>と求められる. 下線部分は <a class="reference internal" href="#gaussian-integral"><span class="std std-ref">ガウス積分</span></a> によって計算できる.
また分散については<a class="reference internal" href="random_variables.html#expect-variance"><span class="std std-ref">分散と期待値の関係式</span></a>より</p>
<div class="math notranslate nohighlight">
\[
    \begin{align}
        {\rm Var}(X) &amp;= {\rm}E(X^2) - ({\rm E}(X))^2
    \end{align}
\]</div>
<p>なので <span class="math notranslate nohighlight">\({\rm}E(X^2)\)</span> を求める.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm E}(X^2) &amp;= \int_{0}^{\infty}{ x^2 \frac{1}{\sqrt{2 \pi} \sigma x} \exp{ \biggl( - \frac{ (\log {x} -\mu)^2 }{ 2 \sigma^2 } \biggr) } dx } \\
                   &amp;= \int_{-\infty}^{\infty}{ e^{2y} \frac{1}{\sqrt{2 \pi} \sigma e^y} \exp{ \biggl( - \frac{ (y -\mu)^2 }{ 2 \sigma^2 } \biggr) } e^y dy } \\
                   &amp;= \int_{-\infty}^{\infty}{ \frac{1}{\sqrt{2 \pi} \sigma } \exp{ \biggl( - \frac{ (y -\mu)^2 }{ 2 \sigma^2 } + 2y \biggr) } dy } \\
                   &amp;= \int_{-\infty}^{\infty}{ \frac{1}{\sqrt{2 \pi} \sigma } \exp{ \biggl( - \frac{(y - \mu - 2 \sigma^2)^2 }{2 \sigma^2} + 2 (\mu + \sigma^2) \biggr) } dy } \\
                   &amp;= \exp{ (2\mu + 2\sigma^2 ) } \int_{-\infty}^{\infty}{ \frac{1}{\sqrt{2 \pi} \sigma } \exp{ \biggl( - \frac{(y - \mu - 2 \sigma^2)^2 }{2 \sigma^2} \biggr) } dy } \\
                   &amp;= \exp{ (2\mu + 2\sigma^2 ) } \underline{ \int_{-\infty}^{\infty}{ \frac{1}{\sqrt{2 \pi} \sigma } \exp{ \biggl( - \frac{t^2 }{2 \sigma^2} \biggr) } dt } \quad (t = y - \mu - 2\sigma^2) } \\
                   &amp;= \exp{ (2\mu + 2\sigma^2 ) }
    \end{align}
\end{split}\]</div>
<p>である. 下線部分は <a class="reference internal" href="#gaussian-integral"><span class="std std-ref">ガウス積分</span></a> によって計算できる.
よって</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm Var}(X) &amp;= {\rm}E(X^2) - ({\rm E}(X))^2 \\
                     &amp;= \exp{ ( 2\mu + 2\sigma^2) } - \exp{ ( 2\mu + \sigma^2) }.
    \end{align}
\end{split}\]</div>
</section>
<section id="id43">
<h4>関連Pythonモジュール<a class="headerlink" href="#id43" title="Permalink to this headline">#</a></h4>
<p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.lognorm.html#scipy.stats.lognorm"><code class="docutils literal notranslate"><span class="pre">scipy.stats.lognorm</span></code></a> を用いて生成する.<br />
　また, <a class="reference external" href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.Generator.lognormal.html"><code class="docutils literal notranslate"><span class="pre">numpy.random.Generator.lognormal</span></code></a> を用いても生成できる. ただし擬似乱数生成器の機能しかない.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">lognorm</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>

<span class="c1"># log(X) が loc = 2, scale = 5 に関する正規分布に従った対数正規分布の疑似乱数を size = 100000 だけ生成する.</span>
<span class="n">s</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">loc</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">scale</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">100000</span>
<span class="n">rvs</span> <span class="o">=</span> <span class="n">lognorm</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>

<span class="c1"># numpy を使用した擬似乱数生成</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">()</span>
<span class="n">rvs_numpy</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">lognormal</span><span class="p">(</span><span class="n">mean</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=========================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;対数正規分布・擬似乱数&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=========================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rvs</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">100</span><span class="p">])</span>

<span class="c1"># 擬似乱数から期待値・分散の計算</span>
<span class="n">exp_rvs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rvs</span><span class="p">)</span>
<span class="n">var_rvs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">rvs</span><span class="p">)</span>
<span class="n">max_rvs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">rvs</span><span class="p">)</span>
<span class="n">min_rvs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">rvs</span><span class="p">)</span>

<span class="c1"># 期待値・分散の理論値</span>
<span class="n">exp_true</span> <span class="o">=</span> <span class="n">lognorm</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>
<span class="n">var_true</span> <span class="o">=</span> <span class="n">lognorm</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=========================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;対数分布・期待値/分散&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=========================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;期待値(乱数 vs 真値): </span><span class="si">{</span><span class="n">exp_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">exp_true</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;分散(乱数 vs 真値): </span><span class="si">{</span><span class="n">var_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">var_true</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;最大値 (乱数): </span><span class="si">{</span><span class="n">max_rvs</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;最小値 (乱数): </span><span class="si">{</span><span class="n">min_rvs</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># 可視化</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;======================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;対数分布&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;======================================&quot;</span><span class="p">)</span>

<span class="c1"># x軸</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># 図の定義</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

<span class="c1"># 乱数によるヒストグラム</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">rvs</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;[SciPy] random variables&quot;</span><span class="p">)</span>

<span class="c1"># 確率質量関数による真値</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">lognorm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;probability density function&quot;</span><span class="p">)</span>

<span class="c1"># ax1.set_title(&quot;Mass function&quot;)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=========================================
対数正規分布・擬似乱数
=========================================
[ 4.51604874  3.62479492  9.15891162 13.5965129  21.94641852  8.00623264
  3.43929397  3.32784162  9.71489498  3.5795588   5.21589024  8.85859552
  5.0180183   3.87489561  7.15985025  6.34664561 25.8038001   3.16065991
 10.58483667  4.22285878 11.74472401  5.8182768   2.48418055  3.62869172
 13.49819193  3.61425213  5.17196568  7.83951484  7.13873145  6.83900631
 12.05867065 17.98157247 10.28695395  6.60748251 11.10963684  4.38281418
  3.22111951 14.53229684  8.55101104  2.41006703  2.82897151 13.393126
  6.1551381  20.52481629 33.85056718 10.16991823  3.60756571 14.33604439
  4.43351904 14.42895683 16.79719153  3.32629213  8.28061346  6.38144147
 19.87837971  2.72223255  4.24755707 18.33406012  6.79281082  4.12354844
 10.92527741  8.45126522  5.46487294 10.43282048  5.57713854  6.52402313
  4.98637688 12.94196351  4.81919796 38.4987008  12.84181394  8.87347157
 16.22923782  5.39773286  3.14117886  6.13213746  2.44721656 18.29417073
  5.06027306  6.35655013  3.25199765  2.92475731  6.73157063  5.01406944
  4.48333119  8.06089684 21.89583832  3.95771958 22.33499778  2.92618352
  7.15487036  3.95403957  5.29087944  3.68475001 10.87642506  8.03224714
  4.84605566  6.95422001  7.1234853   3.1566656 ]

=========================================
対数分布・期待値/分散
=========================================
期待値(乱数 vs 真値): 10.299703688098585 vs 10.243606353500642
分散(乱数 vs 真値): 121.0699429797167 vs 116.7693567617901
最大値 (乱数): 431.2652867467603
最小値 (乱数): 2.0599609799583134

======================================
対数分布
======================================
</pre></div>
</div>
<img alt="../../_images/probability_distribution_55_1.png" src="../../_images/probability_distribution_55_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">)</span>

<span class="c1"># 図の定義</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>


<span class="n">parameters</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mf">1.0</span><span class="p">],</span>
    <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mf">1.0</span><span class="p">],</span>
    <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="mf">1.0</span><span class="p">],</span>
<span class="p">]</span>

<span class="k">for</span> <span class="n">scale</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">parameters</span><span class="p">:</span>
    <span class="c1"># 確率質量関数による真値</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">lognorm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>
    <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;mu = </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">scale</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2">, sigma = </span><span class="si">{</span><span class="n">s</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>

<span class="c1"># ax1.set_title(&quot;Mass function&quot;)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/probability_distribution_56_0.png" src="../../_images/probability_distribution_56_0.png" />
</div>
</div>
</section>
<section id="id44">
<h4>ユースケース<a class="headerlink" href="#id44" title="Permalink to this headline">#</a></h4>
<ul class="simple">
<li><p>世帯年収</p></li>
</ul>
</section>
</section>
<section id="id45">
<h3>例 2.4 (指数分布)<a class="headerlink" href="#id45" title="Permalink to this headline">#</a></h3>
<section id="id46">
<h4>確率密度関数<a class="headerlink" href="#id46" title="Permalink to this headline">#</a></h4>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p><strong>指数分布</strong> (exponential distribution) は <span class="math notranslate nohighlight">\(\lambda &gt; 0\)</span> として以下の確率密度関数で表現できる.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        f(x) = \begin{cases}
            \lambda e^{-\lambda x}  &amp; (x \geq 0) \\
            0 &amp; (x &lt; 0)
        \end{cases}
    \end{align}
\end{split}\]</div>
</div>
<p>ここで<a class="reference internal" href="random_variables.html#continuous-distribution"><span class="std std-ref">連続型の確率分布の性質</span></a>を確認する. 確率密度関数の定義から <span class="math notranslate nohighlight">\(f(x) \geq 0\)</span> であることは自明. また,</p>
<div class="math notranslate nohighlight">
\[
    \begin{align}
        \int_{0}^{\infty}{\lambda e^{-\lambda x} dx} = \biggl[ -e^{-\lambda x} \biggr]_{0}^{\infty} = 1
    \end{align}
\]</div>
</section>
<section id="id47">
<h4>期待値と分散<a class="headerlink" href="#id47" title="Permalink to this headline">#</a></h4>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        &amp; {\rm E}(X) = \frac{1}{\lambda} \\
        &amp; {\rm Var}(X) = \frac{1}{\lambda^2}
    \end{align}
\end{split}\]</div>
</div>
<p><u>証明</u><br />
　<a class="reference internal" href="random_variables.html#expectation"><span class="std std-ref">期待値の定義</span></a>より</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm E}(X) &amp;= \int_{0}^{\infty}{x \lambda e^{-\lambda x} dx } \\
                   &amp;= \biggl[ -xe^{-\lambda x} \biggr]_{0}^{\infty} + \int_{0}^{\infty}{e^{-\lambda x}dx} \\
                   &amp;= \biggl[ -\frac{1}{\lambda} e^{-\lambda x} \biggr]_{0}^{\infty} \\
                   &amp;= \frac{1}{\lambda}
    \end{align}
\end{split}\]</div>
<p>と求められる. また分散について<a class="reference internal" href="random_variables.html#expect-variance"><span class="std std-ref">分散と期待値の関係式</span></a>から <span class="math notranslate nohighlight">\({\rm E}(X^2)\)</span> を求めればよい. 部分積分を 2 回行うことで計算できる.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm E}(X^2) &amp;= \int_{0}^{\infty}{x^2 \lambda e^{-\lambda x} dx} \\
                     &amp;= \biggl[ -x^2e^{-\lambda x} \biggr]_{0}^{\infty} - \frac{2}{\lambda} \biggl[ -xe^{-\lambda x} \biggr]_{0}^{\infty} + \frac{2}{\lambda} \int_{0}^{\infty}{e^{-\lambda x}dx} \\
                     &amp;= \frac{2}{\lambda}\biggl[ -\frac{1}{\lambda} e^{-\lambda x} \biggr]_{0}^{\infty} \\
                     &amp;= \frac{2}{\lambda^2}
    \end{align}
\end{split}\]</div>
<p>よって</p>
<div class="math notranslate nohighlight">
\[
    \begin{align}
        {\rm Var}(X) = \frac{2}{\lambda^2} - \frac{1}{\lambda^2} = \frac{1}{\lambda^2}.
    \end{align}
\]</div>
</section>
<section id="id48">
<h4>関連Pythonモジュール<a class="headerlink" href="#id48" title="Permalink to this headline">#</a></h4>
<p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.expon.html#scipy.stats.expon"><code class="docutils literal notranslate"><span class="pre">scipy.stats.expon</span></code></a> を用いて生成する.<br />
　また, <a class="reference external" href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.Generator.exponential.html"><code class="docutils literal notranslate"><span class="pre">numpy.random.Generator.exponential</span></code></a> を用いても生成できる. ただし擬似乱数生成器の機能しかない. いずれにおいても <code class="docutils literal notranslate"><span class="pre">scale</span> <span class="pre">=</span> <span class="pre">1</span> <span class="pre">/</span> <span class="pre">lambda</span></code> という関係になっていることに注意.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">expon</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>

<span class="c1"># lambda = 10 (scale = 1/10) に関する指数分布に従った疑似乱数を size = 100000 だけ生成する.</span>
<span class="n">scale</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">10</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">100000</span>
<span class="n">rvs</span> <span class="o">=</span> <span class="n">expon</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>

<span class="c1"># numpy を使用した擬似乱数生成</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">()</span>
<span class="n">rvs_numpy</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">exponential</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=========================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;指数分布・擬似乱数&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=========================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rvs</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">100</span><span class="p">])</span>

<span class="c1"># 擬似乱数から期待値・分散の計算</span>
<span class="n">exp_rvs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rvs</span><span class="p">)</span>
<span class="n">var_rvs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">rvs</span><span class="p">)</span>
<span class="n">max_rvs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">rvs</span><span class="p">)</span>
<span class="n">min_rvs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">rvs</span><span class="p">)</span>

<span class="c1"># 期待値・分散の理論値</span>
<span class="n">exp_true</span> <span class="o">=</span> <span class="n">expon</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>
<span class="n">var_true</span> <span class="o">=</span> <span class="n">expon</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=========================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;指数分布・期待値/分散&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=========================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;期待値(乱数 vs 真値): </span><span class="si">{</span><span class="n">exp_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">exp_true</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;分散(乱数 vs 真値): </span><span class="si">{</span><span class="n">var_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">var_true</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;最大値 (乱数): </span><span class="si">{</span><span class="n">max_rvs</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;最小値 (乱数): </span><span class="si">{</span><span class="n">min_rvs</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># 可視化</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;======================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;指数分布&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;======================================&quot;</span><span class="p">)</span>

<span class="c1"># x軸</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_rvs</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>

<span class="c1"># 図の定義</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

<span class="c1"># 乱数によるヒストグラム</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">hist</span><span class="p">([</span><span class="n">rvs</span><span class="p">,</span> <span class="n">rvs_numpy</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="s2">&quot;skyblue&quot;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;[SciPy] random variables&quot;</span><span class="p">,</span> <span class="s2">&quot;[NumPy] random variables&quot;</span><span class="p">])</span>

<span class="c1"># 確率質量関数による真値</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">expon</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;probability density function&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=========================================
指数分布・擬似乱数
=========================================
[0.07370654 0.30736603 0.19954808 0.11360876 0.07173447 0.07220122
 0.09482631 0.04509634 0.03992094 0.04255646 0.00845164 0.20863935
 0.38642806 0.07887644 0.01009299 0.01036269 0.23254007 0.14825816
 0.13430526 0.06858659 0.01173542 0.05174213 0.05679711 0.10123393
 0.25291761 0.22698255 0.04674577 0.07596912 0.031338   0.06677979
 0.01571296 0.05042136 0.29025925 0.18825697 0.01194125 0.00174347
 0.19410898 0.01046316 0.01202204 0.13071102 0.08133563 0.11040071
 0.05839104 0.05501627 0.01428452 0.01430032 0.02868289 0.08707259
 0.11442783 0.00998695 0.05064915 0.12659075 0.06918623 0.0573619
 0.06772698 0.0027412  0.02867719 0.00502019 0.12310379 0.0351919
 0.01910275 0.21214309 0.01089133 0.00095497 0.04337098 0.14136863
 0.29305851 0.00908271 0.01366843 0.04449046 0.00670723 0.01584628
 0.02411949 0.02735016 0.02448264 0.09792772 0.16522076 0.34314946
 0.11533613 0.0500577  0.03961539 0.02754275 0.18101273 0.04447901
 0.15570095 0.06082735 0.08416347 0.04651815 0.00525486 0.04626102
 0.32081286 0.13930871 0.1924615  0.05017337 0.00731304 0.18237449
 0.10312823 0.2319794  0.27782702 0.13001967]

=========================================
指数分布・期待値/分散
=========================================
期待値(乱数 vs 真値): 0.1003143976584733 vs 0.1
分散(乱数 vs 真値): 0.009977124846355136 vs 0.010000000000000002
最大値 (乱数): 1.2520624797117967
最小値 (乱数): 1.4771014922810562e-06

======================================
指数分布
======================================
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7f8bb2bc9700&gt;
</pre></div>
</div>
<img alt="../../_images/probability_distribution_62_2.png" src="../../_images/probability_distribution_62_2.png" />
</div>
</div>
</section>
<section id="id49">
<h4>ユースケース<a class="headerlink" href="#id49" title="Permalink to this headline">#</a></h4>
<ul class="simple">
<li><p>工事中</p></li>
</ul>
</section>
</section>
<section id="id50">
<h3>例 2.5 (ガンマ分布)<a class="headerlink" href="#id50" title="Permalink to this headline">#</a></h3>
<section id="id51">
<h4>確率密度関数<a class="headerlink" href="#id51" title="Permalink to this headline">#</a></h4>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p><strong>ガンマ分布</strong> (Gamma distribution) は <span class="math notranslate nohighlight">\(\lambda &gt; 0, \alpha &gt; 0\)</span> として以下の確率密度関数で表現できる.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        f(x) = \begin{cases}
            \dfrac{\lambda^\alpha}{\varGamma(\alpha)} x^{\alpha - 1}e^{-\lambda x}  &amp; (x \geq 0) \\
            0 &amp; (x &lt; 0)
        \end{cases}
    \end{align}
\end{split}\]</div>
<p>ここで <span class="math notranslate nohighlight">\(\varGamma(\alpha)\)</span> は以下で定義され<strong>ガンマ関数</strong> という.</p>
<div class="math notranslate nohighlight">
\[
    \begin{align}
        \varGamma(\alpha) = \int_{0}^{\infty}{x^{\alpha - 1}e^{-x}dx}
    \end{align}
\]</div>
</div>
<p><span class="math notranslate nohighlight">\(\alpha = 1\)</span> ならば指数分布になることが分かる.<br />
　ここで<a class="reference internal" href="random_variables.html#continuous-distribution"><span class="std std-ref">連続型の確率分布の性質</span></a>を確認する. 確率密度関数の定義から <span class="math notranslate nohighlight">\(f(x) \geq 0\)</span> であることは自明. また合計和が 1 になることは以下についてまず示す.</p>
<div class="math notranslate nohighlight">
\[
    \begin{align}
        \int_{0}^{\infty}{x^{\alpha-1}e^{-\lambda x}dx} = \frac{\varGamma(\alpha)}{\lambda^(\alpha)}
    \end{align}
\]</div>
<p><span class="math notranslate nohighlight">\(\lambda x = y\)</span> とすれば <span class="math notranslate nohighlight">\(\lambda dx = dy\)</span> より</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        \int_{0}^{\infty}{x^{\alpha-1}e^{-\lambda x}dx} &amp;= \int_{0}^{\infty}{ \biggl( \frac{y}{\lambda} \biggr) ^{\alpha - 1} e^{-y} \frac{1}{\lambda} dy } \\
                                                        &amp;= \frac{1}{\lambda^\alpha} \int_{0}^{\infty}{y^{\alpha-1}e^{-y}dy} \\
                                                        &amp;= \frac{\varGamma(\alpha)}{\lambda^(\alpha)}
    \end{align}
\end{split}\]</div>
<p>ゆえに以下のように計算できる.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        \int_{0}^{\infty}{ \frac{ \lambda^\alpha }{ \varGamma(\alpha) } x^{\alpha - 1} e^{-\lambda x} dx } 
            &amp;= \frac{\lambda^{\alpha}}{\varGamma(\alpha)} \int_{0}^{\infty}{x^{\alpha-1}e^{-\lambda x}dx} \\
            &amp;= \frac{\lambda^{\alpha}}{\varGamma(\alpha)} \cdot \frac{\varGamma(\alpha)}{\lambda^(\alpha)} \\
            &amp;= 1.
    \end{align}
\end{split}\]</div>
</section>
<section id="id52">
<h4>期待値と分散<a class="headerlink" href="#id52" title="Permalink to this headline">#</a></h4>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        &amp; {\rm E}(X) = \frac{\alpha}{\lambda} \\
        &amp; {\rm Var}(X) = \frac{\alpha}{\lambda^2}
    \end{align}
\end{split}\]</div>
</div>
<p><u>証明</u><br />
　<a class="reference internal" href="random_variables.html#expectation"><span class="std std-ref">期待値の定義</span></a>と<a class="reference internal" href="#gamma-function"><span class="std std-ref">ガンマ関数の性質</span></a>から <span class="math notranslate nohighlight">\(\varGamma(\alpha + 1) = \alpha \varGamma(\alpha)\)</span> となることに注意して</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm E}(X) &amp;= \int_{0}^{\infty}{ x \frac{\lambda^\alpha}{\varGamma(\alpha)} x^{\alpha - 1}e^{-\lambda x} dx } \\
                   &amp;= \int_{0}^{\infty}{ \frac{\alpha \lambda^\alpha}{\varGamma(\alpha + 1)} x^{\alpha}e^{-\lambda x} dx } \\
                   &amp;= \frac{\alpha}{\lambda} \int_{0}^{\infty}{ \frac{\lambda^{\alpha + 1}}{\varGamma(\alpha + 1)} x^{(\alpha+1)-1}e^{-\lambda x} dx } \\
                   &amp;= \frac{\alpha}{\lambda}
    \end{align}
\end{split}\]</div>
<p>と求められる. た分散について<a class="reference internal" href="random_variables.html#expect-variance"><span class="std std-ref">分散と期待値の関係式</span></a>から <span class="math notranslate nohighlight">\({\rm E}(X^2)\)</span> を求めればよい. <a class="reference internal" href="#gamma-function"><span class="std std-ref">ガンマ関数の性質</span></a>から <span class="math notranslate nohighlight">\(\varGamma(\alpha + 2) = (\alpha + 1)\varGamma(\alpha + 1) = (\alpha + 1)\alpha \varGamma(\alpha)\)</span> であることより</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm E}(X^2) &amp;= \int_{0}^{\infty}{ x^2 \frac{\lambda^\alpha}{\varGamma(\alpha)} x^{\alpha - 1}e^{-\lambda x} dx } \\
                     &amp;= \int_{0}^{\infty}{ \frac{\alpha (\alpha + 1) \lambda^\alpha}{\varGamma(\alpha + 2)} x^{\alpha + 1}e^{-\lambda x} dx } \\
                     &amp;= \frac{\alpha(\alpha + 1)}{\lambda^2} \int_{0}^{\infty}{ \frac{\lambda^{\alpha + 2}}{\varGamma(\alpha + 2)} x^{(\alpha+2)-1}e^{-\lambda x} dx } \\
                     &amp;= \frac{\alpha(\alpha + 1)}{\lambda^2}
    \end{align}
\end{split}\]</div>
<p>よって</p>
<div class="math notranslate nohighlight">
\[
    \begin{align}
        {\rm Var}(X) = \frac{\alpha(\alpha + 1)}{\lambda^2} - \frac{\alpha^2}{\lambda^2} = \frac{\alpha}{\lambda^2}.
    \end{align}
\]</div>
</section>
<section id="id53">
<h4>命題 2.5.1 (ガンマ関数の性質)<a class="headerlink" href="#id53" title="Permalink to this headline">#</a></h4>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<div class="math notranslate nohighlight" id="gamma-function">
\[\begin{split}
    \begin{align}
        &amp; \varGamma(\alpha) = (\alpha - 1)\varGamma(\alpha) \\
        &amp; \varGamma(n + 1) = n! \quad (n \text{は正整数とする}) \\
        &amp; \varGamma \biggl( \frac{1}{2} \biggr) = \sqrt{\pi}
    \end{align}
\end{split}\]</div>
</div>
<p><u>証明</u>
　一つ目について部分積分より</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        \varGamma(\alpha) &amp;= \int_{0}^{\infty}{x^{\alpha-1}e^{-x}dx} \\
                          &amp;= \biggl[ -x^{\alpha-1}e^{-x} \biggr]_{0}^{\infty} + (\alpha - 1) \int_{0}^{\infty}{x^{\alpha-2}x^{-2}dx} \\
                          &amp;= (\alpha - 1) \varGamma(\alpha - 1)
    \end{align}
\end{split}\]</div>
<p>と求められる. また <span class="math notranslate nohighlight">\(\varGamma(1)\)</span> について</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        \varGamma(1) &amp;= \int_{0}^{\infty}{e^{-x}dx} \\
                     &amp;= \biggl[ -e^{-x} \biggr]_{0}^{\infty} \\
                     &amp;= 1
    \end{align}
\end{split}\]</div>
<p>なので, <span class="math notranslate nohighlight">\(n \in \mathbb{N}\)</span> として</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        \varGamma(n + 1) &amp;= n \varGamma(n) \\
                         &amp;= n(n-1) \varGamma(n-1) \\
                         &amp;\cdots \\
                         &amp;= n(n-1) \cdots 1 \varGamma(1) \\
                         &amp;= n!
    \end{align}
\end{split}\]</div>
<p>と分かる. 最後に<a class="reference internal" href="#gaussian-integral"><span class="std std-ref">ガウス積分</span></a>を用いて以下のように計算できる.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        \varGamma\biggl(\frac{1}{2}\biggr) &amp;= \int_{0}^{\infty}{x^{-\frac{1}{2}}e^{-x}dx} \\
                                           &amp;= \int_{0}^{\infty}{ \frac{e^{-x}}{\sqrt{x}}dx} \\
                                           &amp;= \int_{0}^{\infty}{ \frac{e^{-t^2}}{t}2tdt} \quad (t = \sqrt{x}) \\
                                           &amp;= 2 \int_{0}^{\infty}{e^{-t^2}dt} \\
                                           &amp;= \sqrt{\pi}
    \end{align}
\end{split}\]</div>
</section>
<section id="id54">
<h4>関連Pythonモジュール<a class="headerlink" href="#id54" title="Permalink to this headline">#</a></h4>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.gamma.html#scipy.stats.gamma"><code class="docutils literal notranslate"><span class="pre">scipy.stats.gamma</span></code></a></p>
<ul>
<li><p>引数</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">a</span></code>: <span class="math notranslate nohighlight">\(\alpha\)</span> に相当.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">scale</span></code>: <span class="math notranslate nohighlight">\(\dfrac{1}{\lambda}\)</span> に相当.</p></li>
</ul>
</li>
</ul>
</li>
</ul>
<br>
<ul class="simple">
<li><p><a class="reference external" href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.Generator.gamma.html"><code class="docutils literal notranslate"><span class="pre">numpy.random.Generator.gamma</span></code></a></p>
<ul>
<li><p>引数</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">shape</span></code>: <span class="math notranslate nohighlight">\(\alpha\)</span> に相当.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">scale</span></code>: <span class="math notranslate nohighlight">\(\dfrac{1}{\lambda}\)</span> に相当.</p></li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">gamma</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>

<span class="c1"># alpha = 2, lambda = 1 (scale = 1/1) に関する指数分布に従った疑似乱数を size = 100000 だけ生成する.</span>
<span class="n">a</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">scale</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">100000</span>
<span class="n">rvs</span> <span class="o">=</span> <span class="n">gamma</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>

<span class="c1"># numpy を使用した擬似乱数生成</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">()</span>
<span class="n">rvs_numpy</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=========================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ガンマ分布・擬似乱数&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=========================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rvs</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">100</span><span class="p">])</span>

<span class="c1"># 擬似乱数から期待値・分散の計算</span>
<span class="n">exp_rvs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rvs</span><span class="p">)</span>
<span class="n">var_rvs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">rvs</span><span class="p">)</span>
<span class="n">max_rvs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">rvs</span><span class="p">)</span>
<span class="n">min_rvs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">rvs</span><span class="p">)</span>

<span class="c1"># 期待値・分散の理論値</span>
<span class="n">exp_true</span> <span class="o">=</span> <span class="n">gamma</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>
<span class="n">var_true</span> <span class="o">=</span> <span class="n">gamma</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=========================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ガンマ分布・期待値/分散&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=========================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;期待値(乱数 vs 真値): </span><span class="si">{</span><span class="n">exp_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">exp_true</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;分散(乱数 vs 真値): </span><span class="si">{</span><span class="n">var_rvs</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">var_true</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;最大値 (乱数): </span><span class="si">{</span><span class="n">max_rvs</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;最小値 (乱数): </span><span class="si">{</span><span class="n">min_rvs</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># 可視化</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;======================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ガンマ分布&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;======================================&quot;</span><span class="p">)</span>

<span class="c1"># x軸</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_rvs</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># 図の定義</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

<span class="c1"># 乱数によるヒストグラム</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">hist</span><span class="p">([</span><span class="n">rvs</span><span class="p">,</span> <span class="n">rvs_numpy</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="s2">&quot;skyblue&quot;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;[SciPy] random variables&quot;</span><span class="p">,</span> <span class="s2">&quot;[NumPy] random variables&quot;</span><span class="p">])</span>

<span class="c1"># 確率質量関数による真値</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">gamma</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;probability density function&quot;</span><span class="p">)</span>


<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=========================================
ガンマ分布・擬似乱数
=========================================
[3.94460961 2.33355246 0.74071559 1.47790916 2.72922754 1.81586045
 2.60613007 5.87967411 2.02009488 2.12774695 1.79975667 1.44637956
 1.12945852 1.46885278 0.70584925 2.42509529 0.62525083 3.7433015
 1.2508781  2.10082062 0.51022486 4.73914962 1.39614538 1.20308304
 2.41807484 1.20110778 4.47582237 1.57390508 0.92366599 3.84865093
 1.28880575 0.8753026  2.09398862 2.2809019  0.2773048  3.18175898
 2.99927417 0.31200956 3.3138798  1.1499385  1.3487843  2.35393788
 2.73119215 2.34870542 2.10437628 3.30829328 0.50833828 2.376555
 2.69205965 1.61399048 0.71260941 3.53528791 1.33249717 4.09551602
 0.42652973 1.68494098 0.35292303 2.47864772 1.9653399  0.59475186
 3.05563355 1.52526444 4.72123979 3.3405357  3.05995939 0.9150559
 2.82977585 3.15830286 2.00037709 1.80347716 1.45182777 1.69964277
 1.12669419 2.73980021 3.06436604 0.88579208 7.15246249 2.48008468
 0.28286829 1.56810911 1.85715201 0.99004267 1.64344534 1.07810517
 3.66190299 1.55153593 3.41165985 1.30567659 1.8999452  0.98557829
 5.64610452 4.30433267 0.8078178  1.44198619 2.57098072 2.78613764
 1.23494414 0.13191077 0.93572446 1.78048152]

=========================================
ガンマ分布・期待値/分散
=========================================
期待値(乱数 vs 真値): 2.002682363193104 vs 2.0
分散(乱数 vs 真値): 2.0111273799981344 vs 2.0
最大値 (乱数): 14.242409621359599
最小値 (乱数): 0.003602716287084247

======================================
ガンマ分布
======================================
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7fa6e2861d60&gt;
</pre></div>
</div>
<img alt="../../_images/probability_distribution_69_2.png" src="../../_images/probability_distribution_69_2.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 図の定義</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>

<span class="n">scale</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">alphas</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>

<span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">alphas</span><span class="p">:</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">gamma</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>
    <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;alpha = </span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,)</span>
    
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7fa6d1716ac0&gt;
</pre></div>
</div>
<img alt="../../_images/probability_distribution_70_1.png" src="../../_images/probability_distribution_70_1.png" />
</div>
</div>
</section>
<section id="id55">
<h4>ユースケース<a class="headerlink" href="#id55" title="Permalink to this headline">#</a></h4>
<ul class="simple">
<li><p>工事中</p></li>
</ul>
</section>
</section>
<section id="id56">
<h3>例 2.6 (ベータ分布)<a class="headerlink" href="#id56" title="Permalink to this headline">#</a></h3>
<section id="id57">
<h4>確率密度関数<a class="headerlink" href="#id57" title="Permalink to this headline">#</a></h4>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p><strong>ベータ分布</strong> (Beta distribution) は <span class="math notranslate nohighlight">\((0, 1)\)</span> 上の確率分布で <span class="math notranslate nohighlight">\(\alpha &gt; 0, \beta &gt; 0\)</span> としたときに以下の確率分布で表現できる.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        f(x) = \begin{cases}
            \dfrac{x^{\alpha -1} (1-x)^{\beta - 1}}{ B(\alpha, \beta)}  &amp; (0 &lt; x &lt; 1) \\
            0 &amp; (\text{Otherwise})
        \end{cases}
    \end{align}
\end{split}\]</div>
<p>ここで <span class="math notranslate nohighlight">\(B(\alpha, \beta)\)</span> は以下で定義され<strong>ベータ関数</strong>と呼ぶ.</p>
<div class="math notranslate nohighlight">
\[
    \begin{align}
        B(\alpha, \beta) = \int_{0}^{1}{x^{\alpha-1}(1-x)^{\beta-1}dx}
    \end{align}
\]</div>
</div>
<p>ここで<a class="reference internal" href="random_variables.html#continuous-distribution"><span class="std std-ref">連続型の確率分布の性質</span></a>を確認する. 確率密度関数の定義から <span class="math notranslate nohighlight">\(f(x) \geq 0\)</span> であることは自明. また合計和が 1 になることについては</p>
<div class="math notranslate nohighlight">
\[
    \int_{0}^{1}{ \frac{ x^{\alpha - 1}(1-x)^{\beta - 1} }{B(\alpha, \beta)} dx} = \frac{1}{B(\alpha, \beta)} \int_{0}^{1}{ x^{\alpha - 1}(1-x)^{\beta - 1} dx} = \frac{1}{B(\alpha, \beta)} \times B(\alpha, \beta) = 1
\]</div>
<p>から分かる.</p>
</section>
<section id="id58">
<h4>期待値と分散<a class="headerlink" href="#id58" title="Permalink to this headline">#</a></h4>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        &amp; {\rm E}(X) = \frac{\alpha}{\alpha + \beta} \\
        &amp; {\rm Var}(X) = \frac{\alpha \beta}{(\alpha + \beta)^2(\alpha + \beta + 1)}
    \end{align}
\end{split}\]</div>
</div>
<p><u>証明</u><br />
　<a class="reference internal" href="random_variables.html#expectation"><span class="std std-ref">期待値の定義</span></a>と<a class="reference internal" href="#beta-function"><span class="std std-ref">ベータ関数の性質(4)</span></a> から</p>
<div class="math notranslate nohighlight">
\[
    B(\alpha, \beta) = \frac{\alpha + \beta}{\alpha}B(\alpha + 1, \beta)
\]</div>
<p>を利用して,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm E}(X) &amp;= \int_{0}^{1}{ x \frac{x^{\alpha -1} (1-x)^{\beta - 1}}{ B(\alpha, \beta)} dx } \\
                   &amp;= \int_{0}^{1}{ \frac{\alpha}{\alpha + \beta} \frac{x^{\alpha} (1-x)^{\beta - 1}}{ B(\alpha + 1, \beta)} dx } \\
                   &amp;= \frac{\alpha}{\alpha + \beta}
    \end{align}
\end{split}\]</div>
<p>と求められる. また分散について<a class="reference internal" href="random_variables.html#expect-variance"><span class="std std-ref">分散と期待値の関係式</span></a>から <span class="math notranslate nohighlight">\(E(X^2)\)</span> を求めればよく, 期待値を求めるときと同じようにする. ただし<a class="reference internal" href="#beta-function"><span class="std std-ref">ベータ関数の性質(4)</span></a> から</p>
<div class="math notranslate nohighlight">
\[
    B(\alpha, \beta) = \frac{\alpha + \beta}{\alpha}B(\alpha + 1, \beta) = \frac{(\alpha + \beta)(\alpha + \beta + 1)}{(\alpha)(\alpha + 1)}B(\alpha + 2, \beta) 
\]</div>
<p>であることを注意して</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        {\rm E}(X^2) &amp;= \int_{0}^{1}{ x^2 \frac{x^{\alpha -1} (1-x)^{\beta - 1}}{ B(\alpha, \beta)} dx } \\
                     &amp;= \int_{0}^{1}{ \frac{\alpha(\alpha + 1)}{(\alpha + \beta)(\alpha + \beta + 1)} \frac{x^{\alpha + 1} (1-x)^{\beta - 1}}{ B(\alpha + 2, \beta)} dx } \\
                     &amp;= \frac{\alpha(\alpha + 1)}{(\alpha + \beta)(\alpha + \beta + 1)}
    \end{align}
\end{split}\]</div>
<p>なので</p>
<div class="math notranslate nohighlight">
\[
    \begin{align}
        {\rm Var}(X) = \frac{\alpha(\alpha + 1)}{(\alpha + \beta)(\alpha + \beta + 1)} - \frac{\alpha^2}{(\alpha + \beta)^2} = \frac{\alpha \beta}{(\alpha + \beta)^2(\alpha + \beta + 1)}.
    \end{align}
\]</div>
</section>
<section id="id59">
<h4>命題 2.6.1 (ベータ関数の性質)<a class="headerlink" href="#id59" title="Permalink to this headline">#</a></h4>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #333333; border-radius: 10px;">
<p id="beta-function"><u>ベータ関数の性質</u></p>
<p><span class="math notranslate nohighlight">\(\alpha &gt; 0, \beta &gt; 0\)</span> とする. 以下の 8 性質を満たす.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        &amp;\text{性質(1)} \quad \quad B(\alpha, \beta) = B(\beta, \alpha) \\
        &amp;\text{性質(2)} \quad \quad \alpha B(\alpha, \beta + 1) = \beta B(\alpha + 1, \beta)  \\
        &amp;\text{性質(3)} \quad \quad B(\alpha, \beta) = B(\alpha + 1, \beta) + B(\alpha, \beta + 1) \\
        &amp;\text{性質(4)} \quad \quad (\alpha + \beta)B(\alpha + 1, \beta) = \alpha B(\alpha, \beta) \\
        &amp;\text{性質(5)} \quad \quad (\alpha + \beta)B(\alpha, \beta + 1) = \beta B(\alpha, \beta) \\
        &amp;\text{性質(6)} \quad \quad B(\alpha, \beta) = 2 \int_{0}^{\pi / 2}{\sin^{2\alpha -1}{\theta} \cos^{2\beta -1}{\theta} d\theta} \\
        &amp;\text{性質(7)} \quad \quad B(\alpha, \beta) = \frac{1}{2^{x + y -1}} \int_{-1}^{1}{(1+t)^{\alpha -1} (1-t)^{\beta -1} dt} \\
        &amp;\text{性質(8)} \quad \quad B(1, x) = (x, 1) = \frac{1}{x}
    \end{align}
\end{split}\]</div>
</div>
<p><u>証明</u><br />
　性質(1) はベータ関数の定義において <span class="math notranslate nohighlight">\(y = 1 - x\)</span> と置換積分すると</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        B(\alpha, \beta) &amp;= \int_{0}^{1}{x^{\alpha-1}(1-x)^{\beta-1}dx} \\
                         &amp;= \int_{1}^{0}{(1-y)^{\alpha-1}y^{\beta-1}(-dy)} \\
                         &amp;= \int_{0}^{1}{(1-y)^{\alpha-1}y^{\beta-1}(dy)} \\
                         &amp;= B(\beta, \alpha).
    \end{align}
\end{split}\]</div>
<p>性質(2)については部分積分を用いて</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        \alpha B(\alpha, \beta + 1) &amp;= \alpha \int_{0}^{1}{x^{\alpha-1}(1-x)^{\beta}dx} \\
                                    &amp;= \biggl[ x^{alpha}(1-x)^{\beta} \biggr]_{0}^{1} + \beta \int_{0}^{1}{x^{\alpha}(1-x)^{\beta-1}dx} \\
                                    &amp;= \beta B(\alpha + 1, \beta).
    \end{align}
\end{split}\]</div>
<p>性質(3)については</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        B(\alpha, \beta + 1) &amp;= \int_{0}^{1}{x^{\alpha-1}(1-x)^{\beta}dx} \\
                             &amp;= \int_{0}^{1}{x^{\alpha-1}(1-x)^{\beta-1}(1-x)dx} \\
                             &amp;= \int_{0}^{1}{x^{\alpha-1}(1-x)^{\beta-1}dx} - \int_{0}^{1}{x^{\alpha}(1-x)^{\beta-1}dx} \\
                             &amp;= B(\alpha, \beta) - B(\alpha + 1, \beta).
    \end{align}
\end{split}\]</div>
<p>よって</p>
<div class="math notranslate nohighlight">
\[
    \begin{align}
        B(\alpha, \beta) = B(\alpha + 1, \beta) + B(\alpha, \beta + 1).
    \end{align}
\]</div>
<p>性質(4)は性質(3)に対して性質(2)の <span class="math notranslate nohighlight">\(\alpha B(\alpha, \beta + 1) = \beta B(\alpha + 1, \beta)\)</span> を適用して</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        B(\alpha, \beta) &amp;= B(\alpha + 1, \beta) + B(\alpha, \beta + 1) \\
                         &amp;= B(\alpha + 1, \beta) + \frac{\beta}{\alpha} B(\alpha + 1, \beta).
    \end{align}
\end{split}\]</div>
<p>両辺を <span class="math notranslate nohighlight">\(\alpha\)</span> でかけて, <span class="math notranslate nohighlight">\((\alpha + \beta)B(\alpha + 1, \beta) = \alpha B(\alpha, \beta)\)</span> となる. 性質(5)についても同様にすれば求められる.
　性質(6)について積分変数 <span class="math notranslate nohighlight">\(x\)</span> について区間 <span class="math notranslate nohighlight">\((0, 1)\)</span> より <span class="math notranslate nohighlight">\(x = \sin^{2}{\theta}\)</span> とおくことができ, この時, <span class="math notranslate nohighlight">\(x: 0 \rightarrow 1 \Rightarrow \theta: 0 \rightarrow \pi / 2\)</span> となる. また <span class="math notranslate nohighlight">\(dx = 2\sin{\theta} \cos{\theta} d\theta\)</span> から</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        B(\alpha, \beta) &amp;= \int_{0}^{1}{x^{\alpha-1}(1-x)^{\beta-1}dx} \\
                         &amp;= \int_{0}^{\pi / 2}{\sin^{2\alpha-2}{\theta} \cos^{2\beta-2}{\theta}(2\sin{\theta} \cos{\theta} d\theta)} \\
                         &amp;= 2 \int_{0}^{\pi / 2}{\sin^{2\alpha -1}{\theta} \cos^{2\beta -1}{\theta} d\theta}
    \end{align}
\end{split}\]</div>
<p>となる.<br />
　性質(7)は <span class="math notranslate nohighlight">\(t = 2x - 1\)</span> と置換積分すると</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align}
        B(\alpha, \beta) &amp;= \int_{0}^{1}{x^{\alpha-1}(1-x)^{\beta-1}dx} \\
                         &amp;= \int_{-1}^{1}{ \biggl( \frac{1+t}{2} \biggr)^{\alpha - 1} \biggl( \frac{1-t}{2} \biggr)^{\beta - 1} \frac{dt}{2} } \\
                         &amp;= \frac{1}{2^{x + y -1}} \int_{-1}^{1}{(1+t)^{\alpha -1} (1-t)^{\beta -1} dt}.
    \end{align}
\end{split}\]</div>
<p>最後の性質(8)について, 性質(1)から <span class="math notranslate nohighlight">\(B(1,x) = B(x, 1)\)</span> で</p>
<div class="math notranslate nohighlight">
\[
    B(x, 1) = \int_{0}^{1}{t^{x - 1}dt} = \biggl[ \frac{t^x}{x} \biggr]_{0}^{1} = \frac{1}{x}
\]</div>
<p>となり, すべての性質の証明が完了した.</p>
</section>
<section id="id60">
<h4>関連Pythonモジュール<a class="headerlink" href="#id60" title="Permalink to this headline">#</a></h4>
<p>工事中</p>
</section>
<section id="id61">
<h4>ユースケース<a class="headerlink" href="#id61" title="Permalink to this headline">#</a></h4>
<ul class="simple">
<li><p>工事中</p></li>
</ul>
</section>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./analytics/distribution"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="random_variables.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">確率変数</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="multi_probability_distribution.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">多次元確率分布</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By sndpgm<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>